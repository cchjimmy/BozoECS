{
  "version": 3,
  "sources": ["../../../src/pool.ts", "../../../src/component.ts", "../../../src/entity.ts", "../../../src/world.ts", "../src/main.ts"],
  "sourcesContent": ["export class ObjectPoolMap<K, V> {\n  private storage: V[] = [];\n  private keyToIndex: Map<K, number> = new Map();\n  private indexToKey: K[] = [];\n  private objectFactory: () => V;\n\n  constructor(objectFactory: () => V) {\n    this.objectFactory = objectFactory;\n  }\n\n  size() {\n    return this.keyToIndex.size;\n  }\n\n  add(key: K): V {\n    if (this.keyToIndex.has(key))\n      return this.storage[this.keyToIndex.get(key) as number];\n    if (this.storage.length <= this.keyToIndex.size)\n      this.storage.push(this.objectFactory());\n    this.keyToIndex.set(key, this.keyToIndex.size);\n    this.indexToKey[this.keyToIndex.size - 1] = key;\n    return this.storage[this.keyToIndex.get(key) as number];\n  }\n\n  remove(key: K): void {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) return;\n    const backKey = this.indexToKey[this.keyToIndex.size - 1];\n    const temp = this.storage[index];\n    this.storage[index] = this.storage[this.keyToIndex.size - 1];\n    this.storage[this.keyToIndex.size - 1] = temp;\n    this.indexToKey[index] = backKey;\n    this.indexToKey.pop();\n    this.keyToIndex.set(backKey, index);\n    this.keyToIndex.delete(key);\n  }\n\n  get(key: K): V {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) throw new Error(\"Key not found.\");\n    return this.storage[index];\n  }\n\n  has(key: K): boolean {\n    return this.keyToIndex.has(key);\n  }\n\n  clean(): void {\n    this.storage.splice(this.keyToIndex.size);\n  }\n}\n", "import { ObjectPoolMap } from \"./pool.ts\";\nimport { entityT } from \"./entity.ts\";\n\nexport class ComponentManager {\n  private poolMap: Map<object, ObjectPoolMap<entityT, object>> = new Map();\n  private idMap: Map<object, number> = new Map();\n\n  register<T extends object>(component: T): void {\n    if (this.poolMap.has(component)) return;\n    this.idMap.set(component, this.idMap.size);\n    this.poolMap.set(\n      component,\n      new ObjectPoolMap<entityT, T>(() => ({ ...component })),\n    );\n  }\n\n  getId<T extends object>(component: T): number {\n    const mask = this.idMap.get(component);\n    if (mask != undefined) return mask;\n    this.register(component);\n    return this.idMap.get(component) as number;\n  }\n\n  add<T extends object>(entity: entityT, component: T): T {\n    return Object.assign(\n      (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).add(entity),\n      component,\n    );\n  }\n\n  remove<T extends object>(entity: entityT, component: T): void {\n    (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).remove(entity);\n  }\n\n  has<T extends object>(entity: entityT, component: T): boolean {\n    return (\n      this.poolMap.has(component) &&\n      (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).has(entity)\n    );\n  }\n\n  get<T extends object>(entity: entityT, component: T): T {\n    return (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).get(\n      entity,\n    );\n  }\n\n  size<T extends object>(component: T): number {\n    return (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).size();\n  }\n\n  delete(entity: entityT): void {\n    for (const entry of this.poolMap.entries()) entry[1].remove(entity);\n  }\n\n  copy(src: entityT, dest: entityT): void {\n    for (const entry of this.poolMap.entries())\n      entry[1].has(src) && Object.assign(entry[1].add(dest), entry[1].get(src));\n  }\n\n  clean(): void {\n    for (const entry of this.poolMap.entries()) entry[1].clean();\n  }\n}\n", "export type entityT = number;\nexport function newEntity(): entityT {\n  return Math.random();\n}\n", "import { ComponentManager } from \"./component.ts\";\nimport { newEntity, type entityT } from \"./entity.ts\";\n\nexport type queryT = Partial<Record<\"and\" | \"not\", object[]>>;\n\nexport type systemT = (world: World) => void;\n\nexport class World {\n  private compEntityMap: Map<number, Set<entityT>> = new Map();\n  private compManager = new ComponentManager();\n  private entitySet: Set<entityT> = new Set();\n\n  addEntity(entity: entityT = newEntity()): entityT {\n    this.entitySet.add(entity);\n    return entity;\n  }\n\n  copyEntity(src: entityT, dest: entityT = newEntity()): entityT {\n    this.compManager.copy(src, dest);\n    for (const entry of this.compEntityMap) {\n      if (!entry[1].has(src)) continue;\n      entry[1].add(dest);\n    }\n    this.entitySet.add(dest);\n    return dest;\n  }\n\n  private getCompEntityMap(compId: number): Set<entityT> {\n    const a = this.compEntityMap.get(compId) ?? new Set();\n    this.compEntityMap.set(compId, a);\n    return a;\n  }\n\n  deleteEntity(entity: entityT) {\n    this.compManager.delete(entity);\n    for (const entry of this.compEntityMap) {\n      entry[1].delete(entity);\n    }\n    this.entitySet.delete(entity);\n  }\n\n  registerComponent<T extends object>(component: T): World {\n    this.compManager.register(component);\n    return this;\n  }\n\n  hasComponent<T extends object>(entity: entityT, component: T): boolean {\n    return this.compManager.has(entity, component);\n  }\n\n  addComponent<T extends object>(\n    entity: entityT,\n    component: T,\n    values: Partial<T> = component,\n  ): T {\n    this.compManager.register(component);\n    const cem = this.getCompEntityMap(this.compManager.getId(component));\n    if (cem.has(entity))\n      return Object.assign(this.compManager.get(entity, component), values);\n    cem.add(entity);\n    return Object.assign(this.compManager.add(entity, component), values);\n  }\n\n  removeComponent<T extends object>(entity: entityT, component: T): void {\n    this.compManager.register(component);\n    this.getCompEntityMap(this.compManager.getId(component)).delete(entity);\n    this.compManager.remove(entity, component);\n  }\n\n  getComponent<T extends object>(entity: entityT, component: T): T {\n    return this.compManager.get(entity, component);\n  }\n\n  update(...fns: systemT[]) {\n    for (let i = 0, l = fns.length; i < l; i++) fns[i](this);\n  }\n\n  cleanObjectPools(): void {\n    this.compManager.clean();\n  }\n\n  query(query: queryT): entityT[] {\n    let res: Set<entityT> = this.entitySet;\n    if (query.and) {\n      for (const comp of query.and) {\n        res = res.intersection(\n          this.getCompEntityMap(this.compManager.getId(comp)),\n        );\n      }\n    }\n    if (query.not) {\n      for (const comp of query.not) {\n        res = res.difference(\n          this.getCompEntityMap(this.compManager.getId(comp)),\n        );\n      }\n    }\n    return [...res];\n  }\n\n  entityCount(): number {\n    return this.entitySet.size;\n  }\n}\n", "import { World } from \"bozoecs\";\n\n// singletons\nconst Time = { dtMilli: 0, timeMilli: 0, dtSeconds: 0, timeSeconds: 0 };\nconst Ctx2D = setUpCtx2D();\n\n// utils\nfunction updateTime(p: typeof Time) {\n  p.dtMilli = performance.now() - p.timeMilli;\n  p.timeMilli += p.dtMilli;\n  p.dtSeconds = p.dtMilli / 1000;\n  p.timeSeconds = p.timeMilli / 1000;\n}\nfunction setUpCtx2D() {\n  let canvas = document.querySelector(\"canvas\");\n  if (canvas == null) {\n    canvas = document.createElement(\"canvas\");\n    document.body.appendChild(canvas);\n  }\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) throw new Error(\"Cannot initialize 2D context.\");\n  return { canvas, ctx };\n}\n\n// components\nconst Position = { x: 0, y: 0 };\nconst Velocity = { x: 0, y: 0 };\nconst Acceleration = { x: 0, y: 0 };\nconst Mass = { kg: 0 };\nconst Force = { x: 0, y: 0 };\nconst Circle = { radius: 5 };\nconst Text = { content: \"placeholder\", font: \"20px sans-serif\" };\n\n// systems\nfunction handleMovement(world: World) {\n  for (const e of world.query({ and: [Velocity, Acceleration] })) {\n    const v = world.getComponent(e, Velocity);\n    const a = world.getComponent(e, Acceleration);\n    v.x += a.x * Time.dtSeconds;\n    v.y += a.y * Time.dtSeconds;\n  }\n  for (const e of world.query({ and: [Position, Velocity] })) {\n    const p = world.getComponent(e, Position);\n    const v = world.getComponent(e, Velocity);\n    p.x += v.x * Time.dtSeconds;\n    p.y += v.y * Time.dtSeconds;\n  }\n}\nfunction handleApplyForces(world: World) {\n  for (const e of world.query({ and: [Force, Mass, Acceleration] })) {\n    const f = world.getComponent(e, Force);\n    const m = world.getComponent(e, Mass).kg;\n    const a = world.getComponent(e, Acceleration);\n    // solve for acceleration, F=ma, a=F/m\n    a.x = f.x / m;\n    a.y = f.y / m;\n    f.x = f.y = 0;\n  }\n}\nfunction handleForceInteractions(world: World) {\n  const objs = world.query({ and: [Force, Mass, Position] });\n  const fs = [];\n  const ms = [];\n  const ps = [];\n  for (const e of objs) {\n    fs.push(world.getComponent(e, Force));\n    ms.push(world.getComponent(e, Mass).kg);\n    ps.push(world.getComponent(e, Position));\n  }\n  for (let i = 0, l = fs.length; i < l; i++) {\n    const m1 = ms[i];\n    const p1 = ps[i];\n    for (let j = 0; j < l; j++) {\n      if (j == i) continue;\n      const f2 = fs[j];\n      const m2 = ms[j];\n      const p2 = ps[j];\n      const dx = p2.x - p1.x;\n      const dy = p2.y - p1.y;\n      const distance = (dx * dx + dy * dy) ** 0.5;\n      f2.x -= (((6.674 * 10) ** -11 * (m1 * m2)) / distance ** 3) * dx;\n      f2.y -= (((6.674 * 10) ** -11 * (m1 * m2)) / distance ** 3) * dy;\n    }\n  }\n}\nfunction handleDrawCircles(world: World) {\n  Ctx2D.ctx.strokeStyle = \"red\";\n  Ctx2D.ctx.beginPath();\n  for (const e of world.query({ and: [Position, Circle] })) {\n    const p = world.getComponent(e, Position);\n    const r = world.getComponent(e, Circle).radius;\n    Ctx2D.ctx.moveTo(p.x + r, p.y);\n    Ctx2D.ctx.arc(p.x, p.y, r, 0, Math.PI * 2);\n  }\n  Ctx2D.ctx.stroke();\n}\nfunction handleBounce(world: World) {\n  for (const e of world.query({\n    and: [Position, Velocity, Mass, Force],\n  })) {\n    const p = world.getComponent(e, Position);\n    const v = world.getComponent(e, Velocity);\n    const m = world.getComponent(e, Mass).kg;\n    const f = world.getComponent(e, Force);\n    if (p.x < 0 || p.x > Ctx2D.canvas.width) {\n      p.x = p.x < Ctx2D.canvas.width / 2 ? 0 : Ctx2D.canvas.width;\n      f.x += (m * -v.x) / Time.dtSeconds;\n      v.x = 0;\n    }\n    if (p.y < 0 || p.y > Ctx2D.canvas.height) {\n      p.y = p.y < Ctx2D.canvas.height / 2 ? 0 : Ctx2D.canvas.height;\n      f.y += (m * -v.y) / Time.dtSeconds;\n      v.y = 0;\n    }\n  }\n}\nfunction handleDrawTexts(world: World) {\n  Ctx2D.ctx.fillStyle = \"white\";\n  for (const e of world.query({ and: [Text, Position] })) {\n    const text = world.getComponent(e, Text);\n    const p = world.getComponent(e, Position);\n    const split = text.content.split(\"\\n\");\n    Ctx2D.ctx.font = text.font;\n    const textMetrics = Ctx2D.ctx.measureText(text.content);\n    for (let i = 0, l = split.length; i < l; i++) {\n      Ctx2D.ctx.fillText(\n        split[i],\n        p.x,\n        p.y + textMetrics.emHeightAscent * (i + 1),\n      );\n    }\n  }\n}\nfunction handleDrawForceField(world: World) {\n  Ctx2D.ctx.strokeStyle = \"white\";\n  Ctx2D.ctx.beginPath();\n  const ps = [];\n  const fs = [];\n  const ms = [];\n  const dx = Ctx2D.canvas.width / 10;\n  for (const e of world.query({ and: [Position, Force, Mass] })) {\n    ps.push(world.getComponent(e, Position));\n    fs.push(world.getComponent(e, Force));\n    ms.push(world.getComponent(e, Mass).kg);\n  }\n  for (let x = dx; x < Ctx2D.canvas.width; x += dx) {\n    for (let y = dx; y < Ctx2D.canvas.height; y += dx) {\n      let rfx = 0;\n      let rfy = 0;\n      for (let i = 0, l = fs.length; i < l; i++) {\n        const m = ms[i];\n        const p = ps[i];\n        const dx = p.x - x;\n        const dy = p.y - y;\n        const distance = (dx * dx + dy * dy) ** 0.5;\n        rfx += (((6.674 * 10) ** -11 * m) / distance ** 3) * dx;\n        rfy += (((6.674 * 10) ** -11 * m) / distance ** 3) * dy;\n      }\n      const mag = (rfx * rfx + rfy * rfy) ** 0.5 / (dx / 2);\n      Ctx2D.ctx.moveTo(x, y);\n      Ctx2D.ctx.lineTo(x + rfx / mag, y + rfy / mag);\n      Ctx2D.ctx.moveTo(x + dx / 10, y);\n      Ctx2D.ctx.arc(x, y, dx / 10, 0, Math.PI * 2);\n    }\n  }\n  Ctx2D.ctx.stroke();\n}\n\n// entities\nfunction addPointMass(world: World, x: number, y: number, mass: number) {\n  const e = world.addEntity();\n  world.addComponent(e, Position, { x, y });\n  world.addComponent(e, Mass, { kg: mass });\n  world.addComponent(e, Velocity);\n  world.addComponent(e, Acceleration);\n  world.addComponent(e, Force);\n  world.addComponent(e, Circle, { radius: 5 });\n  world.addComponent(e, Text, {\n    content: `${mass.toExponential(2)} kg`,\n    font: \"10px sans-serif\",\n  });\n  return e;\n}\n\nconst game = new World();\n\nCtx2D.canvas.width = 200;\nCtx2D.canvas.height = 200;\nCtx2D.canvas.style.imageRendering = \"pixelated\";\n\naddPointMass(game, Ctx2D.canvas.width / 2, Ctx2D.canvas.height / 2, 1e25);\nconst lightMass = addPointMass(\n  game,\n  Ctx2D.canvas.width / 2 + 40,\n  Ctx2D.canvas.height / 2,\n  1,\n);\ngame.addComponent(lightMass, Force, { y: 1480 });\n\n{\n  (function loop() {\n    requestAnimationFrame(loop);\n\n    const fps = 30;\n\n    if (Time.timeSeconds % (1 / fps) < Time.dtSeconds) {\n      Time.dtSeconds = 1 / 30;\n      Ctx2D.ctx.fillStyle = \"#424242\";\n      Ctx2D.ctx.fillRect(0, 0, Ctx2D.canvas.width, Ctx2D.canvas.height);\n      game.update(\n        handleApplyForces,\n        handleForceInteractions,\n        // handleBounce,\n        handleDrawCircles,\n        handleDrawForceField,\n        handleDrawTexts,\n        handleMovement,\n      );\n    }\n\n    updateTime(Time);\n  })();\n}\n"],
  "mappings": "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",
  "names": ["ObjectPoolMap", "objectFactory", "key", "index", "backKey", "temp", "ComponentManager", "component", "ObjectPoolMap", "mask", "entity", "entry", "src", "dest", "newEntity", "World", "ComponentManager", "entity", "newEntity", "src", "dest", "entry", "compId", "a", "component", "values", "cem", "fns", "i", "l", "query", "res", "comp", "Time", "Ctx2D", "setUpCtx2D", "updateTime", "p", "canvas", "ctx", "Position", "Velocity", "Acceleration", "Mass", "Force", "Circle", "Text", "handleMovement", "world", "e", "v", "a", "handleApplyForces", "f", "m", "handleForceInteractions", "objs", "fs", "ms", "ps", "i", "l", "m1", "p1", "j", "f2", "m2", "p2", "dx", "dy", "distance", "handleDrawCircles", "r", "handleDrawTexts", "world", "Ctx2D", "e", "Text", "Position", "text", "p", "split", "textMetrics", "i", "l", "handleDrawForceField", "ps", "fs", "ms", "dx", "Force", "Mass", "x", "y", "rfx", "rfy", "m", "dy", "distance", "mag", "addPointMass", "mass", "Velocity", "Acceleration", "Circle", "game", "World", "lightMass", "loop", "Time", "handleApplyForces", "handleForceInteractions", "handleDrawCircles", "handleMovement", "updateTime"]
}
