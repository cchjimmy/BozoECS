{
  "version": 3,
  "sources": ["../../../src/pool.ts", "../../../src/component.ts", "../../../src/entity.ts", "../../../src/world.ts", "../src/config.json", "../src/quadtree.ts", "../src/main.ts"],
  "sourcesContent": ["export class ObjectPoolMap<K, V> {\n  private storage: V[] = [];\n  private keyToIndex: Map<K, number> = new Map();\n  private indexToKey: K[] = [];\n  private objectFactory: () => V;\n\n  constructor(objectFactory: () => V) {\n    this.objectFactory = objectFactory;\n  }\n\n  size() {\n    return this.keyToIndex.size;\n  }\n\n  add(key: K): V {\n    if (this.keyToIndex.has(key))\n      return this.storage[this.keyToIndex.get(key) as number];\n    if (this.storage.length <= this.keyToIndex.size)\n      this.storage.push(this.objectFactory());\n    this.keyToIndex.set(key, this.keyToIndex.size);\n    this.indexToKey[this.keyToIndex.size - 1] = key;\n    return this.storage[this.keyToIndex.get(key) as number];\n  }\n\n  remove(key: K): void {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) return;\n    const temp = this.storage[index];\n    this.storage[index] = this.storage[this.keyToIndex.size - 1];\n    this.storage[this.keyToIndex.size - 1] = temp;\n    const backKey = this.indexToKey[this.keyToIndex.size - 1];\n    this.indexToKey[index] = backKey;\n    this.indexToKey.pop();\n    this.keyToIndex.set(backKey, index);\n    this.keyToIndex.delete(key);\n  }\n\n  get(key: K): V {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) throw new Error(\"Key not found.\");\n    return this.storage[index];\n  }\n\n  has(key: K): boolean {\n    return this.keyToIndex.has(key);\n  }\n\n  clean(): void {\n    this.storage.splice(this.keyToIndex.size);\n  }\n}\n", "import { ObjectPoolMap } from \"./pool.ts\";\nimport { entityT } from \"./entity.ts\";\n\nexport class ComponentManager {\n  private poolMap: Map<object, ObjectPoolMap<entityT, object>> = new Map();\n  private maskMap: Map<object, number> = new Map();\n\n  register<T extends object>(component: T): void {\n    if (this.poolMap.has(component)) return;\n    this.maskMap.set(component, 1 << this.maskMap.size);\n    this.poolMap.set(\n      component,\n      new ObjectPoolMap<entityT, T>(() => ({ ...component })),\n    );\n  }\n\n  getMask<T extends object>(component: T): number {\n    return this.maskMap.get(component) ?? -1;\n  }\n\n  add<T extends object>(entity: entityT, component: T): T {\n    return Object.assign(\n      (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).add(entity),\n      component,\n    );\n  }\n\n  remove<T extends object>(entity: entityT, component: T): void {\n    (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).remove(entity);\n  }\n\n  has<T extends object>(entity: entityT, component: T): boolean {\n    return (\n      this.poolMap.has(component) &&\n      (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).has(entity)\n    );\n  }\n\n  get<T extends object>(entity: entityT, component: T): T {\n    return (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).get(\n      entity,\n    );\n  }\n\n  size<T extends object>(component: T): number {\n    return (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).size();\n  }\n\n  delete(entity: entityT): void {\n    for (const entry of this.poolMap.entries()) entry[1].remove(entity);\n  }\n\n  copy(src: entityT, dest: entityT): void {\n    for (const entry of this.poolMap.entries())\n      entry[1].has(src) && Object.assign(entry[1].add(dest), entry[1].get(src));\n  }\n\n  clean(): void {\n    for (const entry of this.poolMap.entries()) entry[1].clean();\n  }\n}\n", "export type entityT = number;\nexport function newEntity(): entityT {\n  return Math.random();\n}\n", "import { ComponentManager } from \"./component.ts\";\nimport { newEntity, type entityT } from \"./entity.ts\";\n\nexport type queryT = Partial<Record<\"and\" | \"not\", object[]>>;\n\nexport type systemT = (world: World) => void;\n\nexport class World {\n  private maskMap: Map<entityT, number> = new Map();\n  private archetypeMap: Map<number, Set<entityT>> = new Map();\n  private compManager = new ComponentManager();\n\n  addEntity(entity: entityT = newEntity()): entityT {\n    if (this.maskMap.has(entity)) return entity;\n    this.maskMap.set(entity, 0);\n    this.getArchetype(0).add(entity);\n    return entity;\n  }\n\n  copyEntity(src: entityT, dest: entityT = newEntity()): entityT {\n    this.compManager.copy(src, dest);\n    const mask = this.maskMap.get(src) ?? 0;\n    this.maskMap.set(dest, mask);\n    this.getArchetype(mask).add(dest);\n    return dest;\n  }\n\n  private getArchetype(mask: number): Set<entityT> {\n    const a = this.archetypeMap.get(mask) ?? new Set();\n    this.archetypeMap.set(mask, a);\n    return a;\n  }\n\n  deleteEntity(entity: entityT) {\n    this.compManager.delete(entity);\n    const mask = this.maskMap.get(entity) ?? 0;\n    this.maskMap.delete(entity);\n    this.getArchetype(mask).delete(entity);\n  }\n\n  registerComponent<T extends object>(component: T): World {\n    this.compManager.register(component);\n    return this;\n  }\n\n  hasComponent<T extends object>(entity: entityT, component: T): boolean {\n    return this.compManager.has(entity, component);\n  }\n\n  addComponent<T extends object>(\n    entity: entityT,\n    component: T,\n    values: Partial<T> = component,\n  ): T {\n    this.compManager.register(component);\n    let mask = this.maskMap.get(entity) ?? 0;\n    const compMask = this.compManager.getMask(component);\n    if (mask & compMask)\n      return Object.assign(this.compManager.get(entity, component), values);\n    this.getArchetype(mask).delete(entity);\n    mask ^= compMask;\n    this.maskMap.set(entity, mask);\n    this.getArchetype(mask).add(entity);\n    return Object.assign(this.compManager.add(entity, component), values);\n  }\n\n  removeComponent<T extends object>(entity: entityT, component: T): void {\n    this.compManager.register(component);\n    let mask = this.maskMap.get(entity) ?? 0;\n    const compMask = this.compManager.getMask(component);\n    if (!(mask & compMask)) return;\n    this.compManager.remove(entity, component);\n    this.getArchetype(mask).delete(entity);\n    mask ^= compMask;\n    this.maskMap.set(entity, mask);\n    this.getArchetype(mask).add(entity);\n  }\n\n  getComponent<T extends object>(entity: entityT, component: T): T {\n    return this.compManager.get(entity, component);\n  }\n\n  update(...fns: systemT[]) {\n    for (let i = 0, l = fns.length; i < l; i++) fns[i](this);\n  }\n\n  cleanObjectPools(): void {\n    this.compManager.clean();\n  }\n\n  query(query: queryT): entityT[] {\n    let andMask = 0,\n      notMask = 0;\n    if (query.and) {\n      for (let i = 0, l = query.and.length; i < l; i++)\n        andMask |= this.compManager.getMask(query.and[i]);\n    }\n    if (query.not) {\n      for (let i = 0, l = query.not.length; i < l; i++)\n        notMask |= this.compManager.getMask(query.not[i]);\n    }\n    const res: entityT[] = [];\n    for (const entry of this.archetypeMap.entries()) {\n      entry[1].size > 0 &&\n        (entry[0] & andMask) == andMask &&\n        (entry[0] & notMask) == 0 &&\n        res.push(...entry[1]);\n    }\n    return res;\n  }\n\n  entityCount(): number {\n    return this.maskMap.size;\n  }\n}\n", "{\n  \"viewport\": {\n    \"width\": 800,\n    \"height\": 400\n  },\n  \"entities\": {\n    \"player\": {\n      \"healthPoint\": 10,\n      \"moveSpeed\": 20\n    },\n    \"minion\": {\n      \"healthPoint\": 15,\n      \"spawnRate\": 2\n    },\n    \"turrent\": {\n      \"healthPoint\": 100,\n      \"abilityPower\": 100\n    }\n  }\n}\n", "type Rect = { width: number; height: number; cx: number; cy: number };\nenum Quads {\n  Root,\n  NE,\n  NW,\n  SE,\n  SW,\n}\nexport class Quadtree {\n  private storage: Record<string, Set<Rect>> = {};\n  private changed: Rect[] = [];\n  private bounds: Record<string, Rect> = {};\n  private maxDepth: number = 10;\n  constructor(boundary: Rect, maxDepth: number = 10) {\n    this.bounds[Quads.Root] = boundary;\n    this.maxDepth = maxDepth;\n    this.storage[Quads.Root] = new Set();\n  }\n  index(rect: Rect, index = Quads.Root.toString()): string {\n    if (index.length >= this.maxDepth) return index;\n    const parentBound = this.bounds[index];\n    // i as enum values of Quads\n    for (let i = 0; i < 4; i++) {\n      this.bounds[index + i.toString()] ??= {\n        cx: parentBound.cx + (parentBound.width / 4) * (i % 2 == 0 ? 1 : -1),\n        cy: parentBound.cy + (parentBound.height / 4) * (i < 1 ? 1 : -1),\n        width: parentBound.width / 2,\n        height: parentBound.height / 2,\n      };\n      if (this.contain(this.bounds[index + i.toString()], rect))\n        return this.index(rect, index + i.toString());\n    }\n    return index;\n  }\n  insert(rect: Rect) {\n    const index = this.index(rect);\n    this.storage[index] ??= new Set();\n    this.storage[index].add(rect);\n  }\n  queryRange(rect: Rect): Rect[] {\n    return [...this.storage[this.index(rect)]];\n  }\n  update() {\n    for (const index in this.storage) {\n      for (const rect of this.storage[index].values()) {\n        if (!this.contain(this.bounds[index], rect)) this.changed.push(rect);\n      }\n    }\n    while (this.changed.length) {\n      const rect = this.changed.pop();\n      if (!rect) continue;\n      this.insert(rect);\n    }\n  }\n  contain(r1: Rect, r2: Rect): boolean {\n    return (\n      (r1.cx - r2.cx) ** 2 < ((r1.width - r2.width) / 2) ** 2 &&\n      (r1.cy - r2.cy) ** 2 < ((r1.height - r2.height) / 2) ** 2\n    );\n  }\n  intersect(r1: Rect, r2: Rect): boolean {\n    return (\n      (r1.cx - r2.cx) ** 2 < ((r1.width + r2.width) / 2) ** 2 &&\n      (r1.cy - r2.cy) ** 2 < ((r1.height + r2.height) / 2) ** 2\n    );\n  }\n}\n", "/**\n * By Original PNG version by Raizin, SVG rework by Sameboat. - file:Map of MOBA.png (CC 3.0), CC BY-SA 3.0, https://commons.wikimedia.org/w/index.php?curid=29443207\n */\n\nimport { entityT, World } from \"bozoecs\";\nimport { default as config } from \"./config.json\" with { type: \"json\" };\nimport { Quadtree } from \"./quadtree.ts\";\n\n// components\nconst PIDController = {\n  kp: 0,\n  ki: 0,\n  kd: 0,\n  prevErr: 0,\n  accumErr: 0,\n  currentErr: 0,\n  result: 0,\n  reset: false,\n};\nconst Stats = {\n  attackPoint: 0,\n  defencePoint: 0,\n  abilityPower: 0,\n  moveSpeed: 0,\n  attackSpeed: 0,\n};\nconst Health = { current: 0, max: 0 };\nconst Callback = { callback: new Function() };\nconst Transform = { x: 0, y: 0, rad: 0, scaleX: 1, scaleY: 1 };\nconst Velocity = { x: 0, y: 0 };\nconst PlayerControl = {};\nconst ComControl = {};\nconst OnScreen = {};\nconst ParticleEmitter = {\n  spreadRadians: 0,\n  particleEntity: -1,\n  particleLifetimeSeconds: 1,\n  speed: 1,\n  emit: false,\n  particleTransition: function (\n    world: World,\n    particleEntity: entityT,\n    percentageLifeTime: number,\n  ) {\n    const t = world.getComponent(particleEntity, Transform);\n    t.scaleX = t.scaleY = -((2 * percentageLifeTime - 1) ** 10) + 1;\n  },\n};\nconst Camera = { zoom: 20, tilt: 0, isActive: false, targetEntity: -1 };\nconst Rect = { width: 1, height: 1, offsetX: 0.5, offsetY: 0.5 };\nconst Graphic = { src: \"\" };\nconst Button = { hovered: false, pressed: false, clicked: false };\nconst Colour = { fill: \"white\", stroke: \"black\" };\nconst Text = {\n  content: \"\",\n  fontSize: 20,\n  padding: 3,\n  color: \"black\",\n  backgroundColor: \"white\",\n};\nconst Timer = { timeMilli: 0, reset: false, stop: false };\nconst PathFinder = { targetX: 0, targetY: 0 };\n\n// singletons\nconst Ctx2D = setUpCanvas2D();\nconst Pointer = setUpPointer();\nconst Keys = setUpKeyboard();\nconst Time = setUpTime();\nlet canPlayerMove = true;\n\nfunction setUpCanvas2D(): {\n  canvas: HTMLCanvasElement;\n  ctx: CanvasRenderingContext2D;\n} {\n  const canvas =\n    document.querySelector(\"canvas\") ?? document.createElement(\"canvas\");\n  if (!canvas) throw new Error(\"Cannot create canvas element.\");\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) throw new Error(\"Cannot initialize context 2d.\");\n\n  !document.querySelector(\"canvas\") && document.body.appendChild(canvas);\n\n  globalThis.onresize = globalThis.onload = () => {\n    if (innerWidth / innerHeight < canvas.width / canvas.height) {\n      canvas.style.width = \"100%\";\n      canvas.style.height = \"\";\n    } else {\n      canvas.style.width = \"\";\n      canvas.style.height = \"100%\";\n    }\n  };\n\n  return { canvas, ctx };\n}\nfunction setUpKeyboard(): Record<\n  \"isDown\" | \"justPressed\" | \"justReleased\",\n  Record<string, boolean>\n> {\n  const keys: ReturnType<typeof setUpKeyboard> = {\n    isDown: {},\n    justPressed: {},\n    justReleased: {},\n  };\n\n  globalThis.onkeydown = (e) => {\n    !keys.isDown[e.key] && (keys.justPressed[e.key] = true);\n    keys.isDown[e.key] = true;\n  };\n  globalThis.onkeyup = (e) => {\n    keys.isDown[e.key] = false;\n    keys.justReleased[e.key] = true;\n  };\n\n  return keys;\n}\nfunction updateKeyboard(\n  keys: Record<\n    \"isDown\" | \"justPressed\" | \"justReleased\",\n    Record<string, boolean>\n  >,\n) {\n  for (const key in keys.justPressed) keys.justPressed[key] = false;\n  for (const key in keys.justReleased) keys.justReleased[key] = false;\n}\nfunction setUpPointer() {\n  const pointer = {\n    x: 0,\n    y: 0,\n    isDown: false,\n    justPressed: false,\n    justReleased: false,\n    pressPos: { x: 0, y: 0 },\n    releasePos: { x: 0, y: 0 },\n  };\n\n  globalThis.onpointerdown = (e) => {\n    if (!(e.target instanceof HTMLCanvasElement)) return;\n    ((pointer.x = e.x), (pointer.y = e.y));\n    Object.assign(pointer.pressPos, pointer);\n    pointer.isDown = pointer.justPressed = true;\n  };\n\n  globalThis.onpointerup = (e) => {\n    ((pointer.x = e.x), (pointer.y = e.y));\n    Object.assign(pointer.releasePos, pointer);\n    ((pointer.isDown = false), (pointer.justReleased = true));\n  };\n\n  globalThis.onpointermove = (e) => {\n    ((pointer.x = e.x), (pointer.y = e.y));\n  };\n\n  return pointer;\n}\nfunction updatePointer(\n  pointer: Record<\"isDown\" | \"justPressed\" | \"justReleased\", boolean>,\n) {\n  pointer.justPressed = false;\n  pointer.justReleased = false;\n}\nfunction setUpTime() {\n  return { dtMilli: 0, timeMilli: 0 };\n}\nfunction updateTime(time: { dtMilli: number; timeMilli: number }) {\n  time.dtMilli = performance.now() - time.timeMilli;\n  time.timeMilli += time.dtMilli;\n}\n\n// systems\nfunction checkOnScreenEntities(world: World) {\n  const camEntity = world\n    .query({ and: [Camera, Transform] })\n    .find((e) => world.getComponent(e, Camera).isActive);\n  if (!camEntity) return;\n  const cam = world.getComponent(camEntity, Camera);\n  const camTransform = world.getComponent(camEntity, Transform);\n  world.query({ and: [Rect, Transform] }).forEach((e) => {\n    const r = world.getComponent(e, Rect);\n    const t = world.getComponent(e, Transform);\n    rectsOverlap(\n      camTransform.x,\n      camTransform.y,\n      Ctx2D.canvas.width / cam.zoom,\n      Ctx2D.canvas.height / cam.zoom,\n      t.x + r.offsetX + r.width / 2,\n      t.y + r.offsetY + r.height / 2,\n      r.width,\n      r.height,\n    )\n      ? world.addComponent(e, OnScreen)\n      : world.removeComponent(e, OnScreen);\n  });\n}\nfunction handlePIDControllers(world: World) {\n  world.query({ and: [PIDController] }).forEach((e) => {\n    const pid = world.getComponent(e, PIDController);\n    pid.result =\n      pid.kp * pid.currentErr +\n      pid.ki * pid.accumErr +\n      (pid.kd * (pid.currentErr - pid.prevErr) * 1000) / Time.dtMilli;\n    pid.prevErr = pid.currentErr * +!pid.reset;\n    pid.accumErr = (pid.accumErr + pid.currentErr) * +!pid.reset;\n  });\n}\nfunction handleParticleEmitters(world: World) {\n  world.query({ and: [OnScreen, ParticleEmitter, Transform] }).forEach((e) => {\n    const emitter = world.getComponent(e, ParticleEmitter);\n    if (!emitter.emit || !world.hasComponent(emitter.particleEntity, Transform))\n      return;\n    emitter.emit = false;\n    const t = world.getComponent(e, Transform);\n    const particle = world.copyEntity(emitter.particleEntity);\n    const particleTransform = world.getComponent(particle, Transform);\n    Object.assign(particleTransform, t);\n    const timer = world.addComponent(particle, Timer);\n    particleTransform.rad =\n      t.rad + emitter.spreadRadians * (Math.random() - 0.5);\n    world.addComponent(particle, Velocity, {\n      x: Math.cos(particleTransform.rad) * emitter.speed,\n      y: Math.sin(particleTransform.rad) * emitter.speed,\n    });\n    world.addComponent(particle, Callback).callback = () => {\n      if (timer.timeMilli < emitter.particleLifetimeSeconds * 1000) {\n        emitter.particleTransition(\n          world,\n          particle,\n          timer.timeMilli / 1000 / emitter.particleLifetimeSeconds,\n        );\n        return;\n      }\n      world.deleteEntity(particle);\n    };\n  });\n}\nfunction handleInput(world: World) {\n  const camEntity = world\n    .query({ and: [Camera, Transform] })\n    .find((e) => world.getComponent(e, Camera).isActive);\n  if (camEntity == undefined) return;\n  const camera = world.getComponent(camEntity, Camera);\n  const camTransform = world.getComponent(camEntity, Transform);\n  const pressPos = pointerToScreen(Pointer.pressPos, Ctx2D.canvas);\n  world.query({ and: [PathFinder, PlayerControl] }).forEach((e) => {\n    if (!Pointer.justPressed || !canPlayerMove) return;\n    const pf = world.getComponent(e, PathFinder);\n    const worldPos = screenToWorld(\n      pressPos,\n      camTransform,\n      camera.tilt,\n      camera.zoom,\n    );\n    pf.targetX = worldPos.x;\n    pf.targetY = worldPos.y;\n  });\n}\nfunction handlePathfind(world: World) {\n  world\n    .query({ and: [PathFinder, Transform, Velocity, Stats] })\n    .forEach((e) => {\n      const pf = world.getComponent(e, PathFinder);\n      const p = world.getComponent(e, Transform);\n      const v = world.getComponent(e, Velocity);\n      const s = world.getComponent(e, Stats);\n\n      const dx = pf.targetX - p.x;\n      const dy = pf.targetY - p.y;\n      const dMag = (dx * dx + dy * dy) ** 0.5;\n      if (dMag == 0) return;\n      const controlDistance = ((s.moveSpeed * Time.dtMilli) / 1000) * 2;\n      const adjustedSpeed =\n        dMag > controlDistance\n          ? s.moveSpeed\n          : (s.moveSpeed * dMag) / controlDistance;\n      v.x = (dx / dMag) * adjustedSpeed;\n      v.y = (dy / dMag) * adjustedSpeed;\n    });\n}\nfunction handleTimers(world: World) {\n  world\n    .query({ and: [Timer, Callback] })\n    .forEach((e) => world.getComponent(e, Callback).callback(e));\n  world.query({ and: [Timer] }).forEach((e) => {\n    const t = world.getComponent(e, Timer);\n    if (t.reset) t.timeMilli = 0;\n    t.reset = false;\n    if (!t.stop) t.timeMilli += Time.dtMilli;\n  });\n}\nfunction drawTexts(world: World) {\n  const old = Ctx2D.ctx.fillStyle;\n  world.query({ and: [Text, Transform] }).forEach((e) => {\n    const t = world.getComponent(e, Text);\n    const p = world.getComponent(e, Transform);\n    Ctx2D.ctx.font = `${t.fontSize}px serif`;\n    const lines = t.content.split(\"\\n\");\n    Ctx2D.ctx.fillStyle = t.backgroundColor;\n    for (let i = 0, l = lines.length; i < l; i++) {\n      const txtMetric = Ctx2D.ctx.measureText(lines[i]);\n      Ctx2D.ctx.fillRect(\n        p.x,\n        p.y + i * (2 * t.padding) + i * txtMetric.fontBoundingBoxAscent,\n        t.padding * 2 + txtMetric.width,\n        t.padding * 2 + txtMetric.fontBoundingBoxAscent,\n      );\n    }\n    Ctx2D.ctx.fillStyle = t.color;\n    for (let i = 0, l = lines.length; i < l; i++) {\n      const txtMetric = Ctx2D.ctx.measureText(lines[i]);\n      Ctx2D.ctx.fillText(\n        lines[i],\n        p.x + t.padding,\n        p.y + i * (2 * t.padding) + (i + 1) * txtMetric.fontBoundingBoxAscent,\n      );\n    }\n  });\n  Ctx2D.ctx.fillStyle = old;\n}\nfunction drawRects(world: World) {\n  const oldF = Ctx2D.ctx.fillStyle;\n  const oldS = Ctx2D.ctx.strokeStyle;\n  world.query({ and: [Transform, Rect, Colour, OnScreen] }).forEach((e) => {\n    const p = world.getComponent(e, Transform);\n    const r = world.getComponent(e, Rect);\n    const c = world.getComponent(e, Colour);\n    Ctx2D.ctx.fillStyle = c.fill;\n    Ctx2D.ctx.strokeStyle = c.stroke;\n    const cos = Math.cos(p.rad);\n    const sin = Math.sin(p.rad);\n    Ctx2D.ctx.transform(cos, sin, -sin, cos, p.x, p.y);\n    Ctx2D.ctx.fillRect(\n      r.offsetX * p.scaleX,\n      r.offsetY * p.scaleY,\n      r.width * p.scaleX,\n      r.height * p.scaleY,\n    );\n    Ctx2D.ctx.strokeRect(\n      r.offsetX * p.scaleX,\n      r.offsetY * p.scaleY,\n      r.width * p.scaleX,\n      r.height * p.scaleY,\n    );\n    Ctx2D.ctx.transform(\n      cos,\n      -sin,\n      sin,\n      cos,\n      cos * -p.x + sin * -p.y,\n      -sin * -p.x + cos * -p.y,\n    );\n  });\n  Ctx2D.ctx.fillStyle = oldF;\n  Ctx2D.ctx.strokeStyle = oldS;\n}\nfunction drawPathFindTargets(world: World) {\n  const old = Ctx2D.ctx.fillStyle;\n  Ctx2D.ctx.fillStyle = \"red\";\n  world.query({ and: [PathFinder] }).forEach((e) => {\n    const pf = world.getComponent(e, PathFinder);\n    Ctx2D.ctx.fillRect(pf.targetX - 0.5, pf.targetY - 0.5, 1, 1);\n  });\n  Ctx2D.ctx.fillStyle = old;\n}\nfunction handleCamera(world: World) {\n  const camEntity = world\n    .query({ and: [Camera, Transform] })\n    .find((e) => world.getComponent(e, Camera).isActive);\n  if (!camEntity) return;\n  Ctx2D.ctx.resetTransform();\n  const c = world.getComponent(camEntity, Camera);\n  const p = world.getComponent(camEntity, Transform);\n  if (c.targetEntity != -1 && world.hasComponent(c.targetEntity, Transform)) {\n    const targetPos = world.getComponent(c.targetEntity, Transform);\n    Object.assign(p, targetPos);\n  }\n  const sin = Math.sin(c.tilt) * c.zoom;\n  const cos = Math.cos(c.tilt) * c.zoom;\n  Ctx2D.ctx.transform(\n    cos,\n    sin,\n    -sin,\n    cos,\n    cos * -p.x - sin * -p.y + Ctx2D.ctx.canvas.width * 0.5,\n    sin * -p.x + cos * -p.y + Ctx2D.ctx.canvas.height * 0.5,\n  );\n}\nfunction move(world: World) {\n  const dt = Time.dtMilli / 1000;\n  world.query({ and: [Transform, Velocity] }).forEach((e) => {\n    const p = world.getComponent(e, Transform);\n    const v = world.getComponent(e, Velocity);\n    p.x += v.x * dt;\n    p.y += v.y * dt;\n  });\n}\nfunction drawImg(world: World) {\n  world.query({ and: [Graphic, Transform] }).forEach((e) => {\n    const g = world.getComponent(e, Graphic);\n    const p = world.getComponent(e, Transform);\n    const img = new Image();\n    img.src = g.src;\n    let imgWidth = img.width;\n    let imgHeight = img.height;\n    let offsetX = 0;\n    let offsetY = 0;\n    if (world.hasComponent(e, Rect)) {\n      const r = world.getComponent(e, Rect);\n      imgWidth = r.width;\n      imgHeight = r.height;\n      offsetX = r.offsetX;\n      offsetY = r.offsetY;\n    }\n    const scaleX = imgWidth / img.width;\n    const scaleY = imgHeight / img.height;\n    const c = Math.cos(p.rad);\n    const s = Math.sin(p.rad);\n    Ctx2D.ctx.transform(\n      c * scaleX,\n      s * scaleX,\n      -s * scaleY,\n      c * scaleY,\n      p.x,\n      p.y,\n    );\n    Ctx2D.ctx.drawImage(img, offsetX, offsetY);\n    Ctx2D.ctx.transform(\n      c / scaleX,\n      -s / scaleX,\n      s / scaleY,\n      c / scaleY,\n      (c * -p.x + s * -p.y) / scaleY,\n      (-s * -p.x + c * -p.y) / scaleY,\n    );\n  });\n}\nfunction handleButtons(world: World) {\n  const pressPos = pointerToScreen(Pointer.pressPos, Ctx2D.canvas);\n  const releasePos = pointerToScreen(Pointer.releasePos, Ctx2D.canvas);\n  const pointerPos = pointerToScreen(\n    { x: Pointer.x, y: Pointer.y },\n    Ctx2D.canvas,\n  );\n  world.query({ and: [Button, Transform, Rect, Callback] }).forEach((e) => {\n    const p = world.getComponent(e, Transform);\n    const b = world.getComponent(e, Button);\n    const r = world.getComponent(e, Rect);\n    const cb = world.getComponent(e, Callback);\n    const pressedWithinButton =\n      (pressPos.x - p.x) ** 2 < (r.width / 2) ** 2 &&\n      (pressPos.y - p.y) ** 2 < (r.height / 2) ** 2;\n    b.hovered =\n      (pointerPos.x - p.x) ** 2 < (r.width / 2) ** 2 &&\n      (pointerPos.y - p.y) ** 2 < (r.height / 2) ** 2;\n    b.pressed = b.hovered && Pointer.isDown && pressedWithinButton;\n    b.clicked =\n      Pointer.justReleased &&\n      pressedWithinButton &&\n      (releasePos.x - p.x) ** 2 < (r.width / 2) ** 2 &&\n      (releasePos.y - p.y) ** 2 < (r.height / 2) ** 2;\n    cb.callback(e);\n  });\n}\nfunction drawHealthBars(world: World) {\n  const oldFill = Ctx2D.ctx.fillStyle;\n  const widthMult = 1.5;\n  const barHeight = 0.3;\n  const margin = 0.2;\n  world.query({ and: [OnScreen, Health, Transform, Rect] }).forEach((e) => {\n    const t = world.getComponent(e, Transform);\n    const r = world.getComponent(e, Rect);\n    const h = world.getComponent(e, Health);\n    const cos = Math.cos(t.rad);\n    const sin = Math.sin(t.rad);\n    let x = -(r.width * widthMult) / 2;\n    let y = -barHeight / 2 + r.offsetY - 1;\n    Ctx2D.ctx.fillStyle = \"black\";\n    Ctx2D.ctx.fillRect(\n      t.x - margin / 2 + cos * x - sin * y,\n      t.y - margin / 2 + sin * x + cos * y,\n      r.width * widthMult + margin,\n      barHeight + margin,\n    );\n    x = (-r.width * widthMult) / 2;\n    y = -barHeight / 2 + r.offsetY - 1;\n    Ctx2D.ctx.fillStyle = \"green\";\n    Ctx2D.ctx.fillRect(\n      t.x + cos * x - sin * y,\n      t.y + sin * x + cos * y,\n      r.width * widthMult * (h.current / h.max),\n      barHeight,\n    );\n  });\n  Ctx2D.ctx.fillStyle = oldFill;\n}\n\n// entities\nfunction addGraphic(world: World, src: string, x = 0, y = 0, w = 1, h = 1) {\n  const e = world.addEntity();\n  world.addComponent(e, Transform, { x, y });\n  world.addComponent(e, Graphic, { src });\n  world.addComponent(e, Rect, { width: w, height: h });\n  return e;\n}\nfunction addRect(\n  world: World,\n  x = 0,\n  y = 0,\n  w = 1,\n  h = 1,\n  offsetX = -w / 2,\n  offsetY = -h / 2,\n) {\n  const e = world.addEntity();\n  world.addComponent(e, Transform, { x, y });\n  world.addComponent(e, Rect, { width: w, height: h, offsetX, offsetY });\n  world.addComponent(e, Colour);\n  world.addComponent(e, OnScreen);\n  return e;\n}\nfunction addButton(\n  world: World,\n  x = 0,\n  y = 0,\n  w = 10,\n  h = 10,\n  cb = (e: entityT) => {\n    const b = inGameUi.getComponent(e, Button);\n    const c = inGameUi.getComponent(e, Colour);\n    c.fill = \"grey\";\n    if (b.hovered) {\n      canPlayerMove = false;\n      c.fill = \"lightgrey\";\n    }\n    if (b.pressed) {\n      c.fill = \"red\";\n    }\n    if (b.clicked) {\n      c.fill = \"green\";\n    }\n  },\n) {\n  const e = addRect(world, x, y, w, h);\n  world.addComponent(e, Button);\n  world.addComponent(e, Colour);\n  world.addComponent(e, Callback, { callback: cb });\n  world.addComponent(e, Text, {\n    content: \"Button\",\n    backgroundColor: \"transparent\",\n    color: \"white\",\n  });\n  return e;\n}\nfunction addTimerWithCallback(world: World, cb: (e: entityT) => void) {\n  const e = world.addEntity();\n  world.addComponent(e, Timer);\n  world.addComponent(e, Callback).callback = cb;\n  return e;\n}\nfunction addPlayer(world: World, x = 0, y = 0) {\n  const player = addRect(world, x, y, 1, 1);\n  world.addComponent(player, Velocity);\n  world.addComponent(player, Stats, {\n    ...config.entities.player,\n  });\n  world.addComponent(player, Health, {\n    max: config.entities.player.healthPoint,\n    current: config.entities.player.healthPoint,\n  });\n  world.addComponent(player, PlayerControl);\n  world.addComponent(player, PathFinder, { targetX: x, targetY: y });\n  return player;\n}\nfunction addTurrent(world: World, x: number, y: number) {\n  const turrent = addRect(world, x, y, 3, 10, -1.5, -10);\n  world.addComponent(turrent, Stats, { ...config.entities.turrent });\n  world.addComponent(turrent, Health, {\n    max: config.entities.turrent.healthPoint,\n    current: config.entities.turrent.healthPoint,\n  });\n  return turrent;\n}\nfunction addCamera(world: World, x: number, y: number) {\n  const cam = world.addEntity();\n  world.addComponent(cam, Camera, { zoom: 30 });\n  world.addComponent(cam, Transform, { x, y });\n  return cam;\n}\n\n//utils\nfunction drawBg(color: string = \"#424242\") {\n  const old = Ctx2D.ctx.fillStyle;\n  Ctx2D.ctx.fillStyle = color;\n  Ctx2D.ctx.fillRect(0, 0, Ctx2D.canvas.width, Ctx2D.canvas.height);\n  Ctx2D.ctx.fillStyle = old;\n}\nfunction rectsOverlap(\n  cx1: number,\n  cy1: number,\n  w1: number,\n  h1: number,\n  cx2: number,\n  cy2: number,\n  w2: number,\n  h2: number,\n): boolean {\n  return (\n    (cx1 - cx2) ** 2 < ((w1 + w2) / 2) ** 2 &&\n    (cy1 - cy2) ** 2 < ((h1 + h2) / 2) ** 2\n  );\n}\ntype vec2 = { x: number; y: number };\nfunction screenToWorld(\n  pointerPos: vec2,\n  cameraPos: vec2,\n  cameraTilt: number,\n  cameraZoom: number,\n): vec2 {\n  const cos = Math.cos(cameraTilt);\n  const sin = Math.sin(cameraTilt);\n  const res = { x: 0, y: 0 };\n  const x = pointerPos.x - config.viewport.width / 2;\n  const y = pointerPos.y - config.viewport.height / 2;\n  res.x = cos * x + sin * y;\n  res.y = -sin * x + cos * y;\n  res.x /= cameraZoom;\n  res.y /= cameraZoom;\n  res.x += cameraPos.x;\n  res.y += cameraPos.y;\n  return res;\n}\nfunction worldToScreen(\n  pos: vec2,\n  cameraPos: vec2,\n  cameraTilt: number,\n  cameraZoom: number,\n): vec2 {\n  const c = Math.cos(cameraTilt);\n  const s = Math.sin(cameraTilt);\n  const res = { x: 0, y: 0 };\n  let x = pos.x - cameraPos.x;\n  let y = pos.y - cameraPos.y;\n  x *= cameraZoom;\n  y *= cameraZoom;\n  res.x = c * x - s * y;\n  res.y = s * x + c * y;\n  res.x += config.viewport.width * 0.5;\n  res.y += config.viewport.height * 0.5;\n  return res;\n}\n// credit: https://www.30secondsofcode.org/js/s/detect-device-type/\nfunction detectDeviceType(): string {\n  return /Mobile|Android|iPhone|iPad/i.test(navigator.userAgent)\n    ? \"Mobile\"\n    : \"Desktop\";\n}\nfunction pointerToScreen(pointer: vec2, canvas: HTMLCanvasElement): vec2 {\n  const out = { x: 0, y: 0 };\n  const rect = canvas.getBoundingClientRect();\n  out.x = pointer.x - rect.left;\n  out.y = pointer.y - rect.top;\n  if (innerWidth / innerHeight < canvas.width / canvas.height) {\n    out.x *= canvas.width / innerWidth;\n    out.y *= canvas.width / innerWidth;\n  } else {\n    out.x *= canvas.height / innerHeight;\n    out.y *= canvas.height / innerHeight;\n  }\n  return out;\n}\n\n// initialization\nCtx2D.canvas.width = config.viewport.width;\nCtx2D.canvas.height = config.viewport.height;\nCtx2D.canvas.style.imageRendering = \"pixelated\";\nCtx2D.ctx.lineWidth = 0.1;\n\nconst game = new World();\n\nconst turrent = addTurrent(game, 10, 0);\ngame.addComponent(turrent, ParticleEmitter, {\n  particleEntity: turrent,\n  speed: 20,\n  spreadRadians: Math.PI * 0.25,\n});\ngame.addComponent(turrent, Timer);\ngame.addComponent(turrent, Callback).callback = (e: entityT) => {\n  const t = game.hasComponent(e, Timer) && game.getComponent(e, Timer);\n  if (!t) return;\n  if (t.timeMilli < 50) return;\n  t.reset = true;\n  game.hasComponent(e, ParticleEmitter) &&\n    (game.getComponent(e, ParticleEmitter).emit = true);\n};\n\nfor (let i = 0; i < 2; i++) {\n  const copy = game.copyEntity(turrent);\n  game.getComponent(copy, Transform).y += 15 * (i + 1);\n  game.getComponent(copy, ParticleEmitter).particleEntity = copy;\n}\n\nconst player = addPlayer(game, 0, 0);\ngame.getComponent(player, Health).current *= 0.6;\n\nconst map = addGraphic(game, \"./assets/Map_of_MOBA.svg\", -150, -150, 300, 300);\n\nconst cam = addCamera(game, 0, 0);\nconst camComponent = game.getComponent(cam, Camera);\ncamComponent.targetEntity = player;\ncamComponent.isActive = true;\ncamComponent.zoom = 15;\n\nconst cleaner = game.addEntity();\ngame.addComponent(cleaner, Timer);\ngame.addComponent(cleaner, Callback, {\n  callback: (e: entityT) => {\n    const t = game.getComponent(e, Timer);\n    if (t.timeMilli < 5000) return;\n    t.reset = true;\n    game.cleanObjectPools();\n  },\n});\n\nconst qt = new Quadtree({ cx: 0, cy: 0, width: 1e10, height: 1e10 });\n\nconst inGameUi = new World();\n\naddButton(\n  inGameUi,\n  config.viewport.width * 0.9,\n  config.viewport.height * 0.8,\n  config.viewport.height * 0.3,\n  config.viewport.height * 0.3,\n);\n\nconst debugTextEntity = inGameUi.addEntity();\nconst debugText = inGameUi.addComponent(debugTextEntity, Text, {\n  content: \"test string\",\n  backgroundColor: \"white\",\n});\ninGameUi.addComponent(debugTextEntity, Transform);\n\n{\n  (function update() {\n    requestAnimationFrame(update);\n\n    const playerTransform = game.getComponent(player, Transform);\n    debugText.content = `FPS: ${Math.ceil(1000 / Time.dtMilli)}\\nEntity count: ${game.entityCount()}\\nDevice type: ${detectDeviceType()}\\nPos: (${Math.floor(playerTransform.x)}, ${Math.floor(playerTransform.y)})`;\n\n    // drawing\n    // drawBg();\n    game.update(\n      handleCamera,\n      checkOnScreenEntities,\n      drawImg,\n      drawRects,\n      // drawPathFindTargets,\n      drawHealthBars,\n    );\n    Ctx2D.ctx.resetTransform();\n    inGameUi.update(drawImg, drawRects, drawTexts);\n\n    // processing\n    inGameUi.update(handleButtons);\n    game.update(\n      handleParticleEmitters,\n      handlePathfind,\n      handleInput,\n      handleTimers,\n      move,\n    );\n\n    updatePointer(Pointer);\n    updateKeyboard(Keys);\n    updateTime(Time);\n    canPlayerMove = true;\n  })();\n}\n"],
  "mappings": "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",
  "names": ["ObjectPoolMap", "objectFactory", "key", "index", "temp", "backKey", "ComponentManager", "component", "ObjectPoolMap", "entity", "entry", "src", "dest", "newEntity", "World", "ComponentManager", "entity", "newEntity", "src", "dest", "mask", "a", "component", "values", "compMask", "fns", "i", "l", "query", "andMask", "notMask", "res", "entry", "config_default", "Quads", "Quadtree", "boundary", "maxDepth", "rect", "index", "parentBound", "i", "r1", "r2", "Stats", "Health", "Callback", "Transform", "Velocity", "PlayerControl", "OnScreen", "ParticleEmitter", "world", "particleEntity", "percentageLifeTime", "t", "Transform", "Camera", "Rect", "Graphic", "Button", "Colour", "Text", "Timer", "PathFinder", "Ctx2D", "setUpCanvas2D", "Pointer", "setUpPointer", "Keys", "setUpKeyboard", "Time", "setUpTime", "canPlayerMove", "canvas", "ctx", "keys", "e", "updateKeyboard", "key", "pointer", "updatePointer", "updateTime", "time", "checkOnScreenEntities", "camEntity", "cam", "camTransform", "r", "rectsOverlap", "handleParticleEmitters", "world", "OnScreen", "ParticleEmitter", "Transform", "e", "emitter", "t", "particle", "particleTransform", "timer", "Timer", "Velocity", "Callback", "handleInput", "camEntity", "Camera", "camera", "camTransform", "pressPos", "pointerToScreen", "Pointer", "Ctx2D", "PathFinder", "PlayerControl", "canPlayerMove", "pf", "worldPos", "screenToWorld", "handlePathfind", "Stats", "p", "v", "s", "dx", "dy", "dMag", "controlDistance", "Time", "adjustedSpeed", "handleTimers", "drawTexts", "old", "Text", "lines", "i", "l", "txtMetric", "drawRects", "oldF", "oldS", "Rect", "Colour", "r", "c", "cos", "sin", "handleCamera", "world", "camEntity", "Camera", "Transform", "e", "Ctx2D", "c", "p", "targetPos", "sin", "cos", "move", "dt", "Time", "Velocity", "v", "drawImg", "Graphic", "g", "img", "imgWidth", "imgHeight", "offsetX", "offsetY", "Rect", "r", "scaleX", "scaleY", "s", "handleButtons", "pressPos", "pointerToScreen", "Pointer", "releasePos", "pointerPos", "Button", "Callback", "b", "cb", "pressedWithinButton", "drawHealthBars", "oldFill", "widthMult", "barHeight", "margin", "OnScreen", "Health", "t", "h", "x", "y", "addGraphic", "src", "w", "addRect", "Colour", "addButton", "inGameUi", "canPlayerMove", "Text", "addPlayer", "world", "x", "y", "player", "addRect", "Velocity", "Stats", "config_default", "Health", "PlayerControl", "PathFinder", "addTurrent", "turrent", "addCamera", "cam", "Camera", "Transform", "rectsOverlap", "cx1", "cy1", "w1", "h1", "cx2", "cy2", "w2", "h2", "screenToWorld", "pointerPos", "cameraPos", "cameraTilt", "cameraZoom", "cos", "sin", "res", "x", "config_default", "y", "detectDeviceType", "pointerToScreen", "pointer", "canvas", "out", "rect", "Ctx2D", "config_default", "game", "World", "turrent", "addTurrent", "ParticleEmitter", "Timer", "Callback", "i", "copy", "Transform", "player", "addPlayer", "Health", "map", "addGraphic", "cam", "addCamera", "camComponent", "Camera", "cleaner", "qt", "Quadtree", "inGameUi", "addButton", "debugTextEntity", "debugText", "Text", "update", "playerTransform", "Time", "handleCamera", "checkOnScreenEntities", "drawImg", "drawRects", "drawHealthBars", "drawTexts", "handleButtons", "handleParticleEmitters", "handlePathfind", "handleInput", "handleTimers", "move", "updatePointer", "Pointer", "updateKeyboard", "Keys", "updateTime", "canPlayerMove"]
}
