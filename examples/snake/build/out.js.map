{
  "version": 3,
  "sources": ["../../../src/pool.ts", "../../../src/component.ts", "../../../src/entity.ts", "../../../src/world.ts", "../src/main.ts"],
  "sourcesContent": ["export class ObjectPoolMap<K, V> {\n  private storage: V[] = [];\n  private map: Map<K, V> = new Map();\n  private objectFactory: () => V;\n\n  constructor(objectFactory: () => V) {\n    this.objectFactory = objectFactory;\n  }\n\n  size() {\n    return this.map.size;\n  }\n\n  add(key: K): V {\n    const value = this.map.get(key);\n    if (value) return value;\n    this.storage.push(this.objectFactory());\n    this.map.set(key, this.storage[this.storage.length - 1]);\n    return this.storage[this.storage.length - 1];\n  }\n\n  remove(key: K) {\n    this.map.delete(key);\n  }\n\n  get(key: K): V {\n    const value = this.map.get(key);\n    if (!value) throw new Error(\"Key not found\");\n    return value;\n  }\n\n  has(key: K): boolean {\n    return this.map.has(key);\n  }\n\n  clean() {\n    this.storage.splice(this.map.size);\n  }\n}\n", "import { ObjectPoolMap } from \"./pool.ts\";\nimport { entityT } from \"./entity.ts\";\n\nexport class ComponentManager {\n  private pools: Map<object, ObjectPoolMap<entityT, object>> = new Map();\n  private idMap: Map<object, number> = new Map();\n\n  register<T extends object>(component: T) {\n    if (this.pools.has(component)) return;\n    this.idMap.set(component, this.idMap.size);\n    this.pools.set(\n      component,\n      new ObjectPoolMap<entityT, T>(() => ({ ...component })),\n    );\n  }\n\n  getId<T extends object>(component: T): number {\n    return this.idMap.get(component) ?? -1;\n  }\n\n  add<T extends object>(entity: entityT, component: T): T {\n    return Object.assign(\n      (this.pools.get(component) as ObjectPoolMap<entityT, T>).add(entity),\n      component,\n    );\n  }\n\n  remove<T extends object>(entity: entityT, component: T) {\n    (this.pools.get(component) as ObjectPoolMap<entityT, T>).remove(entity);\n  }\n\n  get<T extends object>(entity: entityT, component: T): T {\n    return (this.pools.get(component) as ObjectPoolMap<entityT, T>).get(entity);\n  }\n\n  size<T extends object>(component: T): number {\n    return (this.pools.get(component) as ObjectPoolMap<entityT, T>).size();\n  }\n\n  delete(entity: entityT) {\n    for (const p of this.pools.values()) {\n      p.remove(entity);\n    }\n  }\n\n  copy(srcEntity: entityT, destEntity: entityT) {\n    for (const p of this.pools.values()) {\n      p.has(srcEntity) && Object.assign(p.add(destEntity), p.get(srcEntity));\n    }\n  }\n\n  clean() {\n    for (const p of this.pools.values()) {\n      p.clean();\n    }\n  }\n}\n", "export type entityT = number;\nexport function newEntity(): entityT {\n  return Math.random();\n}\n", "import { ComponentManager } from \"./component.ts\";\nimport { newEntity, type entityT } from \"./entity.ts\";\n\nexport type queryT = Partial<Record<\"and\" | \"not\", object[]>>;\n\nexport class World {\n  private maskMap: Map<number, number> = new Map();\n  private archetypeMap: Map<number, Set<entityT>> = new Map();\n  private entitiesToDelete: entityT[] = [];\n  private compManager = new ComponentManager();\n\n  addEntity(entity: entityT = newEntity()): entityT {\n    this.maskMap.set(entity, 0);\n    this.getArchetype(0).add(entity);\n    return entity;\n  }\n\n  copyEntity(src: entityT, dest: entityT = newEntity()): entityT {\n    this.compManager.copy(src, dest);\n    const mask = this.maskMap.get(src) ?? 0;\n    this.maskMap.set(dest, mask);\n    this.getArchetype(mask).add(dest);\n    return dest;\n  }\n\n  private getArchetype(mask: number): Set<entityT> {\n    const a = this.archetypeMap.get(mask) ?? new Set();\n    this.archetypeMap.set(mask, a);\n    return a;\n  }\n\n  deleteEntity(entity: entityT) {\n    this.entitiesToDelete.push(entity);\n  }\n\n  registerComponent<T extends object>(component: T): World {\n    this.compManager.register(component);\n    return this;\n  }\n\n  hasComponent<T extends object>(entity: entityT, component: T): boolean {\n    return (\n      ((this.maskMap.get(entity) ?? 0) &\n        (1 << this.compManager.getId(component))) >\n      0\n    );\n  }\n\n  addComponent<T extends object>(\n    entity: entityT,\n    component: T,\n    values: Partial<T> = component,\n  ): T {\n    this.registerComponent(component);\n    let mask = this.maskMap.get(entity) ?? 0;\n    const compId = this.compManager.getId(component);\n    if ((mask & (1 << compId)) != 0) {\n      return Object.assign(this.compManager.get(entity, component), values);\n    }\n    this.getArchetype(mask).delete(entity);\n    mask |= 1 << compId;\n    this.maskMap.set(entity, mask);\n    this.getArchetype(mask).add(entity);\n    return Object.assign(this.compManager.add(entity, component), values);\n  }\n\n  removeComponent<T extends object>(entity: entityT, component: T) {\n    this.registerComponent(component);\n    let mask = this.maskMap.get(entity) ?? 0;\n    const compId = this.compManager.getId(component);\n    if ((mask & (1 << compId)) == 0) return false;\n    this.getArchetype(mask).delete(entity);\n    mask &= ~(1 << compId);\n    this.maskMap.set(entity, mask);\n    this.getArchetype(mask).add(entity);\n    this.compManager.remove(entity, component);\n  }\n\n  getComponent<T extends object>(entity: entityT, component: T): T {\n    return this.compManager.get(entity, component);\n  }\n\n  update(...fns: ((world: World) => void)[]) {\n    for (let i = 0, l = fns.length; i < l; i++) fns[i](this);\n    this.commitEntityDeletion();\n  }\n\n  commitEntityDeletion() {\n    while (this.entitiesToDelete.length) {\n      const entity = this.entitiesToDelete.pop() as entityT;\n      this.compManager.delete(entity);\n      const mask = this.maskMap.get(entity) ?? 0;\n      this.maskMap.delete(entity);\n      this.getArchetype(mask).delete(entity);\n    }\n  }\n\n  cleanObjectPools() {\n    this.compManager.clean();\n  }\n\n  query(query: queryT): entityT[] {\n    let andMask = 0,\n      notMask = 0;\n    if (query.and) {\n      for (let i = 0, l = query.and.length; i < l; i++) {\n        andMask |= 1 << this.compManager.getId(query.and[i]);\n      }\n    }\n    if (query.not) {\n      for (let i = 0, l = query.not.length; i < l; i++) {\n        notMask |= 1 << this.compManager.getId(query.not[i]);\n      }\n    }\n    const res: entityT[] = [];\n    this.archetypeMap.forEach((v, k) => {\n      const set = v;\n      set.size > 0 &&\n        (k & andMask) == andMask &&\n        (k & notMask) == 0 &&\n        res.push(...set);\n    });\n    return [...new Set(res)];\n  }\n\n  entityCount(): number {\n    return this.maskMap.size;\n  }\n}\n", "import { World } from \"bozoecs\";\n\n// singletons\nconst Ctx2D = setUpCanvas2D();\nconst Time = setUpTime();\nconst Keys = setUpKeyboard();\nconst Pointer = setUpPointer();\nconst Game = {\n  snakeWidth: 10,\n  foodRadius: 15,\n  startLength: 5,\n  foodColor: \"#F0A0A0\",\n  snakeColor: \"#F0D0D0\",\n};\n\nfunction setUpCanvas2D(): {\n  canvas: HTMLCanvasElement;\n  ctx: CanvasRenderingContext2D;\n} {\n  const canvas =\n    document.querySelector(\"canvas\") ?? document.createElement(\"canvas\");\n  if (!canvas) throw new Error(\"Cannot create canvas element.\");\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) throw new Error(\"Cannot initialize context 2d.\");\n\n  document.body.appendChild(canvas);\n\n  globalThis.onresize = globalThis.onload = () => {\n    if (innerWidth / innerHeight < canvas.width / canvas.height) {\n      canvas.style.width = \"100%\";\n      canvas.style.height = \"\";\n    } else {\n      canvas.style.width = \"\";\n      canvas.style.height = \"100%\";\n    }\n  };\n\n  return { canvas, ctx };\n}\nfunction setUpTime() {\n  return { dtMilli: 0, timeMilli: 0 };\n}\nfunction updateTime(time: { dtMilli: number; timeMilli: number }) {\n  time.dtMilli = performance.now() - time.timeMilli;\n  time.timeMilli += time.dtMilli;\n}\nfunction setUpKeyboard(): Record<\n  \"isDown\" | \"justPressed\" | \"justReleased\",\n  Record<string, boolean>\n> {\n  const keys: ReturnType<typeof setUpKeyboard> = {\n    isDown: {},\n    justPressed: {},\n    justReleased: {},\n  };\n\n  globalThis.onkeydown = (e) => {\n    !keys.isDown[e.key] && (keys.justPressed[e.key] = true);\n    keys.isDown[e.key] = true;\n  };\n  globalThis.onkeyup = (e) => {\n    keys.isDown[e.key] = false;\n    keys.justReleased[e.key] = true;\n  };\n\n  return keys;\n}\nfunction updateKeyboard(\n  keys: Record<\n    \"isDown\" | \"justPressed\" | \"justReleased\",\n    Record<string, boolean>\n  >,\n) {\n  for (const key in keys.justPressed) keys.justPressed[key] = false;\n  for (const key in keys.justReleased) keys.justReleased[key] = false;\n}\nfunction setUpPointer() {\n  const pointer = {\n    x: 0,\n    y: 0,\n    isDown: false,\n    justPressed: false,\n    justReleased: false,\n    pressPos: { x: 0, y: 0 },\n    releasePos: { x: 0, y: 0 },\n  };\n\n  globalThis.onpointerdown = (e) => {\n    if (!(e.target instanceof HTMLCanvasElement)) return;\n    ((pointer.x = e.x), (pointer.y = e.y));\n    Object.assign(pointer.pressPos, pointer);\n    pointer.isDown = pointer.justPressed = true;\n  };\n\n  globalThis.onpointerup = (e) => {\n    ((pointer.x = e.x), (pointer.y = e.y));\n    Object.assign(pointer.releasePos, pointer);\n    ((pointer.isDown = false), (pointer.justReleased = true));\n  };\n\n  globalThis.onpointermove = (e) => {\n    ((pointer.x = e.x), (pointer.y = e.y));\n  };\n\n  return pointer;\n}\nfunction updatePointer(\n  pointer: Record<\"isDown\" | \"justPressed\" | \"justReleased\", boolean>,\n) {\n  pointer.justPressed = false;\n  pointer.justReleased = false;\n}\n\n// components\nconst Transform = { x: 0, y: 0, rad: 0 };\nconst Velocity = { x: 0, y: 0 };\nconst Hierarchy = { parent: -1, child: -1 };\nconst PlayerControl = {};\nconst isFood = {};\n\n// systems\nfunction handleMovement(world: World) {\n  world.query({ and: [Transform, Velocity] }).forEach((e) => {\n    const p = world.getComponent(e, Transform);\n    const v = world.getComponent(e, Velocity);\n    p.x += (v.x * Time.dtMilli) / 1000;\n    p.y += (v.y * Time.dtMilli) / 1000;\n    if (v.x == 0 && v.y == 0) return;\n    p.rad = Math.atan2(v.y, v.x);\n  });\n}\nfunction handleDrawing(world: World) {\n  Ctx2D.ctx.fillStyle = \"#202020\";\n  Ctx2D.ctx.fillRect(0, 0, Ctx2D.canvas.width, Ctx2D.canvas.height);\n  Ctx2D.ctx.fillStyle = Game.foodColor;\n  Ctx2D.ctx.beginPath();\n  world.query({ and: [Transform, isFood] }).forEach((e) => {\n    const p = world.getComponent(e, Transform);\n    Ctx2D.ctx.ellipse(\n      p.x,\n      p.y,\n      Game.foodRadius,\n      Game.foodRadius,\n      0,\n      0,\n      Math.PI * 2,\n    );\n  });\n  Ctx2D.ctx.fill();\n  Ctx2D.ctx.beginPath();\n  world.query({ and: [Transform, Hierarchy] }).forEach((e) => {\n    const h = world.getComponent(e, Hierarchy);\n    const p = world.getComponent(e, Transform);\n    Ctx2D.ctx.moveTo(p.x, p.y);\n    if (h.child != -1 && world.hasComponent(h.child, Transform)) {\n      const childTransform = world.getComponent(h.child, Transform);\n      Ctx2D.ctx.lineTo(childTransform.x, childTransform.y);\n    }\n  });\n  Ctx2D.ctx.strokeStyle = Game.snakeColor;\n  Ctx2D.ctx.lineCap = \"round\";\n  Ctx2D.ctx.lineWidth = Game.snakeWidth;\n  Ctx2D.ctx.stroke();\n\n  const tail = world.query({ and: [Hierarchy] }).find((e) => {\n    return world.getComponent(e, Hierarchy).child == -1;\n  });\n  if (tail) {\n    const tailTransform = world.getComponent(tail, Transform);\n    const c = Math.cos(tailTransform.rad);\n    const s = Math.sin(tailTransform.rad);\n    Ctx2D.ctx.beginPath();\n    let x = 0;\n    let y = -Game.snakeWidth / 2;\n    Ctx2D.ctx.moveTo(\n      c * x - s * y + tailTransform.x,\n      s * x + c * y + tailTransform.y,\n    );\n    x = 0;\n    y = +Game.snakeWidth / 2;\n    Ctx2D.ctx.lineTo(\n      c * x - s * y + tailTransform.x,\n      s * x + c * y + tailTransform.y,\n    );\n    x = -Game.snakeWidth * 2;\n    y = 0;\n    Ctx2D.ctx.lineTo(\n      c * x - s * y + tailTransform.x,\n      s * x + c * y + tailTransform.y,\n    );\n    Ctx2D.ctx.fillStyle = Game.snakeColor;\n    Ctx2D.ctx.fill();\n  }\n\n  const head = world.query({ and: [Hierarchy] }).find((e) => {\n    return world.getComponent(e, Hierarchy).parent == -1;\n  });\n  if (head) {\n    Ctx2D.ctx.fillStyle = \"white\";\n    const headTransform = world.getComponent(head, Transform);\n    const c = Math.cos(headTransform.rad);\n    const s = Math.sin(headTransform.rad);\n    const offset = 5;\n    const eyeRadius = 4;\n    const pupilRadius = 2;\n    Ctx2D.ctx.beginPath();\n    let x = 0;\n    let y = -offset;\n    const leftEyeX = c * x - s * y + headTransform.x;\n    const leftEyeY = s * x + c * y + headTransform.y;\n    Ctx2D.ctx.ellipse(\n      leftEyeX,\n      leftEyeY,\n      eyeRadius,\n      eyeRadius,\n      headTransform.rad,\n      0,\n      Math.PI * 2,\n    );\n    x = 0;\n    y = offset;\n    const rightEyeX = c * x - s * y + headTransform.x;\n    const rightEyeY = s * x + c * y + headTransform.y;\n    Ctx2D.ctx.ellipse(\n      rightEyeX,\n      rightEyeY,\n      eyeRadius,\n      eyeRadius,\n      headTransform.rad,\n      0,\n      Math.PI * 2,\n    );\n    Ctx2D.ctx.fill();\n    Ctx2D.ctx.fillStyle = \"black\";\n    Ctx2D.ctx.beginPath();\n    let leftPupilX = leftEyeX;\n    let leftPupilY = leftEyeY;\n    const food = world.query({ and: [isFood, Transform] })[0];\n    if (food) {\n      const foodTransform = world.getComponent(food, Transform);\n      let dirX = foodTransform.x - leftPupilX;\n      let dirY = foodTransform.y - leftPupilY;\n      const mag = (dirX ** 2 + dirY ** 2) ** 0.5;\n      ((dirX /= mag), (dirY /= mag));\n      const eyePupilDiff = eyeRadius - pupilRadius;\n      leftPupilX += dirX * eyePupilDiff;\n      leftPupilY += dirY * eyePupilDiff;\n    }\n    Ctx2D.ctx.ellipse(\n      leftPupilX,\n      leftPupilY,\n      pupilRadius,\n      pupilRadius,\n      headTransform.rad,\n      0,\n      Math.PI * 2,\n    );\n    let rightPupilX = rightEyeX;\n    let rightPupilY = rightEyeY;\n    if (food) {\n      const foodTransform = world.getComponent(food, Transform);\n      let dirX = foodTransform.x - rightPupilX;\n      let dirY = foodTransform.y - rightPupilY;\n      const mag = (dirX ** 2 + dirY ** 2) ** 0.5;\n      ((dirX /= mag), (dirY /= mag));\n      const eyePupilDiff = eyeRadius - pupilRadius;\n      rightPupilX += dirX * eyePupilDiff;\n      rightPupilY += dirY * eyePupilDiff;\n    }\n    Ctx2D.ctx.ellipse(\n      rightPupilX,\n      rightPupilY,\n      pupilRadius,\n      pupilRadius,\n      headTransform.rad,\n      0,\n      Math.PI * 2,\n    );\n    Ctx2D.ctx.fill();\n  }\n\n  Ctx2D.ctx.fillStyle = \"white\";\n  Ctx2D.ctx.fillText(\n    `Score: ${world.query({ and: [Hierarchy] }).length - Game.startLength}; Best: ${localStorage.getItem(\"snake_best\") ?? 0}`,\n    0,\n    10,\n  );\n}\nfunction handleInput(world: World) {\n  world.query({ and: [PlayerControl, Velocity] }).forEach((e) => {\n    const v = world.getComponent(e, Velocity);\n    let angularVel = 0;\n    if (\n      Keys.isDown[\"a\"] ||\n      Keys.isDown[\"ArrowLeft\"] ||\n      (Pointer.isDown && Pointer.x < innerWidth / 2)\n    ) {\n      angularVel -= Math.PI;\n    }\n    if (\n      Keys.isDown[\"d\"] ||\n      Keys.isDown[\"ArrowRight\"] ||\n      (Pointer.isDown && Pointer.x > innerWidth / 2)\n    ) {\n      angularVel += Math.PI;\n    }\n    const c = Math.cos((angularVel * Time.dtMilli) / 1000);\n    const s = Math.sin((angularVel * Time.dtMilli) / 1000);\n    const x = v.x,\n      y = v.y;\n    v.x = c * x - s * y;\n    v.y = s * x + c * y;\n  });\n}\nfunction handleReset(world: World) {\n  world\n    .query({ and: [PlayerControl, Transform, Hierarchy, Velocity] })\n    .forEach((e) => {\n      const p = world.getComponent(e, Transform);\n      const collidedBody = world\n        .query({ and: [Hierarchy], not: [PlayerControl] })\n        .find((other) => {\n          const otherH = world.getComponent(other, Hierarchy);\n          if (otherH.parent == e) return false;\n          const otherP = world.getComponent(other, Transform);\n          return (otherP.x - p.x) ** 2 + (otherP.y - p.y) ** 2 < 6 ** 2;\n        });\n      if (\n        p.x > Ctx2D.canvas.width ||\n        p.x < 0 ||\n        p.y > Ctx2D.canvas.height ||\n        p.y < 0 ||\n        world.entityCount() < Game.startLength ||\n        collidedBody != undefined\n      ) {\n        const score =\n          world.query({ and: [Hierarchy] }).length - Game.startLength;\n        if (\n          score > Number.parseInt(localStorage.getItem(\"snake_best\") ?? \"0\")\n        ) {\n          localStorage.setItem(\"snake_best\", score.toString());\n        }\n        p.x = Ctx2D.canvas.width / 2;\n        p.y = Ctx2D.canvas.height / 2;\n        world\n          .query({ not: [PlayerControl] })\n          .forEach((e) => world.deleteEntity(e));\n        world.getComponent(e, Hierarchy).child = -1;\n        const v = world.getComponent(e, Velocity);\n        ((v.x = 40), (v.y = 0));\n        let parent = e;\n        for (let i = 0; i < Game.startLength - 1; i++) {\n          const bodyPart = world.addEntity();\n          world.addComponent(bodyPart, Velocity);\n          world.addComponent(bodyPart, Hierarchy, { parent });\n          const parentTransform = world.getComponent(parent, Transform);\n          world.addComponent(bodyPart, Transform, {\n            x: parentTransform.x - 6,\n            y: parentTransform.y,\n          });\n          world.getComponent(parent, Hierarchy).child = bodyPart;\n          parent = bodyPart;\n        }\n      }\n    });\n}\nfunction handleSpawnFood(world: World) {\n  const food = world.query({ and: [isFood] });\n  if (food.length > 0) return;\n  // spawn food\n  const foodEntity = world.addEntity();\n  world.addComponent(foodEntity, isFood);\n  world.addComponent(foodEntity, Transform, {\n    x: Math.random() * Ctx2D.canvas.width,\n    y: Math.random() * Ctx2D.canvas.height,\n  });\n}\nfunction handleEatFood(world: World) {\n  world.query({ and: [PlayerControl, Transform] }).forEach((e) => {\n    const playerTransform = world.getComponent(e, Transform);\n    world.query({ and: [isFood, Transform] }).forEach((foodE) => {\n      const foodTransform = world.getComponent(foodE, Transform);\n      if (\n        (playerTransform.x - foodTransform.x) ** 2 <\n          ((Game.snakeWidth + Game.foodRadius) / 2) ** 2 &&\n        (playerTransform.y - foodTransform.y) ** 2 <\n          ((Game.snakeWidth + Game.foodRadius) / 2) ** 2\n      ) {\n        world.deleteEntity(foodE);\n        const parent = world\n          .query({ and: [Hierarchy] })\n          .find((e) => world.getComponent(e, Hierarchy).child == -1);\n        if (\n          !parent ||\n          !world.hasComponent(parent, Transform) ||\n          !world.hasComponent(parent, Hierarchy)\n        )\n          return;\n        // spawn new body part\n        const bodyPart = world.addEntity();\n        world.addComponent(bodyPart, Velocity);\n        world.addComponent(bodyPart, Hierarchy, { parent });\n        world.addComponent(\n          bodyPart,\n          Transform,\n          world.getComponent(parent, Transform),\n        );\n        world.getComponent(parent, Hierarchy).child = bodyPart;\n      }\n    });\n  });\n}\nfunction handleEntityHierarchy(world: World) {\n  world.query({ and: [Hierarchy, Transform, Velocity] }).forEach((e) => {\n    const h = world.getComponent(e, Hierarchy);\n    const p = world.getComponent(e, Transform);\n    const v = world.getComponent(e, Velocity);\n    if (\n      h.parent != -1 &&\n      world.hasComponent(h.parent, Transform) &&\n      world.hasComponent(h.parent, Velocity)\n    ) {\n      const parentTransform = world.getComponent(h.parent, Transform);\n      if (\n        (p.x - parentTransform.x) ** 2 + (p.y - parentTransform.y) ** 2 <\n        50\n      ) {\n        v.x = v.y = 0;\n        return;\n      }\n      const parentVelocity = world.getComponent(h.parent, Velocity);\n      const velocityMag =\n        (parentVelocity.x ** 2 + parentVelocity.y ** 2) ** 0.5;\n      const dx = parentTransform.x - p.x;\n      const dy = parentTransform.y - p.y;\n      const distance = (dx ** 2 + dy ** 2) ** 0.5;\n      v.x = (dx / distance) * velocityMag;\n      v.y = (dy / distance) * velocityMag;\n    }\n  });\n}\n\n// initialization\nconst game = new World();\nconst player = game.addEntity();\ngame.addComponent(player, Transform, {\n  x: Ctx2D.canvas.width / 2,\n  y: Ctx2D.canvas.height / 2,\n});\ngame.addComponent(player, Velocity, { x: 40 });\ngame.addComponent(player, PlayerControl);\ngame.addComponent(player, Hierarchy);\n\n// loop\n{\n  (function update() {\n    requestAnimationFrame(update);\n    game.update(\n      handleDrawing,\n      handleReset,\n      handleSpawnFood,\n      handleEatFood,\n      handleInput,\n      handleEntityHierarchy,\n      handleMovement,\n    );\n    updateTime(Time);\n    updateKeyboard(Keys);\n    updatePointer(Pointer);\n  })();\n}\n"],
  "mappings": "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",
  "names": ["ObjectPoolMap", "objectFactory", "key", "value", "ComponentManager", "component", "ObjectPoolMap", "entity", "p", "srcEntity", "destEntity", "newEntity", "World", "ComponentManager", "entity", "newEntity", "src", "dest", "mask", "a", "component", "values", "compId", "fns", "i", "l", "query", "andMask", "notMask", "res", "v", "k", "set", "Ctx2D", "setUpCanvas2D", "Time", "setUpTime", "Keys", "setUpKeyboard", "Pointer", "setUpPointer", "Game", "canvas", "ctx", "updateTime", "time", "keys", "updateKeyboard", "key", "pointer", "updatePointer", "Transform", "Velocity", "Hierarchy", "PlayerControl", "isFood", "handleMovement", "world", "p", "v", "handleDrawing", "e", "h", "childTransform", "tail", "tailTransform", "c", "s", "x", "y", "head", "headTransform", "offset", "eyeRadius", "pupilRadius", "leftEyeX", "leftEyeY", "rightEyeX", "rightEyeY", "leftPupilX", "leftPupilY", "food", "foodTransform", "dirX", "dirY", "mag", "eyePupilDiff", "rightPupilX", "rightPupilY", "handleInput", "angularVel", "handleReset", "collidedBody", "other", "otherP", "score", "parent", "i", "bodyPart", "parentTransform", "handleSpawnFood", "foodEntity", "handleEatFood", "playerTransform", "foodE", "handleEntityHierarchy", "parentVelocity", "velocityMag", "dx", "dy", "distance", "game", "World", "player", "update"]
}
