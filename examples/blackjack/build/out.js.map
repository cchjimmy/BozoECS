{
  "version": 3,
  "sources": ["../../../src/pool.ts", "../../../src/component.ts", "../../../src/entity.ts", "../../../src/world.ts", "../src/cards.ts", "../src/main.ts"],
  "sourcesContent": ["export class ObjectPoolMap<K, V> {\n  private storage: V[] = [];\n  private keyToIndex: Map<K, number> = new Map();\n  private indexToKey: K[] = [];\n  private objectFactory: () => V;\n\n  constructor(objectFactory: () => V) {\n    this.objectFactory = objectFactory;\n  }\n\n  size() {\n    return this.keyToIndex.size;\n  }\n\n  add(key: K): V {\n    if (this.keyToIndex.has(key))\n      return this.storage[this.keyToIndex.get(key) as number];\n    if (this.storage.length <= this.keyToIndex.size)\n      this.storage.push(this.objectFactory());\n    this.keyToIndex.set(key, this.keyToIndex.size);\n    this.indexToKey[this.keyToIndex.size - 1] = key;\n    return this.storage[this.keyToIndex.get(key) as number];\n  }\n\n  remove(key: K): void {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) return;\n    const backKey = this.indexToKey[this.keyToIndex.size - 1];\n    const temp = this.storage[index];\n    this.storage[index] = this.storage[this.keyToIndex.size - 1];\n    this.storage[this.keyToIndex.size - 1] = temp;\n    this.indexToKey[index] = backKey;\n    this.indexToKey.pop();\n    this.keyToIndex.set(backKey, index);\n    this.keyToIndex.delete(key);\n  }\n\n  get(key: K): V {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) throw new Error(\"Key not found.\");\n    return this.storage[index];\n  }\n\n  has(key: K): boolean {\n    return this.keyToIndex.has(key);\n  }\n\n  clean(): void {\n    this.storage.splice(this.keyToIndex.size);\n  }\n}\n", "import { ObjectPoolMap } from \"./pool.ts\";\nimport { entityT } from \"./entity.ts\";\n\nexport class ComponentManager {\n  private poolMap: Map<object, ObjectPoolMap<entityT, object>> = new Map();\n  private idMap: Map<object, number> = new Map();\n\n  register<T extends object>(component: T): void {\n    if (this.poolMap.has(component)) return;\n    this.idMap.set(component, this.idMap.size);\n    this.poolMap.set(\n      component,\n      new ObjectPoolMap<entityT, T>(() => ({ ...component })),\n    );\n  }\n\n  getId<T extends object>(component: T): number {\n    const mask = this.idMap.get(component);\n    if (mask != undefined) return mask;\n    this.register(component);\n    return this.idMap.get(component) as number;\n  }\n\n  add<T extends object>(entity: entityT, component: T): T {\n    return Object.assign(\n      (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).add(entity),\n      component,\n    );\n  }\n\n  remove<T extends object>(entity: entityT, component: T): void {\n    (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).remove(entity);\n  }\n\n  has<T extends object>(entity: entityT, component: T): boolean {\n    return (\n      this.poolMap.has(component) &&\n      (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).has(entity)\n    );\n  }\n\n  get<T extends object>(entity: entityT, component: T): T {\n    return (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).get(\n      entity,\n    );\n  }\n\n  size<T extends object>(component: T): number {\n    return (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).size();\n  }\n\n  delete(entity: entityT): void {\n    for (const entry of this.poolMap.entries()) entry[1].remove(entity);\n  }\n\n  copy(src: entityT, dest: entityT): void {\n    for (const entry of this.poolMap.entries())\n      entry[1].has(src) && Object.assign(entry[1].add(dest), entry[1].get(src));\n  }\n\n  clean(): void {\n    for (const entry of this.poolMap.entries()) entry[1].clean();\n  }\n}\n", "export type entityT = number;\nexport function newEntity(): entityT {\n  return Math.random();\n}\n", "import { ComponentManager } from \"./component.ts\";\nimport { newEntity, type entityT } from \"./entity.ts\";\n\nexport type queryT = Partial<Record<\"and\" | \"not\", object[]>>;\n\nexport type systemT = (world: World) => void;\n\nexport class World {\n  private compEntityMap: Map<number, Set<entityT>> = new Map();\n  private compManager = new ComponentManager();\n  private entitySet: Set<entityT> = new Set();\n\n  addEntity(entity: entityT = newEntity()): entityT {\n    this.entitySet.add(entity);\n    return entity;\n  }\n\n  copyEntity(src: entityT, dest: entityT = newEntity()): entityT {\n    this.compManager.copy(src, dest);\n    for (const entry of this.compEntityMap) {\n      if (!entry[1].has(src)) continue;\n      entry[1].add(dest);\n    }\n    this.entitySet.add(dest);\n    return dest;\n  }\n\n  private getCompEntityMap(compId: number): Set<entityT> {\n    const a = this.compEntityMap.get(compId) ?? new Set();\n    this.compEntityMap.set(compId, a);\n    return a;\n  }\n\n  deleteEntity(entity: entityT) {\n    this.compManager.delete(entity);\n    for (const entry of this.compEntityMap) {\n      entry[1].delete(entity);\n    }\n    this.entitySet.delete(entity);\n  }\n\n  registerComponent<T extends object>(component: T): World {\n    this.compManager.register(component);\n    return this;\n  }\n\n  hasComponent<T extends object>(entity: entityT, component: T): boolean {\n    return this.compManager.has(entity, component);\n  }\n\n  addComponent<T extends object>(\n    entity: entityT,\n    component: T,\n    values: Partial<T> = component,\n  ): T {\n    this.compManager.register(component);\n    const cem = this.getCompEntityMap(this.compManager.getId(component));\n    if (cem.has(entity))\n      return Object.assign(this.compManager.get(entity, component), values);\n    cem.add(entity);\n    return Object.assign(this.compManager.add(entity, component), values);\n  }\n\n  removeComponent<T extends object>(entity: entityT, component: T): void {\n    this.compManager.register(component);\n    const cem = this.getCompEntityMap(this.compManager.getId(component));\n    if (!cem.has(entity)) return;\n    cem.delete(entity);\n  }\n\n  getComponent<T extends object>(entity: entityT, component: T): T {\n    return this.compManager.get(entity, component);\n  }\n\n  update(...fns: systemT[]) {\n    for (let i = 0, l = fns.length; i < l; i++) fns[i](this);\n  }\n\n  cleanObjectPools(): void {\n    this.compManager.clean();\n  }\n\n  query(query: queryT): entityT[] {\n    let res: Set<entityT> = this.entitySet;\n    if (query.and) {\n      for (const comp of query.and) {\n        res = res.intersection(\n          this.getCompEntityMap(this.compManager.getId(comp)),\n        );\n      }\n    }\n    if (query.not) {\n      for (const comp of query.not) {\n        res = res.difference(\n          this.getCompEntityMap(this.compManager.getId(comp)),\n        );\n      }\n    }\n    return [...res];\n  }\n\n  entityCount(): number {\n    return this.entitySet.size;\n  }\n}\n", "function roundRectQuarter(\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n  radius: number,\n) {\n  const path = new Path2D();\n  path.moveTo(x + w / 2, y);\n  path.arcTo(x + w, y, x + w, y + h / 2, radius);\n  path.lineTo(x + w, y + h / 2);\n  return path;\n}\nfunction drawCardSuits(): {\n  hearts: Path2D;\n  spades: Path2D;\n  clubs: Path2D;\n  diamonds: Path2D;\n} {\n  const paths: {\n    hearts: Path2D;\n    spades: Path2D;\n    clubs: Path2D;\n    diamonds: Path2D;\n  } = {\n    hearts: new Path2D(),\n    spades: new Path2D(),\n    clubs: new Path2D(),\n    diamonds: new Path2D(),\n  };\n  const symbolMargin = 1;\n  {\n    const path = paths[\"hearts\"];\n    const c = Math.cos(Math.PI / 4);\n    const s = Math.sin(Math.PI / 4);\n    let x = symbolMargin / 4;\n    const y = symbolMargin / 4;\n    const r = symbolMargin / 4;\n    path.arc(x, y, r, 0, Math.PI * 2);\n    path.arc(x + symbolMargin / 2, y, r, 0, Math.PI * 2);\n    path.moveTo(x + -s * r, y + c * r);\n    path.lineTo(symbolMargin / 2, symbolMargin);\n    x += symbolMargin / 2;\n    path.lineTo(x + c * r, y + s * r);\n  }\n  {\n    const path = paths[\"spades\"];\n    const x = symbolMargin / 4;\n    const y = symbolMargin / 2;\n    const r = symbolMargin / 4;\n    const c = Math.cos(Math.PI / 4);\n    const s = Math.sin(Math.PI / 4);\n    path.arc(x, y, r, 0, Math.PI * 2);\n    path.arc(x + symbolMargin / 2, y, r, 0, Math.PI * 2);\n    path.moveTo(x + c * -r, y + s * -r);\n    path.lineTo(symbolMargin / 2, 0);\n    path.lineTo(x + symbolMargin / 2 + -s * -r, y + c * -r);\n    path.moveTo(symbolMargin / 2, y);\n    path.lineTo(x + symbolMargin / 8, symbolMargin);\n    path.lineTo((symbolMargin / 8) * 5, symbolMargin);\n    path.closePath();\n  }\n  {\n    // credits: https://en.wikipedia.org/wiki/Rhombus#Inradius\n    const path = paths[\"diamonds\"];\n    const inradius =\n      (symbolMargin * (symbolMargin - symbolMargin / 4)) /\n      (2 * (symbolMargin ** 2 + (symbolMargin - symbolMargin / 4) ** 2) ** 0.5);\n    path.arc(symbolMargin / 2, symbolMargin / 2, inradius, 0, Math.PI * 2);\n    path.moveTo(symbolMargin / 2, 0);\n    path.lineTo(symbolMargin / 8, symbolMargin / 2);\n    path.lineTo(symbolMargin / 2, symbolMargin);\n    path.lineTo(symbolMargin - symbolMargin / 8, symbolMargin / 2);\n    path.closePath();\n  }\n  {\n    const path = paths[\"clubs\"];\n    const x = symbolMargin / 4;\n    const y = symbolMargin / 2;\n    const r = symbolMargin / 4;\n    path.arc(symbolMargin / 2, r, r, 0, Math.PI * 2);\n    path.arc(x, y, r, 0, Math.PI * 2);\n    path.arc(x + symbolMargin / 2, y, r, 0, Math.PI * 2);\n    path.moveTo(symbolMargin / 2, y);\n    path.lineTo(x + symbolMargin / 8, symbolMargin);\n    path.lineTo((symbolMargin / 8) * 5, symbolMargin);\n    path.closePath();\n  }\n  return paths;\n}\nfunction drawCard(\n  cardWidth = 1,\n  cardHeight = 1.43,\n  cardRound = 0.05,\n  symbol: \"hearts\" | \"spades\" | \"diamonds\" | \"clubs\",\n  text: string,\n  paths: Record<typeof symbol, Path2D>,\n  ctx: CanvasRenderingContext2D,\n  isBack = false,\n) {\n  const cardPadding = cardWidth * 0.03;\n  const symbolMargin = cardWidth / 2;\n\n  // rotation\n  const c = Math.cos(Math.PI);\n  const s = Math.sin(Math.PI);\n  const x = cardWidth;\n  const y = cardHeight;\n\n  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n\n  // card body\n  ctx.fillStyle = \"lightgrey\";\n  ctx.beginPath();\n  ctx.roundRect(0, 0, cardWidth, cardHeight, cardRound);\n  ctx.fill();\n  ctx.save();\n  ctx.clip();\n  ctx.strokeStyle = \"black\";\n  ctx.lineWidth = 1;\n  ctx.stroke();\n  if (isBack) {\n    ctx.fillStyle = \"darkgrey\";\n  } else {\n    ctx.fillStyle = \"silver\";\n  }\n  ctx.beginPath();\n  ctx.roundRect(\n    cardPadding,\n    cardPadding,\n    cardWidth - cardPadding * 2,\n    cardHeight - cardPadding * 2,\n    cardRound,\n  );\n  ctx.fill();\n  if (isBack) {\n    ctx.save();\n    ctx.clip();\n    ctx.strokeStyle = \"silver\";\n    ctx.lineWidth = cardWidth * 0.05;\n    const path = new Path2D();\n    for (let i = cardHeight / 2; i > 0; i -= ctx.lineWidth * 2) {\n      path.ellipse(cardWidth * 0.5, 0, cardWidth * 0.5, i, 0, 0, Math.PI);\n    }\n    ctx.setTransform(c, s, -s, c, x, y);\n    ctx.transform(1, 0, 0, 1, cardWidth / 2, 0);\n    ctx.stroke(path);\n    ctx.transform(c, s, -s, c, x, y);\n    ctx.stroke(path);\n    ctx.transform(1, 0, 0, 1, cardWidth, 0);\n    ctx.stroke(path);\n    ctx.transform(c, s, -s, c, x, y);\n    ctx.stroke(path);\n    ctx.resetTransform();\n    ctx.restore();\n  }\n\n  ctx.strokeStyle = \"gold\";\n  ctx.fillStyle = \"gold\";\n\n  // decorative lines\n  if (!isBack) {\n    {\n      ctx.lineWidth = cardWidth / 30;\n      const path = new Path2D();\n      path.moveTo(cardPadding, cardHeight * 0.7 + cardPadding);\n      path.arcTo(\n        cardPadding,\n        cardHeight - cardPadding,\n        cardWidth * 0.3 - cardPadding,\n        cardHeight - cardPadding,\n        ctx.lineWidth,\n      );\n      path.lineTo(cardWidth * 0.3 - cardPadding, cardHeight - cardPadding);\n      ctx.stroke(path);\n      ctx.transform(c, s, -s, c, x, y);\n      ctx.stroke(path);\n      ctx.resetTransform();\n    }\n    {\n      ctx.lineWidth = cardWidth / 100;\n      const path = new Path2D();\n      path.moveTo(cardPadding * 2, cardHeight * 0.7 + cardPadding * 2);\n      path.arcTo(\n        cardPadding * 2,\n        cardHeight - cardPadding * 2,\n        cardWidth * 0.3 - cardPadding * 2,\n        cardHeight - cardPadding * 2,\n        ctx.lineWidth,\n      );\n      path.lineTo(\n        cardWidth * 0.3 - cardPadding * 2,\n        cardHeight - cardPadding * 2,\n      );\n      ctx.stroke(path);\n      ctx.transform(c, s, -s, c, x, y);\n      ctx.stroke(path);\n      ctx.resetTransform();\n    }\n  } else {\n    ctx.lineWidth = cardWidth / 30;\n    const path = roundRectQuarter(\n      cardPadding,\n      cardPadding,\n      cardWidth - cardPadding * 2,\n      cardHeight - cardPadding * 2,\n      ctx.lineWidth,\n    );\n    ctx.stroke(path);\n    ctx.setTransform(c, s, -s, c, x, y);\n    ctx.stroke(path);\n    ctx.resetTransform();\n\n    ctx.lineWidth = cardWidth / 100;\n    ctx.roundRect(\n      cardPadding * 2,\n      cardPadding * 2,\n      cardWidth - cardPadding * 4,\n      cardHeight - cardPadding * 4,\n      ctx.lineWidth,\n    );\n    ctx.stroke();\n  }\n\n  // draw suits and ranks\n  ctx.lineWidth = cardWidth / 10000;\n  ctx.transform(symbolMargin, 0, 0, symbolMargin, cardPadding, cardPadding);\n  if (!isBack) ctx.stroke(paths[symbol]);\n  ctx.resetTransform();\n  ctx.font = `${cardWidth / 2.5}px sans-serif`;\n  const textMetrics = ctx.measureText(text);\n  ctx.fillText(\n    text,\n    (cardWidth - cardPadding * 2) / 4 - textMetrics.width / 2 + cardPadding,\n    cardHeight / 2 + textMetrics.emHeightAscent,\n  );\n  ctx.transform(c, s, -s, c, x, y);\n  ctx.fillText(\n    text,\n    (cardWidth - cardPadding * 2) / 4 - textMetrics.width / 2 + cardPadding,\n    cardHeight / 2 + textMetrics.emHeightAscent,\n  );\n  ctx.transform(symbolMargin, 0, 0, symbolMargin, cardPadding, cardPadding);\n  if (!isBack) ctx.stroke(paths[symbol]);\n  ctx.resetTransform();\n  ctx.restore();\n}\nexport function generateDeck(\n  cardWidth = 1,\n  cardHeight = 1.43,\n  cardRound = 0.05,\n) {\n  const suits = drawCardSuits();\n  const ranks = [\n    \"A\",\n    \"2\",\n    \"3\",\n    \"4\",\n    \"5\",\n    \"6\",\n    \"7\",\n    \"8\",\n    \"9\",\n    \"10\",\n    \"J\",\n    \"Q\",\n    \"K\",\n  ] as const;\n  const canvas = document.createElement(\"canvas\");\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) throw new Error(\"cannot initialize 2d context.\");\n  canvas.width = cardWidth;\n  canvas.height = cardHeight;\n  const suitNames = Object.keys(suits);\n  const deck: Record<string, HTMLImageElement> = {};\n  drawCard(cardWidth, cardHeight, cardRound, \"hearts\", \"\", suits, ctx, true);\n  const cardBack = new Image();\n  cardBack.src = canvas.toDataURL();\n  deck[\"back\"] = cardBack;\n  for (let i = 0, l = suitNames.length * ranks.length; i < l; i++) {\n    const suitIndex = Math.floor(i / ranks.length);\n    const rankIndex = i % ranks.length;\n    drawCard(\n      cardWidth,\n      cardHeight,\n      cardRound,\n      suitNames[suitIndex] as keyof typeof suits,\n      ranks[rankIndex],\n      suits,\n      ctx,\n    );\n    const img = new Image();\n    img.src = canvas.toDataURL();\n    deck[`${suitNames[suitIndex]}-${ranks[rankIndex]}`] = img;\n  }\n  return deck as Record<\n    `${keyof typeof suits}-${(typeof ranks)[number]}` | \"back\",\n    HTMLImageElement\n  >;\n}\n", "import { entityT, World } from \"bozoecs\";\nimport { generateDeck } from \"./cards.ts\";\n\n// credit: https://www.wikihow.com/Play-Blackjack\n\n// utils\nfunction setUpTime() {\n  const time = { dtMilli: 0, timeMilli: 0, dtSeconds: 0, timeSeconds: 0 };\n  return time;\n}\nfunction updateTime(time: {\n  dtMilli: number;\n  timeMilli: number;\n  dtSeconds: number;\n  timeSeconds: number;\n}) {\n  const now = performance.now();\n  time.dtMilli = now - time.timeMilli;\n  time.timeMilli += time.dtMilli;\n  time.dtSeconds = time.dtMilli / 1000;\n  time.timeSeconds = time.timeMilli / 1000;\n}\nfunction setUpPointers() {\n  const pointers: {\n    x: number[];\n    y: number[];\n    isDown: boolean[];\n    justPressed: boolean[];\n    justReleased: boolean[];\n  } = {\n    x: [],\n    y: [],\n    isDown: [],\n    justPressed: [],\n    justReleased: [],\n  };\n  globalThis.onpointerup = (e) => {\n    const id = e.pointerId;\n    pointers.x[id] = e.x;\n    pointers.y[id] = e.y;\n    pointers.isDown[id] = false;\n    pointers.justReleased[id] = true;\n  };\n  globalThis.onpointerdown = (e) => {\n    const id = e.pointerId;\n    pointers.x[id] = e.x;\n    pointers.y[id] = e.y;\n    pointers.isDown[id] = true;\n    pointers.justPressed[id] = true;\n  };\n  globalThis.onpointermove = (e) => {\n    const id = e.pointerId;\n    pointers.x[id] = e.x;\n    pointers.y[id] = e.y;\n  };\n  return pointers;\n}\nfunction updatePointers(pointers: {\n  justPressed: boolean[];\n  justReleased: boolean[];\n}) {\n  for (let i = 0, l = pointers.justPressed.length; i < l; i++) {\n    pointers.justPressed[i] = false;\n    pointers.justReleased[i] = false;\n  }\n}\nfunction setUpCanvas() {\n  let canvas = document.querySelector(\"canvas\");\n  if (!canvas) {\n    canvas = document.createElement(\"canvas\");\n    document.appendChild(canvas);\n  }\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) throw new Error(\"cannot initialize 2d context.\");\n  return { canvas, ctx };\n}\nfunction screen2World(x: number, y: number) {\n  const clientRect = Ctx2d.canvas.getBoundingClientRect();\n  const ratio =\n    Ctx2d.canvas.width / Ctx2d.canvas.height > innerWidth / innerHeight\n      ? innerWidth / Ctx2d.canvas.width\n      : innerHeight / Ctx2d.canvas.height;\n  return {\n    x: (x - clientRect.left) / ratio,\n    y: (y - clientRect.top) / ratio,\n  };\n}\nfunction isPointInRect(\n  px: number,\n  py: number,\n  rx: number,\n  ry: number,\n  rw: number,\n  rh: number,\n) {\n  return px > rx && px < rx + rw && py > ry && py < ry + rh;\n}\n// credit: https://stackoverflow.com/questions/951021/what-is-the-javascript-version-of-sleep\nfunction sleep(seconds: number) {\n  return new Promise((res) => setTimeout(res, seconds * 1000));\n}\nfunction calcHandValue(\n  world: World,\n  hand: entityT[] = [],\n  target: number = 21,\n) {\n  let value = 0;\n  const vals: number[][] = [];\n  const indices: number[] = [];\n  for (const e of hand) {\n    const c = world.getComponent(e, Card);\n    const values = CardValues[c.value].sort();\n    vals.push(values);\n    indices.push(values.length - 1);\n    value += values[values.length - 1];\n  }\n  let exhausted = false;\n  while (value > target && !exhausted) {\n    let indexSum = 0;\n    for (let i = 0, l = indices.length; i < l; i++) {\n      if (indices[i] == 0) continue;\n      indexSum += indices[i];\n      value -= vals[i][indices[i]];\n      indices[i]--;\n      value += vals[i][indices[i]];\n      if (value <= target) break;\n    }\n    exhausted = indexSum == 0;\n  }\n  return value;\n}\nfunction pickACard(world: World, forPlayer = true, revealed = true) {\n  let playersHand: entityT[] | undefined;\n  let dealersHand: entityT[] | undefined;\n  for (const e of world.query({ and: [Transform, EntityContainer] })) {\n    const t = world.getComponent(e, Transform);\n    const eC = world.getComponent(e, EntityContainer);\n    if (t.y == 0) dealersHand = eC.entities;\n    if (t.y == Ctx2d.canvas.height - CardSpec.height) playersHand = eC.entities;\n  }\n  if (!playersHand || !dealersHand) return;\n  const deck = world.query({ and: [Card], not: [InHand] });\n  if (deck.length == 0) return;\n  const picked = deck[Math.round(Math.random() * (deck.length - 1))];\n  world.addComponent(picked, InHand, {\n    isPlayer: forPlayer,\n    isRevealed: revealed,\n  });\n  const t = world.addComponent(picked, Transform, {\n    x: Game.deckX,\n    y: Game.deckY,\n  });\n  world.addComponent(picked, Graphic);\n  if (forPlayer) {\n    playersHand.push(picked);\n  } else {\n    dealersHand.push(picked);\n  }\n  // flipAnimation(t);\n}\nfunction splitHand(world: World) {\n  const inHandCards = world.query({ and: [InHand] });\n  const split: entityT[][] = [[], []];\n  const playersHand = 0;\n  const dealersHand = 1;\n  for (const e of inHandCards) {\n    split[\n      world.getComponent(e, InHand).isPlayer ? playersHand : dealersHand\n    ].push(e);\n  }\n  return split;\n}\nfunction setButtonsActivation(world: World, enabled = true) {\n  for (const e of world.query({ and: [Button] })) {\n    world.getComponent(e, Button).enabled = enabled;\n  }\n}\nasync function pickCard(world: World, forPlayer = true) {\n  const split = splitHand(world);\n  const playersHand = 0;\n  const dealersHand = 1;\n  if (split[playersHand].length == 0 && split[dealersHand].length == 0) {\n    setButtonsActivation(world, false);\n    for (let i = 0; i < 4; i++) {\n      pickACard(world, i % 2 != 0, i != 2);\n      await sleep(0.2);\n    }\n    setButtonsActivation(world, true);\n    return;\n  }\n  pickACard(world, forPlayer);\n}\nfunction resetGame(world: World) {\n  resetCards(world);\n  Game.credits = 100;\n  Game.minBet = 10;\n  Game.bet = Game.minBet;\n  Game.status = GAME_STATUSES.PLAY;\n  Game.rounds = 0;\n  Game.best = parseInt(localStorage.getItem(\"best_blackjack\") ?? \"0\");\n}\nfunction calculateCredits() {\n  switch (Game.status) {\n    case GAME_STATUSES.BLACKJACK:\n      // 3:2 ratio\n      Game.credits += Math.floor((Game.bet / 2) * 3);\n      break;\n    case GAME_STATUSES.LOSE:\n    case GAME_STATUSES.BUST:\n      Game.credits -= Game.bet;\n      break;\n    case GAME_STATUSES.WIN:\n      Game.credits += Game.bet;\n      break;\n    case GAME_STATUSES.PLAY:\n    case GAME_STATUSES.DRAW:\n  }\n}\nfunction resumeGame(world: World) {\n  resetCards(world);\n  Game.status = GAME_STATUSES.PLAY;\n  Game.rounds++;\n  if (Game.rounds % Game.roundsTilBetIncrease == 0) {\n    Game.minBet **= Game.betIncreaseExponent;\n    Game.minBet = Math.ceil(Game.minBet);\n  }\n  Game.bet = Math.max(Game.minBet, Game.bet);\n}\nfunction resetCards(world: World) {\n  for (const e of world.query({ and: [InHand] })) {\n    world.removeComponent(e, InHand);\n    world.addComponent(e, MovementTarget, { x: Game.deckX, y: Game.deckY });\n  }\n  for (const e of world.query({ and: [Transform, EntityContainer] })) {\n    const t = world.getComponent(e, Transform);\n    const eC = world.getComponent(e, EntityContainer);\n    if (t.y == 0 || t.y == Ctx2d.canvas.height - CardSpec.height) {\n      eC.entities.length = 0;\n    }\n  }\n}\nasync function handleDealer(world: World) {\n  const dealersHand = 1;\n  const split = splitHand(world);\n  setButtonsActivation(world, false);\n  if (split[dealersHand].length == 2) {\n    world.getComponent(split[dealersHand][1], InHand).isRevealed = true;\n    await sleep(1);\n  }\n  let value = calcHandValue(world, split[dealersHand]);\n  while (value <= Game.dealerHitThreashold) {\n    pickCard(world, false);\n    const split = splitHand(world);\n    value = calcHandValue(world, split[dealersHand]);\n    await sleep(1);\n  }\n  setButtonsActivation(world, true);\n  Game.status = checkWin(world);\n  calculateCredits();\n  if (Game.credits <= 0) {\n    Game.status = GAME_STATUSES.GAME_OVER;\n  }\n}\nfunction checkWin(world: World) {\n  const split = splitHand(world);\n  const playersHand = 0;\n  const dealersHand = 1;\n  const playersVal = calcHandValue(world, split[playersHand]);\n  const dealersVal = calcHandValue(world, split[dealersHand]);\n  if (Game.credits <= 0) return GAME_STATUSES.GAME_OVER;\n  if (playersVal > Game.targetVal) return GAME_STATUSES.BUST;\n  if (playersVal == dealersVal) return GAME_STATUSES.DRAW;\n  if (dealersVal == 0 || playersVal == 0) return GAME_STATUSES.PLAY;\n  if (playersVal == Game.targetVal && split[playersHand].length == 2)\n    return GAME_STATUSES.BLACKJACK;\n  if (dealersVal > playersVal && dealersVal <= Game.targetVal)\n    return GAME_STATUSES.LOSE;\n  if (\n    (playersVal > dealersVal && playersVal <= Game.targetVal) ||\n    dealersVal > Game.targetVal\n  )\n    return GAME_STATUSES.WIN;\n  return GAME_STATUSES.PLAY;\n}\nfunction onGameOver() {\n  Game.best = Game.best > Game.rounds ? Game.best : Game.rounds;\n  localStorage.setItem(\"best_blackjack\", Game.best.toString());\n}\nasync function flipAnimation(t: typeof Transform, duration = 0.5) {\n  const start = Time.timeSeconds;\n  const originalScaleX = t.scaleX;\n  while (Time.timeSeconds < start + duration) {\n    t.scaleX =\n      (originalScaleX *\n        (Math.cos(((Time.timeSeconds - start) / duration) * Math.PI * 2) + 1)) /\n      2;\n    await sleep(1 / 30); // 30 fps\n  }\n}\n\n// systems\nfunction handleCard2Img(world: World) {\n  for (const e of world.query({ and: [Card, Graphic] })) {\n    const c = world.getComponent(e, Card);\n    const g = world.getComponent(e, Graphic);\n    g.image = Deck[c.value];\n    if (!world.hasComponent(e, InHand)) {\n      g.image = Deck[\"back\"];\n    } else if (!world.getComponent(e, InHand).isRevealed) {\n      g.image = Deck[\"back\"];\n    }\n  }\n}\nfunction handleDrawImages(world: World) {\n  for (const e of world.query({ and: [Transform, Graphic] })) {\n    const t = world.getComponent(e, Transform);\n    const g = world.getComponent(e, Graphic);\n    const c = Math.cos(t.rad);\n    const s = Math.sin(t.rad);\n    Ctx2d.ctx.transform(c, s, -s, c, t.x, t.y);\n    Ctx2d.ctx.transform(t.scaleX, 0, 0, t.scaleY, 0, 0);\n    Ctx2d.ctx.drawImage(g.image, 0, 0);\n    Ctx2d.ctx.transform(1 / t.scaleX, 0, 0, 1 / t.scaleY, 0, 0);\n    Ctx2d.ctx.transform(c, -s, s, c, c * -t.x + s * -t.y, -s * -t.x + c * -t.y);\n  }\n}\nfunction handleCamera(world: World) {\n  for (const e of world.query({ and: [Transform, Camera2D] })) {\n    const t = world.getComponent(e, Transform);\n    const cam = world.getComponent(e, Camera2D);\n    const c = Math.cos(t.rad) * cam.zoom;\n    const s = Math.sin(t.rad) * cam.zoom;\n    Ctx2d.ctx.setTransform(c, s, -s, c, t.x, t.y);\n  }\n}\nfunction handlePickCard(world: World) {\n  const deck = world.query({ and: [Card], not: [InHand] });\n  const graphics = world.query({ and: [Graphic], not: [Card] });\n  const faceDownIndex = graphics.findIndex(\n    (e) => (world.getComponent(e, Graphic).image = Deck[\"back\"]),\n  );\n  if (deck.length > 0) {\n    if (faceDownIndex == -1) {\n      const facedDown = world.addEntity();\n      world.addComponent(facedDown, Transform, {\n        x: Game.deckX,\n        y: Game.deckY,\n      });\n      world.addComponent(facedDown, Graphic, { image: Deck[\"back\"] });\n      return;\n    }\n    if (Game.status == GAME_STATUSES.PLAY) return;\n    const t = world.getComponent(graphics[faceDownIndex], Transform);\n    const g = world.getComponent(graphics[faceDownIndex], Graphic);\n    let clicked = false;\n    for (let i = 0, l = Pointers.x.length; i < l; i++) {\n      const worldPos = screen2World(Pointers.x[i], Pointers.y[i]);\n      if (\n        !isPointInRect(\n          worldPos.x,\n          worldPos.y,\n          t.x,\n          t.y,\n          g.image.width * t.scaleX,\n          g.image.height * t.scaleY,\n        )\n      )\n        continue;\n      clicked = Pointers.justPressed[i];\n      if (!clicked) continue;\n      break;\n    }\n    if (!clicked) return;\n    pickCard(world);\n  } else {\n    world.deleteEntity(graphics[faceDownIndex]);\n  }\n}\nfunction handleCardVisibility(world: World) {\n  for (const e of world.query({\n    and: [Card, Transform, Graphic],\n    not: [InHand, MovementTarget],\n  })) {\n    world.removeComponent(e, Transform);\n    world.removeComponent(e, Graphic);\n  }\n}\nfunction handleButtons(world: World) {\n  for (const e of world.query({ and: [Button, Transform, Rect] })) {\n    const b = world.getComponent(e, Button);\n    const t = world.getComponent(e, Transform);\n    const r = world.getComponent(e, Rect);\n    b.hovered = b.justPressed = b.justReleased = false;\n    if (!b.enabled) continue;\n    for (let i = 0, l = Pointers.x.length; i < l; i++) {\n      const worldPos = screen2World(Pointers.x[i], Pointers.y[i]);\n      b.hovered ||= isPointInRect(\n        worldPos.x,\n        worldPos.y,\n        t.x,\n        t.y,\n        r.w * t.scaleX,\n        r.h * t.scaleY,\n      );\n      b.justPressed ||= b.hovered && Pointers.justPressed[i];\n      b.justReleased ||= b.hovered && Pointers.justReleased[i];\n    }\n  }\n}\nfunction handleCallbacks(world: World) {\n  for (const e of world.query({ and: [Callback] })) {\n    world.getComponent(e, Callback).callback(e);\n  }\n}\nfunction handleDrawRects(world: World) {\n  for (const e of world.query({ and: [Transform, Rect, Colour] })) {\n    const t = world.getComponent(e, Transform);\n    const r = world.getComponent(e, Rect);\n    const c = world.getComponent(e, Colour);\n    Ctx2d.ctx.fillStyle = c.fill;\n    Ctx2d.ctx.strokeStyle = c.stroke;\n    Ctx2d.ctx.fillRect(t.x, t.y, r.w * t.scaleX, r.h * t.scaleY);\n    Ctx2d.ctx.strokeRect(t.x, t.y, r.w * t.scaleX, r.h * t.scaleY);\n  }\n}\nfunction handleMoveTargets(world: World) {\n  for (const e of world.query({ and: [Transform, MovementTarget] })) {\n    const t = world.getComponent(e, Transform);\n    const mt = world.getComponent(e, MovementTarget);\n    const v = world.addComponent(e, Velocity);\n    const dx = mt.x - t.x;\n    const dy = mt.y - t.y;\n    const distance = (dx * dx + dy * dy) ** 0.5;\n    v.x = (dx / distance) * Game.cardSpeed;\n    v.y = (dy / distance) * Game.cardSpeed;\n    if (distance > Game.cardSpeed * Time.dtSeconds) continue;\n    v.x = v.y = 0;\n    t.x = mt.x;\n    t.y = mt.y;\n    world.removeComponent(e, MovementTarget);\n    world.removeComponent(e, Velocity);\n  }\n}\nfunction handleMovement(world: World) {\n  for (const e of world.query({ and: [Transform, Velocity] })) {\n    const t = world.getComponent(e, Transform);\n    const v = world.getComponent(e, Velocity);\n    t.x += v.x * Time.dtSeconds;\n    t.y += v.y * Time.dtSeconds;\n  }\n}\nfunction handleDrawText(world: World) {\n  for (const e of world.query({ and: [Text, Transform] })) {\n    const text = world.getComponent(e, Text);\n    const t = world.getComponent(e, Transform);\n    const split = text.content.split(\"\\n\");\n    Ctx2d.ctx.fillStyle = \"white\";\n    Ctx2d.ctx.font = text.font;\n    const textMetrics = Ctx2d.ctx.measureText(text.content);\n    for (let i = 0, l = split.length; i < l; i++) {\n      Ctx2d.ctx.fillText(\n        split[i],\n        t.x,\n        t.y + textMetrics.emHeightAscent * (i + 1),\n      );\n    }\n  }\n}\nfunction handleContainers(world: World) {\n  for (const e of world.query({\n    and: [Transform, HorizontalContainer, EntityContainer],\n  })) {\n    const t = world.getComponent(e, Transform);\n    const hC = world.getComponent(e, HorizontalContainer);\n    const eC = world.getComponent(e, EntityContainer);\n    // Ctx2d.ctx.fillRect(t.x, t.y, hC.width * t.scaleX, 1);\n    const padX = hC.padding * t.scaleX;\n    const padY = hC.padding * t.scaleY;\n    const width = (hC.width - padX * 2) * t.scaleX;\n    let childrenTotalWidth = padX * t.scaleX * (eC.entities.length - 1);\n    let lastWidth = 0;\n    for (const child of eC.entities) {\n      const childTransform = world.getComponent(child, Transform);\n      let childWidth = 0;\n      if (world.hasComponent(child, Graphic)) {\n        childWidth = world.getComponent(child, Graphic).image.width;\n      }\n      if (world.hasComponent(child, Rect)) {\n        childWidth = world.getComponent(child, Rect).w;\n      }\n      childWidth *= childTransform.scaleX;\n      childrenTotalWidth += childWidth;\n      lastWidth = childWidth;\n    }\n    const needToStack = childrenTotalWidth > width;\n    let startX = needToStack\n      ? t.x + padX * t.scaleX\n      : t.x + hC.width / 2 - childrenTotalWidth / 2;\n    for (let i = 0, children = eC.entities, l = children.length; i < l; i++) {\n      const childTransform = world.getComponent(children[i], Transform);\n      let childWidth = 0;\n      if (world.hasComponent(children[i], Graphic)) {\n        childWidth = world.getComponent(children[i], Graphic).image.width;\n      }\n      if (world.hasComponent(children[i], Rect)) {\n        childWidth = world.getComponent(children[i], Rect).w;\n      }\n      childWidth *= childTransform.scaleX;\n      world.addComponent(children[i], MovementTarget, {\n        x: startX + (needToStack ? ((width - lastWidth) / (l - 1)) * i : 0),\n        y: t.y + padY,\n      });\n      startX += needToStack ? 0 : childWidth + padX;\n    }\n  }\n}\n\n// components\nconst Text = { content: \"placeholder\", font: \"\" };\nconst Transform = { x: 0, y: 0, rad: 0, scaleX: 1, scaleY: 1 };\nconst Graphic = { image: new Image() };\nconst Camera2D = { zoom: 1 };\nconst Card: { value: keyof typeof Deck } = { value: \"back\" };\nconst InHand = { isPlayer: true, isRevealed: true };\nconst Button = {\n  hovered: false,\n  justPressed: false,\n  justReleased: false,\n  enabled: true,\n};\nconst Colour = { fill: \"\", stroke: \"\" };\nconst Rect = { w: 10, h: 10 };\nconst Callback = { callback: (_: entityT) => {} };\nconst MovementTarget = { x: 0, y: 0 };\nconst Velocity = { x: 0, y: 0 };\nconst HorizontalContainer = { width: 100, padding: 0 };\nconst EntityContainer: { entities: entityT[] } = { entities: [] };\n\n// entities\nfunction setUpCardContainers(world: World) {\n  const playerContainer = world.addEntity();\n  world.addComponent(playerContainer, Transform, {\n    x: Ctx2d.canvas.width * 0.3,\n    y: Ctx2d.canvas.height - CardSpec.height,\n  });\n  world.addComponent(playerContainer, HorizontalContainer, {\n    width: Ctx2d.canvas.width * 0.65,\n  });\n  world.addComponent(playerContainer, EntityContainer, { entities: [] });\n  const dealerContainer = world.addEntity();\n  world.addComponent(dealerContainer, Transform, {\n    x: Ctx2d.canvas.width * 0.3,\n    y: 0,\n  });\n  world.addComponent(dealerContainer, HorizontalContainer, {\n    width: Ctx2d.canvas.width * 0.65,\n  });\n  world.addComponent(dealerContainer, EntityContainer, { entities: [] });\n}\nfunction setUpButtons(world: World) {\n  function buttonStyle(b: typeof Button, c: typeof Colour) {\n    c.fill = b.enabled ? \"#00000069\" : \"#00000020\";\n    c.stroke = b.hovered ? \"white\" : \"transparent\";\n  }\n  const buttons: { [name: string]: (_: entityT) => void } = {\n    \"bet /2\": (e) => {\n      const b = world.getComponent(e, Button);\n      b.enabled =\n        Game.status != GAME_STATUSES.PLAY &&\n        Game.status != GAME_STATUSES.GAME_OVER;\n      buttonStyle(b, world.getComponent(e, Colour));\n      if (b.justReleased) {\n        Game.bet /= 2;\n        Game.bet = Math.round(Game.bet);\n        Game.bet = Math.max(Game.minBet, Game.bet);\n      }\n    },\n    \"bet *2\": (e) => {\n      const b = world.getComponent(e, Button);\n      b.enabled =\n        Game.status != GAME_STATUSES.PLAY &&\n        Game.status != GAME_STATUSES.GAME_OVER;\n      buttonStyle(b, world.getComponent(e, Colour));\n      if (b.justReleased) {\n        Game.bet *= 2;\n        Game.bet = Math.max(Math.min(Game.bet, Game.credits), Game.minBet);\n      }\n    },\n    hit: (e) => {\n      const b = world.getComponent(e, Button);\n      buttonStyle(b, world.getComponent(e, Colour));\n      if (b.justReleased) {\n        if (Game.status == GAME_STATUSES.GAME_OVER) {\n          onGameOver();\n          resetGame(world);\n        }\n        if (Game.status != GAME_STATUSES.PLAY) {\n          resumeGame(world);\n        }\n        pickCard(world);\n        if (checkWin(world) == GAME_STATUSES.BUST) {\n          Game.status = GAME_STATUSES.BUST;\n          calculateCredits();\n        }\n        if (Game.credits <= 0) {\n          Game.status = GAME_STATUSES.GAME_OVER;\n        }\n      }\n    },\n    stand: (e) => {\n      const b = world.getComponent(e, Button);\n      b.enabled &&= Game.status == GAME_STATUSES.PLAY;\n      buttonStyle(b, world.getComponent(e, Colour));\n      if (b.justReleased) {\n        const split = splitHand(world);\n        const playersHand = 0;\n        if (split[playersHand].length == 0) return;\n        handleDealer(world);\n      }\n    },\n  };\n  const w = 100;\n  const h = 100;\n  const leftpadPercent = 0.2;\n  const x = Ctx2d.canvas.width * leftpadPercent;\n  const y = Ctx2d.canvas.height / 2 - h / 2;\n  const padding = 5;\n  const buttonContainer = world.addEntity();\n  world.addComponent(buttonContainer, Transform, { x, y });\n  world.addComponent(buttonContainer, HorizontalContainer, {\n    width: Ctx2d.canvas.width * (1 - leftpadPercent),\n    padding,\n  });\n  const eC = world.addComponent(buttonContainer, EntityContainer, {\n    entities: [],\n  });\n  for (const name in buttons) {\n    eC.entities.push(addButton(world, name, 0, 0, w, h, buttons[name]));\n  }\n}\nfunction addButton(\n  world: World,\n  labal: string,\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n  callback = (_: entityT) => {},\n) {\n  const button = world.addEntity();\n  world.addComponent(button, Transform, { x, y });\n  world.addComponent(button, Callback, { callback });\n  world.addComponent(button, Rect, { w, h });\n  world.addComponent(button, Button);\n  world.addComponent(button, Text, { content: labal, font: \"35px sans-serif\" });\n  world.addComponent(button, Colour, {\n    fill: \"#00000069\",\n    stroke: \"transparent\",\n  });\n  return button;\n}\nfunction addCard(world: World, value: keyof typeof Deck) {\n  const card = world.addEntity();\n  world.addComponent(card, Card, { value });\n  return card;\n}\n\n// singletons\nconst Pointers = setUpPointers();\nconst Ctx2d = setUpCanvas();\nconst Time = setUpTime();\nconst CardSpec = {\n  width: 1 * 200,\n  height: 1.43 * 200,\n  round: 0.05 * 200,\n};\nconst Deck = generateDeck(CardSpec.width, CardSpec.height, CardSpec.round);\nconst CardValues: Record<keyof typeof Deck, number[]> = {\n  \"hearts-A\": [1, 11],\n  \"hearts-2\": [2],\n  \"hearts-3\": [3],\n  \"hearts-4\": [4],\n  \"hearts-5\": [5],\n  \"hearts-6\": [6],\n  \"hearts-7\": [7],\n  \"hearts-8\": [8],\n  \"hearts-9\": [9],\n  \"hearts-10\": [10],\n  \"hearts-J\": [10],\n  \"hearts-Q\": [10],\n  \"hearts-K\": [10],\n  \"spades-A\": [1, 11],\n  \"spades-2\": [2],\n  \"spades-3\": [3],\n  \"spades-4\": [4],\n  \"spades-5\": [5],\n  \"spades-6\": [6],\n  \"spades-7\": [7],\n  \"spades-8\": [8],\n  \"spades-9\": [9],\n  \"spades-10\": [10],\n  \"spades-J\": [10],\n  \"spades-Q\": [10],\n  \"spades-K\": [10],\n  \"clubs-A\": [1, 11],\n  \"clubs-2\": [2],\n  \"clubs-3\": [3],\n  \"clubs-4\": [4],\n  \"clubs-5\": [5],\n  \"clubs-6\": [6],\n  \"clubs-7\": [7],\n  \"clubs-8\": [8],\n  \"clubs-9\": [9],\n  \"clubs-10\": [10],\n  \"clubs-J\": [10],\n  \"clubs-Q\": [10],\n  \"clubs-K\": [10],\n  \"diamonds-A\": [1, 11],\n  \"diamonds-2\": [2],\n  \"diamonds-3\": [3],\n  \"diamonds-4\": [4],\n  \"diamonds-5\": [5],\n  \"diamonds-6\": [6],\n  \"diamonds-7\": [7],\n  \"diamonds-8\": [8],\n  \"diamonds-9\": [9],\n  \"diamonds-10\": [10],\n  \"diamonds-J\": [10],\n  \"diamonds-Q\": [10],\n  \"diamonds-K\": [10],\n  back: [0],\n};\nconst enum GAME_STATUSES {\n  PLAY,\n  BLACKJACK,\n  BUST,\n  DRAW,\n  LOSE,\n  WIN,\n  GAME_OVER,\n}\nconst Game = {\n  width: 900,\n  height: 600,\n  deckX: 20,\n  deckY: 600 / 2 - 150,\n  cardSpeed: 3000,\n  credits: 100,\n  bet: 0,\n  minBet: 10,\n  best: 0,\n  rounds: 0,\n  roundsTilBetIncrease: 5,\n  betIncreaseExponent: 1.1,\n  targetVal: 21,\n  dealerHitThreashold: 16,\n  status: GAME_STATUSES.PLAY,\n};\nconst StatusStrings: Record<GAME_STATUSES, string> = {\n  [GAME_STATUSES.PLAY]: \"\",\n  [GAME_STATUSES.BLACKJACK]: \"Blackjack\",\n  [GAME_STATUSES.BUST]: \"Bust\",\n  [GAME_STATUSES.DRAW]: \"Draw\",\n  [GAME_STATUSES.LOSE]: \"Lose\",\n  [GAME_STATUSES.WIN]: \"Win\",\n  [GAME_STATUSES.GAME_OVER]: \"Game Over\",\n};\n\nCtx2d.canvas.width = Game.width;\nCtx2d.canvas.height = Game.height;\n\nconst game = new World();\n\nfor (const card in Deck) {\n  if ((card as keyof typeof Deck) == \"back\") continue;\n  addCard(game, card as keyof typeof Deck);\n}\n\nconst cam = game.addEntity();\ngame.addComponent(cam, Transform);\ngame.addComponent(cam, Camera2D, { zoom: 1 });\n\nconst gameText = game.addEntity();\ngame.addComponent(gameText, Transform);\nconst gameTextComp = game.addComponent(gameText, Text, {\n  font: \"40px sans-serif\",\n});\n\nsetUpButtons(game);\nsetUpCardContainers(game);\nresetGame(game);\n\n{\n  (function loop() {\n    Ctx2d.ctx.resetTransform();\n    Ctx2d.ctx.fillStyle = \"#424242\";\n    Ctx2d.ctx.fillRect(0, 0, Ctx2d.canvas.width, Ctx2d.canvas.height);\n\n    gameTextComp.content = `Credits: ${Game.credits}\\nBet: ${Game.bet}\\nRound ${Game.rounds + 1}, Best: ${Game.best + 1}\\n${StatusStrings[Game.status]}\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nNext min bet: ${Math.ceil(Game.minBet ** Game.betIncreaseExponent)}\\nRounds until min bet increases: ${\n      Game.roundsTilBetIncrease - (Game.rounds % Game.roundsTilBetIncrease) - 1\n    }`;\n\n    // drawing\n    game.update(\n      handleCamera,\n      handleDrawImages,\n      handleDrawRects,\n      handleDrawText,\n    );\n\n    // process\n    game.update(\n      handleContainers,\n      handleCardVisibility,\n      handlePickCard,\n      handleCard2Img,\n      handleButtons,\n      handleMoveTargets,\n      handleCallbacks,\n      handleMovement,\n    );\n\n    updateTime(Time);\n    updatePointers(Pointers);\n    requestAnimationFrame(loop);\n  })();\n}\n"],
  "mappings": "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",
  "names": ["ObjectPoolMap", "objectFactory", "key", "index", "backKey", "temp", "ComponentManager", "component", "ObjectPoolMap", "mask", "entity", "entry", "src", "dest", "newEntity", "World", "ComponentManager", "entity", "newEntity", "src", "dest", "entry", "compId", "a", "component", "values", "cem", "fns", "i", "l", "query", "res", "comp", "roundRectQuarter", "x", "y", "w", "h", "radius", "path", "drawCardSuits", "paths", "symbolMargin", "c", "s", "r", "inradius", "drawCard", "cardWidth", "cardHeight", "cardRound", "symbol", "text", "ctx", "isBack", "cardPadding", "i", "textMetrics", "generateDeck", "suits", "ranks", "canvas", "suitNames", "deck", "cardBack", "suitIndex", "rankIndex", "img", "setUpTime", "updateTime", "time", "now", "setUpPointers", "pointers", "id", "updatePointers", "i", "l", "setUpCanvas", "canvas", "ctx", "screen2World", "x", "y", "clientRect", "Ctx2d", "ratio", "isPointInRect", "px", "py", "rx", "ry", "rw", "rh", "sleep", "seconds", "res", "calcHandValue", "world", "hand", "target", "value", "vals", "indices", "e", "c", "Card", "values", "CardValues", "exhausted", "indexSum", "pickACard", "forPlayer", "revealed", "playersHand", "dealersHand", "Transform", "EntityContainer", "t", "eC", "CardSpec", "deck", "InHand", "picked", "Game", "Graphic", "splitHand", "inHandCards", "split", "setButtonsActivation", "enabled", "Button", "pickCard", "resetGame", "resetCards", "calculateCredits", "resumeGame", "MovementTarget", "handleDealer", "checkWin", "playersVal", "dealersVal", "onGameOver", "handleCard2Img", "world", "Card", "Graphic", "c", "g", "Deck", "InHand", "handleDrawImages", "Transform", "t", "s", "Ctx2d", "handleCamera", "Camera2D", "cam", "handlePickCard", "deck", "graphics", "faceDownIndex", "e", "facedDown", "Game", "clicked", "i", "l", "Pointers", "worldPos", "screen2World", "isPointInRect", "pickCard", "handleCardVisibility", "MovementTarget", "handleButtons", "Button", "Rect", "b", "r", "handleCallbacks", "Callback", "handleDrawRects", "Colour", "handleMoveTargets", "mt", "v", "Velocity", "dx", "dy", "distance", "Time", "handleMovement", "handleDrawText", "Text", "text", "split", "textMetrics", "handleContainers", "HorizontalContainer", "EntityContainer", "hC", "eC", "padX", "padY", "width", "childrenTotalWidth", "lastWidth", "child", "childTransform", "childWidth", "needToStack", "startX", "children", "_", "setUpCardContainers", "playerContainer", "CardSpec", "dealerContainer", "setUpButtons", "buttonStyle", "buttons", "onGameOver", "resetGame", "resumeGame", "checkWin", "calculateCredits", "splitHand", "handleDealer", "w", "h", "leftpadPercent", "x", "y", "padding", "buttonContainer", "name", "addButton", "labal", "callback", "button", "addCard", "value", "card", "setUpPointers", "setUpCanvas", "setUpTime", "generateDeck", "CardValues", "StatusStrings", "game", "World", "gameText", "gameTextComp", "loop", "updateTime", "updatePointers"]
}
