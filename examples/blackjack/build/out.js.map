{
  "version": 3,
  "sources": ["../../../src/pool.ts", "../../../src/component.ts", "../../../src/entity.ts", "../../../src/world.ts", "../src/cards.ts", "../src/main.ts"],
  "sourcesContent": ["export class ObjectPoolMap<K, V> {\n  private storage: V[] = [];\n  private keyToIndex: Map<K, number> = new Map();\n  private indexToKey: K[] = [];\n  private objectFactory: () => V;\n\n  constructor(objectFactory: () => V) {\n    this.objectFactory = objectFactory;\n  }\n\n  size() {\n    return this.keyToIndex.size;\n  }\n\n  add(key: K): V {\n    if (this.keyToIndex.has(key))\n      return this.storage[this.keyToIndex.get(key) as number];\n    if (this.storage.length <= this.keyToIndex.size)\n      this.storage.push(this.objectFactory());\n    this.keyToIndex.set(key, this.keyToIndex.size);\n    this.indexToKey[this.keyToIndex.size - 1] = key;\n    return this.storage[this.keyToIndex.get(key) as number];\n  }\n\n  remove(key: K): void {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) return;\n    const backKey = this.indexToKey[this.keyToIndex.size - 1];\n    const temp = this.storage[index];\n    this.storage[index] = this.storage[this.keyToIndex.size - 1];\n    this.storage[this.keyToIndex.size - 1] = temp;\n    this.indexToKey[index] = backKey;\n    this.indexToKey.pop();\n    this.keyToIndex.set(backKey, index);\n    this.keyToIndex.delete(key);\n  }\n\n  get(key: K): V {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) throw new Error(\"Key not found.\");\n    return this.storage[index];\n  }\n\n  has(key: K): boolean {\n    return this.keyToIndex.has(key);\n  }\n\n  clean(): void {\n    this.storage.splice(this.keyToIndex.size);\n  }\n}\n", "import { ObjectPoolMap } from \"./pool.ts\";\nimport { entityT } from \"./entity.ts\";\n\nexport class ComponentManager {\n  private poolMap: Map<object, ObjectPoolMap<entityT, object>> = new Map();\n  private maskMap: Map<object, number> = new Map();\n\n  register<T extends object>(component: T): void {\n    if (this.poolMap.has(component)) return;\n    this.maskMap.set(component, 1 << this.maskMap.size);\n    this.poolMap.set(\n      component,\n      new ObjectPoolMap<entityT, T>(() => ({ ...component })),\n    );\n  }\n\n  getMask<T extends object>(component: T): number {\n    const mask = this.maskMap.get(component);\n    if (mask != undefined) return mask;\n    this.register(component);\n    return this.maskMap.get(component) as number;\n  }\n\n  add<T extends object>(entity: entityT, component: T): T {\n    return Object.assign(\n      (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).add(entity),\n      component,\n    );\n  }\n\n  remove<T extends object>(entity: entityT, component: T): void {\n    (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).remove(entity);\n  }\n\n  has<T extends object>(entity: entityT, component: T): boolean {\n    return (\n      this.poolMap.has(component) &&\n      (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).has(entity)\n    );\n  }\n\n  get<T extends object>(entity: entityT, component: T): T {\n    return (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).get(\n      entity,\n    );\n  }\n\n  size<T extends object>(component: T): number {\n    return (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).size();\n  }\n\n  delete(entity: entityT): void {\n    for (const entry of this.poolMap.entries()) entry[1].remove(entity);\n  }\n\n  copy(src: entityT, dest: entityT): void {\n    for (const entry of this.poolMap.entries())\n      entry[1].has(src) && Object.assign(entry[1].add(dest), entry[1].get(src));\n  }\n\n  clean(): void {\n    for (const entry of this.poolMap.entries()) entry[1].clean();\n  }\n}\n", "export type entityT = number;\nexport function newEntity(): entityT {\n  return Math.random();\n}\n", "import { ComponentManager } from \"./component.ts\";\nimport { newEntity, type entityT } from \"./entity.ts\";\n\nexport type queryT = Partial<Record<\"and\" | \"not\", object[]>>;\n\nexport type systemT = (world: World) => void;\n\nexport class World {\n  private maskMap: Map<entityT, number> = new Map();\n  private archetypeMap: Map<number, Set<entityT>> = new Map();\n  private compManager = new ComponentManager();\n\n  addEntity(entity: entityT = newEntity()): entityT {\n    if (this.maskMap.has(entity)) return entity;\n    this.maskMap.set(entity, 0);\n    return entity;\n  }\n\n  copyEntity(src: entityT, dest: entityT = newEntity()): entityT {\n    this.compManager.copy(src, dest);\n    const mask = this.maskMap.get(src) ?? 0;\n    this.maskMap.set(dest, mask);\n    this.getArchetype(mask).add(dest);\n    return dest;\n  }\n\n  private getArchetype(mask: number): Set<entityT> {\n    const a = this.archetypeMap.get(mask) ?? new Set();\n    this.archetypeMap.set(mask, a);\n    return a;\n  }\n\n  deleteEntity(entity: entityT) {\n    this.compManager.delete(entity);\n    this.getArchetype(this.maskMap.get(entity) ?? 0).delete(entity);\n    this.maskMap.delete(entity);\n  }\n\n  registerComponent<T extends object>(component: T): World {\n    this.compManager.register(component);\n    return this;\n  }\n\n  hasComponent<T extends object>(entity: entityT, component: T): boolean {\n    return this.compManager.has(entity, component);\n  }\n\n  addComponent<T extends object>(\n    entity: entityT,\n    component: T,\n    values: Partial<T> = component,\n  ): T {\n    this.compManager.register(component);\n    let mask = this.maskMap.get(entity) ?? 0;\n    const compMask = this.compManager.getMask(component);\n    if (mask & compMask)\n      return Object.assign(this.compManager.get(entity, component), values);\n    this.getArchetype(mask).delete(entity);\n    mask ^= compMask;\n    this.maskMap.set(entity, mask);\n    this.getArchetype(mask).add(entity);\n    return Object.assign(this.compManager.add(entity, component), values);\n  }\n\n  removeComponent<T extends object>(entity: entityT, component: T): void {\n    this.compManager.register(component);\n    let mask = this.maskMap.get(entity) ?? 0;\n    const compMask = this.compManager.getMask(component);\n    if ((mask & compMask) ^ compMask) return;\n    this.compManager.remove(entity, component);\n    this.getArchetype(mask).delete(entity);\n    mask ^= compMask;\n    this.maskMap.set(entity, mask);\n    this.getArchetype(mask).add(entity);\n  }\n\n  getComponent<T extends object>(entity: entityT, component: T): T {\n    return this.compManager.get(entity, component);\n  }\n\n  update(...fns: systemT[]) {\n    for (let i = 0, l = fns.length; i < l; i++) fns[i](this);\n  }\n\n  cleanObjectPools(): void {\n    this.compManager.clean();\n  }\n\n  query(query: queryT): entityT[] {\n    let andMask = 0,\n      notMask = 0;\n    if (query.and) {\n      for (let i = 0, l = query.and.length; i < l; i++)\n        andMask |= this.compManager.getMask(query.and[i]);\n    }\n    if (query.not) {\n      for (let i = 0, l = query.not.length; i < l; i++)\n        notMask |= this.compManager.getMask(query.not[i]);\n    }\n    const res: entityT[] = [];\n    for (const entry of this.archetypeMap.entries()) {\n      entry[1].size > 0 &&\n        (entry[0] & andMask) == andMask &&\n        (entry[0] & notMask) == 0 &&\n        res.push(...entry[1]);\n    }\n    return res;\n  }\n\n  entityCount(): number {\n    return this.maskMap.size;\n  }\n}\n", "function roundRectQuarter(\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n  radius: number,\n) {\n  const path = new Path2D();\n  path.moveTo(x + w / 2, y);\n  path.arcTo(x + w, y, x + w, y + h / 2, radius);\n  path.lineTo(x + w, y + h / 2);\n  return path;\n}\nfunction drawCardSuits(): {\n  hearts: Path2D;\n  spades: Path2D;\n  clubs: Path2D;\n  diamonds: Path2D;\n} {\n  const paths: {\n    hearts: Path2D;\n    spades: Path2D;\n    clubs: Path2D;\n    diamonds: Path2D;\n  } = {\n    hearts: new Path2D(),\n    spades: new Path2D(),\n    clubs: new Path2D(),\n    diamonds: new Path2D(),\n  };\n  const symbolMargin = 1;\n  {\n    const path = paths[\"hearts\"];\n    const c = Math.cos(Math.PI / 4);\n    const s = Math.sin(Math.PI / 4);\n    let x = symbolMargin / 4;\n    const y = symbolMargin / 4;\n    const r = symbolMargin / 4;\n    path.arc(x, y, r, 0, Math.PI * 2);\n    path.arc(x + symbolMargin / 2, y, r, 0, Math.PI * 2);\n    path.moveTo(x + -s * r, y + c * r);\n    path.lineTo(symbolMargin / 2, symbolMargin);\n    x += symbolMargin / 2;\n    path.lineTo(x + c * r, y + s * r);\n  }\n  {\n    const path = paths[\"spades\"];\n    const x = symbolMargin / 4;\n    const y = symbolMargin / 2;\n    const r = symbolMargin / 4;\n    const c = Math.cos(Math.PI / 4);\n    const s = Math.sin(Math.PI / 4);\n    path.arc(x, y, r, 0, Math.PI * 2);\n    path.arc(x + symbolMargin / 2, y, r, 0, Math.PI * 2);\n    path.moveTo(x + c * -r, y + s * -r);\n    path.lineTo(symbolMargin / 2, 0);\n    path.lineTo(x + symbolMargin / 2 + -s * -r, y + c * -r);\n    path.moveTo(symbolMargin / 2, y);\n    path.lineTo(x + symbolMargin / 8, symbolMargin);\n    path.lineTo((symbolMargin / 8) * 5, symbolMargin);\n    path.closePath();\n  }\n  {\n    // credits: https://en.wikipedia.org/wiki/Rhombus#Inradius\n    const path = paths[\"diamonds\"];\n    const inradius =\n      (symbolMargin * (symbolMargin - symbolMargin / 4)) /\n      (2 * (symbolMargin ** 2 + (symbolMargin - symbolMargin / 4) ** 2) ** 0.5);\n    path.arc(symbolMargin / 2, symbolMargin / 2, inradius, 0, Math.PI * 2);\n    path.moveTo(symbolMargin / 2, 0);\n    path.lineTo(symbolMargin / 8, symbolMargin / 2);\n    path.lineTo(symbolMargin / 2, symbolMargin);\n    path.lineTo(symbolMargin - symbolMargin / 8, symbolMargin / 2);\n    path.closePath();\n  }\n  {\n    const path = paths[\"clubs\"];\n    const x = symbolMargin / 4;\n    const y = symbolMargin / 2;\n    const r = symbolMargin / 4;\n    path.arc(symbolMargin / 2, r, r, 0, Math.PI * 2);\n    path.arc(x, y, r, 0, Math.PI * 2);\n    path.arc(x + symbolMargin / 2, y, r, 0, Math.PI * 2);\n    path.moveTo(symbolMargin / 2, y);\n    path.lineTo(x + symbolMargin / 8, symbolMargin);\n    path.lineTo((symbolMargin / 8) * 5, symbolMargin);\n    path.closePath();\n  }\n  return paths;\n}\nfunction drawCard(\n  cardWidth = 1,\n  cardHeight = 1.43,\n  cardRound = 0.05,\n  symbol: \"hearts\" | \"spades\" | \"diamonds\" | \"clubs\",\n  text: string,\n  paths: Record<typeof symbol, Path2D>,\n  ctx: CanvasRenderingContext2D,\n  isBack = false,\n) {\n  const cardPadding = cardWidth * 0.03;\n  const symbolMargin = cardWidth / 2;\n\n  // rotation\n  const c = Math.cos(Math.PI);\n  const s = Math.sin(Math.PI);\n  const x = cardWidth;\n  const y = cardHeight;\n\n  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n\n  // card body\n  ctx.fillStyle = \"lightgrey\";\n  ctx.beginPath();\n  ctx.roundRect(0, 0, cardWidth, cardHeight, cardRound);\n  ctx.fill();\n  ctx.save();\n  ctx.clip();\n  if (isBack) {\n    ctx.fillStyle = \"darkgrey\";\n  } else {\n    ctx.fillStyle = \"silver\";\n  }\n  ctx.beginPath();\n  ctx.roundRect(\n    cardPadding,\n    cardPadding,\n    cardWidth - cardPadding * 2,\n    cardHeight - cardPadding * 2,\n    cardRound,\n  );\n  ctx.fill();\n  if (isBack) {\n    ctx.save();\n    ctx.clip();\n    ctx.strokeStyle = \"silver\";\n    ctx.lineWidth = cardWidth * 0.05;\n    const path = new Path2D();\n    for (let i = cardHeight / 2; i > 0; i -= ctx.lineWidth * 2) {\n      path.ellipse(cardWidth * 0.5, 0, cardWidth * 0.5, i, 0, 0, Math.PI);\n    }\n    ctx.setTransform(c, s, -s, c, x, y);\n    ctx.transform(1, 0, 0, 1, cardWidth / 2, 0);\n    ctx.stroke(path);\n    ctx.transform(c, s, -s, c, x, y);\n    ctx.stroke(path);\n    ctx.transform(1, 0, 0, 1, cardWidth, 0);\n    ctx.stroke(path);\n    ctx.transform(c, s, -s, c, x, y);\n    ctx.stroke(path);\n    ctx.resetTransform();\n    ctx.restore();\n  }\n\n  ctx.strokeStyle = \"gold\";\n  ctx.fillStyle = \"gold\";\n\n  // decorative lines\n  if (!isBack) {\n    {\n      ctx.lineWidth = cardWidth / 30;\n      const path = new Path2D();\n      path.moveTo(cardPadding, cardHeight * 0.7 + cardPadding);\n      path.arcTo(\n        cardPadding,\n        cardHeight - cardPadding,\n        cardWidth * 0.3 - cardPadding,\n        cardHeight - cardPadding,\n        ctx.lineWidth,\n      );\n      path.lineTo(cardWidth * 0.3 - cardPadding, cardHeight - cardPadding);\n      ctx.stroke(path);\n      ctx.transform(c, s, -s, c, x, y);\n      ctx.stroke(path);\n      ctx.resetTransform();\n    }\n    {\n      ctx.lineWidth = cardWidth / 100;\n      const path = new Path2D();\n      path.moveTo(cardPadding * 2, cardHeight * 0.7 + cardPadding * 2);\n      path.arcTo(\n        cardPadding * 2,\n        cardHeight - cardPadding * 2,\n        cardWidth * 0.3 - cardPadding * 2,\n        cardHeight - cardPadding * 2,\n        ctx.lineWidth,\n      );\n      path.lineTo(\n        cardWidth * 0.3 - cardPadding * 2,\n        cardHeight - cardPadding * 2,\n      );\n      ctx.stroke(path);\n      ctx.transform(c, s, -s, c, x, y);\n      ctx.stroke(path);\n      ctx.resetTransform();\n    }\n  } else {\n    ctx.lineWidth = cardWidth / 30;\n    const path = roundRectQuarter(\n      cardPadding,\n      cardPadding,\n      cardWidth - cardPadding * 2,\n      cardHeight - cardPadding * 2,\n      ctx.lineWidth,\n    );\n    ctx.stroke(path);\n    ctx.setTransform(c, s, -s, c, x, y);\n    ctx.stroke(path);\n    ctx.resetTransform();\n\n    ctx.lineWidth = cardWidth / 100;\n    ctx.roundRect(\n      cardPadding * 2,\n      cardPadding * 2,\n      cardWidth - cardPadding * 4,\n      cardHeight - cardPadding * 4,\n      ctx.lineWidth,\n    );\n    ctx.stroke();\n  }\n\n  // draw suits and ranks\n  ctx.lineWidth = cardWidth / 10000;\n  ctx.transform(symbolMargin, 0, 0, symbolMargin, cardPadding, cardPadding);\n  if (!isBack) ctx.stroke(paths[symbol]);\n  ctx.resetTransform();\n  ctx.font = `${cardWidth / 2.5}px sans-serif`;\n  const textMetrics = ctx.measureText(text);\n  ctx.fillText(\n    text,\n    (cardWidth - cardPadding * 2) / 4 - textMetrics.width / 2 + cardPadding,\n    cardHeight / 2 + textMetrics.emHeightAscent,\n  );\n  ctx.transform(c, s, -s, c, x, y);\n  ctx.fillText(\n    text,\n    (cardWidth - cardPadding * 2) / 4 - textMetrics.width / 2 + cardPadding,\n    cardHeight / 2 + textMetrics.emHeightAscent,\n  );\n  ctx.transform(symbolMargin, 0, 0, symbolMargin, cardPadding, cardPadding);\n  if (!isBack) ctx.stroke(paths[symbol]);\n  ctx.resetTransform();\n  ctx.restore();\n}\nexport function generateDeck(\n  cardWidth = 1,\n  cardHeight = 1.43,\n  cardRound = 0.05,\n) {\n  const suits = drawCardSuits();\n  const ranks = [\n    \"A\",\n    \"2\",\n    \"3\",\n    \"4\",\n    \"5\",\n    \"6\",\n    \"7\",\n    \"8\",\n    \"9\",\n    \"10\",\n    \"J\",\n    \"Q\",\n    \"K\",\n  ] as const;\n  const canvas = document.createElement(\"canvas\");\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) throw new Error(\"cannot initialize 2d context.\");\n  canvas.width = cardWidth;\n  canvas.height = cardHeight;\n  const suitNames = Object.keys(suits);\n  const deck: Record<string, HTMLImageElement> = {};\n  drawCard(cardWidth, cardHeight, cardRound, \"hearts\", \"\", suits, ctx, true);\n  const cardBack = new Image();\n  cardBack.src = canvas.toDataURL();\n  deck[\"back\"] = cardBack;\n  for (let i = 0, l = suitNames.length * ranks.length; i < l; i++) {\n    const suitIndex = Math.floor(i / ranks.length);\n    const rankIndex = i % ranks.length;\n    drawCard(\n      cardWidth,\n      cardHeight,\n      cardRound,\n      suitNames[suitIndex] as keyof typeof suits,\n      ranks[rankIndex],\n      suits,\n      ctx,\n    );\n    const img = new Image();\n    img.src = canvas.toDataURL();\n    deck[`${suitNames[suitIndex]}-${ranks[rankIndex]}`] = img;\n  }\n  return deck as Record<\n    `${keyof typeof suits}-${(typeof ranks)[number]}` | \"back\",\n    HTMLImageElement\n  >;\n}\n", "import { entityT, World } from \"bozoecs\";\nimport { generateDeck } from \"./cards.ts\";\n\n// credit: https://www.wikihow.com/Play-Blackjack\n\n// utils\nfunction setUpTime() {\n  const time = { dtMilli: 0, timeMilli: 0, dtSeconds: 0, timeSeconds: 0 };\n  return time;\n}\nfunction updateTime(time: {\n  dtMilli: number;\n  timeMilli: number;\n  dtSeconds: number;\n  timeSeconds: number;\n}) {\n  const now = performance.now();\n  time.dtMilli = now - time.timeMilli;\n  time.timeMilli += time.dtMilli;\n  time.dtSeconds = time.dtMilli / 1000;\n  time.timeSeconds = time.timeMilli / 1000;\n}\nfunction setUpPointers() {\n  const pointers: {\n    x: number[];\n    y: number[];\n    isDown: boolean[];\n    justPressed: boolean[];\n    justReleased: boolean[];\n  } = {\n    x: [],\n    y: [],\n    isDown: [],\n    justPressed: [],\n    justReleased: [],\n  };\n  globalThis.onpointerup = (e) => {\n    e.preventDefault();\n    const id = e.pointerId;\n    pointers.x[id] = e.x;\n    pointers.y[id] = e.y;\n    pointers.isDown[id] = false;\n    pointers.justReleased[id] = true;\n  };\n  globalThis.onpointerdown = (e) => {\n    e.preventDefault();\n    const id = e.pointerId;\n    pointers.x[id] = e.x;\n    pointers.y[id] = e.y;\n    pointers.isDown[id] = true;\n    pointers.justPressed[id] = true;\n  };\n  globalThis.onpointermove = (e) => {\n    e.preventDefault();\n    const id = e.pointerId;\n    pointers.x[id] = e.x;\n    pointers.y[id] = e.y;\n  };\n  return pointers;\n}\nfunction updatePointers(pointers: {\n  justPressed: boolean[];\n  justReleased: boolean[];\n}) {\n  for (let i = 0, l = pointers.justPressed.length; i < l; i++) {\n    pointers.justPressed[i] = false;\n  }\n  for (let i = 0, l = pointers.justReleased.length; i < l; i++) {\n    pointers.justReleased[i] = false;\n  }\n}\nfunction setUpCanvas() {\n  let canvas = document.querySelector(\"canvas\");\n  if (!canvas) {\n    canvas = document.createElement(\"canvas\");\n    document.appendChild(canvas);\n  }\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) throw new Error(\"cannot initialize 2d context.\");\n  return { canvas, ctx };\n}\nfunction screen2World(x: number, y: number) {\n  const clientRect = Ctx2d.canvas.getBoundingClientRect();\n  const ratio =\n    Ctx2d.canvas.width / Ctx2d.canvas.height > innerWidth / innerHeight\n      ? innerWidth / Ctx2d.canvas.width\n      : innerHeight / Ctx2d.canvas.height;\n  return {\n    x: (x - clientRect.left) / ratio,\n    y: (y - clientRect.top) / ratio,\n  };\n}\nfunction drawDownedPointers() {\n  Ctx2d.ctx.fillStyle = \"orange\";\n  Ctx2d.ctx.beginPath();\n  for (let i = 0, l = Pointers.x.length; i < l; i++) {\n    if (!Pointers.isDown[i]) continue;\n    const worldPos = screen2World(Pointers.x[i], Pointers.y[i]);\n    Ctx2d.ctx.rect(worldPos.x, worldPos.y, 10, 10);\n  }\n  Ctx2d.ctx.fill();\n}\nfunction isPointInRect(\n  px: number,\n  py: number,\n  rx: number,\n  ry: number,\n  rw: number,\n  rh: number,\n) {\n  return px > rx && px < rx + rw && py > ry && py < ry + rh;\n}\n// credit: https://stackoverflow.com/questions/951021/what-is-the-javascript-version-of-sleep\nfunction sleep(seconds: number) {\n  return new Promise((res) => setTimeout(res, seconds * 1000));\n}\n\n// systems\nfunction handleCard2Img(world: World) {\n  for (const e of world.query({ and: [Card, Graphic] })) {\n    const c = world.getComponent(e, Card);\n    const g = world.getComponent(e, Graphic);\n    g.image = Deck[c.value];\n    !world.hasComponent(e, InHand) && (g.image = Deck[\"back\"]);\n  }\n}\nfunction handleDrawImages(world: World) {\n  for (const e of world.query({ and: [Transform, Graphic] })) {\n    const t = world.getComponent(e, Transform);\n    const g = world.getComponent(e, Graphic);\n    const c = Math.cos(t.rad);\n    const s = Math.sin(t.rad);\n    Ctx2d.ctx.transform(c, s, -s, c, t.x, t.y);\n    Ctx2d.ctx.transform(t.scaleX, 0, 0, t.scaleY, 0, 0);\n    Ctx2d.ctx.drawImage(g.image, 0, 0);\n    Ctx2d.ctx.transform(1 / t.scaleX, 0, 0, 1 / t.scaleY, 0, 0);\n    Ctx2d.ctx.transform(c, -s, s, c, c * -t.x + s * -t.y, -s * -t.x + c * -t.y);\n  }\n}\nfunction handleCamera(world: World) {\n  for (const e of world.query({ and: [Transform, Camera2D] })) {\n    const t = world.getComponent(e, Transform);\n    const cam = world.getComponent(e, Camera2D);\n    const c = Math.cos(t.rad) * cam.zoom;\n    const s = Math.sin(t.rad) * cam.zoom;\n    Ctx2d.ctx.setTransform(c, s, -s, c, t.x, t.y);\n  }\n}\nfunction pickACard(world: World, forPlayer = true) {\n  let playersHand: entityT[] | undefined;\n  let dealersHand: entityT[] | undefined;\n  for (const e of world.query({ and: [Transform, EntityContainer] })) {\n    const t = world.getComponent(e, Transform);\n    const eC = world.getComponent(e, EntityContainer);\n    if (t.y == 0) dealersHand = eC.entities;\n    if (t.y == Ctx2d.canvas.height - CardSpec.height) playersHand = eC.entities;\n  }\n  if (!playersHand || !dealersHand) return;\n  const deck = world.query({ and: [Card], not: [InHand] });\n  const drew = deck[Math.round(Math.random() * (deck.length - 1))];\n  world.addComponent(drew, InHand, { isPlayer: forPlayer });\n  world.addComponent(drew, Transform, { x: Game.deckX, y: Game.deckY });\n  world.addComponent(drew, Graphic);\n  if (forPlayer) {\n    playersHand.push(drew);\n  } else {\n    dealersHand.push(drew);\n  }\n}\nfunction splitHand(world: World) {\n  const inHandCards = world.query({ and: [InHand] });\n  const split: entityT[][] = [[], []];\n  const playersHand = 0;\n  const dealersHand = 1;\n  for (const e of inHandCards) {\n    split[\n      world.getComponent(e, InHand).isPlayer ? playersHand : dealersHand\n    ].push(e);\n  }\n  return split;\n}\nfunction pickCard(world: World, forPlayer = true) {\n  const split = splitHand(world);\n  const playersHand = 0;\n  const dealersHand = 1;\n  const hand = forPlayer ? playersHand : dealersHand;\n  // picks 2 if hand is empty\n  if (split[hand].length == 0) {\n    pickACard(world, forPlayer);\n  }\n  pickACard(world, forPlayer);\n}\nfunction handlePickCard(world: World) {\n  const deck = world.query({ and: [Card], not: [InHand] });\n  const graphics = world.query({ and: [Graphic], not: [Card] });\n  const faceDownIndex = graphics.findIndex(\n    (e) => (world.getComponent(e, Graphic).image = Deck[\"back\"]),\n  );\n  if (deck.length > 0) {\n    if (faceDownIndex == -1) {\n      const facedDown = world.addEntity();\n      world.addComponent(facedDown, Transform, {\n        x: Game.deckX,\n        y: Game.deckY,\n      });\n      world.addComponent(facedDown, Graphic, { image: Deck[\"back\"] });\n      return;\n    }\n    if (Game.status == GAME_STATUSES.PLAY) return;\n    const t = world.getComponent(graphics[faceDownIndex], Transform);\n    const g = world.getComponent(graphics[faceDownIndex], Graphic);\n    let clicked = false;\n    for (let i = 0, l = Pointers.x.length; i < l; i++) {\n      const worldPos = screen2World(Pointers.x[i], Pointers.y[i]);\n      if (\n        !isPointInRect(\n          worldPos.x,\n          worldPos.y,\n          t.x,\n          t.y,\n          g.image.width * t.scaleX,\n          g.image.height * t.scaleY,\n        )\n      )\n        continue;\n      clicked = Pointers.justPressed[i];\n      if (!clicked) continue;\n      break;\n    }\n    if (!clicked) return;\n    pickCard(world);\n  } else {\n    world.deleteEntity(graphics[faceDownIndex]);\n  }\n}\nfunction handleCardVisibility(world: World) {\n  for (const e of world.query({\n    and: [Card, Transform, Graphic],\n    not: [InHand, MovementTarget],\n  })) {\n    world.removeComponent(e, Transform);\n    world.removeComponent(e, Graphic);\n  }\n}\nfunction resetCards(world: World) {\n  for (const e of world.query({ and: [InHand] })) {\n    world.removeComponent(e, InHand);\n    world.addComponent(e, MovementTarget, { x: Game.deckX, y: Game.deckY });\n  }\n  for (const e of world.query({ and: [Transform, EntityContainer] })) {\n    const t = world.getComponent(e, Transform);\n    const eC = world.getComponent(e, EntityContainer);\n    if (t.y == 0 || t.y == Ctx2d.canvas.height - CardSpec.height) {\n      eC.entities.length = 0;\n    }\n  }\n}\nfunction resetGame(world: World) {\n  resetCards(world);\n  Game.credits = 100;\n  Game.bet = Game.minBet;\n  Game.status = GAME_STATUSES.PLAY;\n}\nfunction calculateCredits() {\n  switch (Game.status) {\n    case GAME_STATUSES.BLACKJACK:\n      // 3:2 ratio\n      Game.credits += Math.floor((Game.bet / 2) * 3);\n      break;\n    case GAME_STATUSES.LOSE:\n    case GAME_STATUSES.BUSTED:\n      Game.credits -= Game.bet;\n      break;\n    case GAME_STATUSES.WIN:\n      Game.credits += Game.bet;\n      break;\n    case GAME_STATUSES.PLAY:\n    case GAME_STATUSES.DRAW:\n  }\n  Game.bet = Math.min(Game.bet, Game.credits);\n}\nfunction resumeGame(world: World) {\n  resetCards(world);\n  Game.status = GAME_STATUSES.PLAY;\n}\nfunction calcHandValue(\n  world: World,\n  hand: entityT[] = [],\n  target: number = 21,\n) {\n  let value = 0;\n  const vals: number[][] = [];\n  const indices: number[] = [];\n  for (const e of hand) {\n    const c = world.getComponent(e, Card);\n    const values = CardValues[c.value].sort();\n    vals.push(values);\n    indices.push(values.length - 1);\n    value += values[values.length - 1];\n  }\n  let exhausted = false;\n  while (value > target && !exhausted) {\n    let indexSum = 0;\n    for (let i = 0, l = indices.length; i < l; i++) {\n      if (indices[i] == 0) continue;\n      indexSum += indices[i];\n      value -= vals[i][indices[i]];\n      indices[i]--;\n      value += vals[i][indices[i]];\n      if (value <= target) break;\n    }\n    exhausted = indexSum == 0;\n  }\n  return value;\n}\nfunction handleButtons(world: World) {\n  for (const e of world.query({ and: [Button, Transform, Rect] })) {\n    const b = world.getComponent(e, Button);\n    const t = world.getComponent(e, Transform);\n    const r = world.getComponent(e, Rect);\n    for (let i = 0, l = Pointers.x.length; i < l; i++) {\n      const worldPos = screen2World(Pointers.x[i], Pointers.y[i]);\n      b.hovered = isPointInRect(\n        worldPos.x,\n        worldPos.y,\n        t.x,\n        t.y,\n        r.w * t.scaleX,\n        r.h * t.scaleY,\n      );\n      b.justPressed = b.hovered && Pointers.justPressed[i];\n      b.justReleased = b.hovered && Pointers.justReleased[i];\n    }\n  }\n}\nfunction handleCallbacks(world: World) {\n  for (const e of world.query({ and: [Callback] })) {\n    world.getComponent(e, Callback).callback(e);\n  }\n}\nfunction handleDrawRects(world: World) {\n  Ctx2d.ctx.strokeStyle = \"red\";\n  Ctx2d.ctx.fillStyle = \"#00000050\";\n  Ctx2d.ctx.beginPath();\n  for (const e of world.query({ and: [Transform, Rect] })) {\n    const t = world.getComponent(e, Transform);\n    const r = world.getComponent(e, Rect);\n    Ctx2d.ctx.rect(t.x, t.y, r.w * t.scaleX, r.h * t.scaleY);\n  }\n  Ctx2d.ctx.fill();\n}\nfunction handleMoveTargets(world: World) {\n  for (const e of world.query({ and: [Transform, MovementTarget] })) {\n    const t = world.getComponent(e, Transform);\n    const mt = world.getComponent(e, MovementTarget);\n    const v = world.addComponent(e, Velocity);\n    const dx = mt.x - t.x;\n    const dy = mt.y - t.y;\n    const distance = (dx * dx + dy * dy) ** 0.5;\n    v.x = (dx / distance) * Game.cardSpeed;\n    v.y = (dy / distance) * Game.cardSpeed;\n    if (distance > Game.cardSpeed * Time.dtSeconds) continue;\n    v.x = v.y = 0;\n    t.x = mt.x;\n    t.y = mt.y;\n    world.removeComponent(e, MovementTarget);\n    world.removeComponent(e, Velocity);\n  }\n}\nfunction handleMovement(world: World) {\n  for (const e of world.query({ and: [Transform, Velocity] })) {\n    const t = world.getComponent(e, Transform);\n    const v = world.getComponent(e, Velocity);\n    t.x += v.x * Time.dtSeconds;\n    t.y += v.y * Time.dtSeconds;\n  }\n}\nfunction handleDrawText(world: World) {\n  for (const e of world.query({ and: [Text, Transform] })) {\n    const text = world.getComponent(e, Text);\n    const t = world.getComponent(e, Transform);\n    const split = text.content.split(\"\\n\");\n    Ctx2d.ctx.fillStyle = \"white\";\n    Ctx2d.ctx.font = text.font;\n    const textMetrics = Ctx2d.ctx.measureText(text.content);\n    for (let i = 0, l = split.length; i < l; i++) {\n      Ctx2d.ctx.fillText(\n        split[i],\n        t.x,\n        t.y + textMetrics.emHeightAscent * (i + 1),\n      );\n    }\n  }\n}\nasync function handleDealer(world: World) {\n  const dealersHand = 1;\n  const split = splitHand(world);\n  let value = calcHandValue(world, split[dealersHand]);\n  while (value <= 16) {\n    pickCard(world, false);\n    const split = splitHand(world);\n    value = calcHandValue(world, split[dealersHand]);\n    await sleep(2);\n  }\n  Game.status = checkWin(world);\n  calculateCredits();\n}\nfunction checkWin(world: World) {\n  const split = splitHand(world);\n  const playersHand = 0;\n  const dealersHand = 1;\n  const playersVal = calcHandValue(world, split[playersHand]);\n  const dealersVal = calcHandValue(world, split[dealersHand]);\n  if (playersVal > Game.targetVal) return GAME_STATUSES.BUSTED;\n  if (dealersVal == 0) return GAME_STATUSES.PLAY;\n  if (playersVal == Game.targetVal && dealersVal != Game.targetVal)\n    return GAME_STATUSES.BLACKJACK;\n  if (playersVal == dealersVal) return GAME_STATUSES.DRAW;\n  if (dealersVal > playersVal && dealersVal <= Game.targetVal)\n    return GAME_STATUSES.LOSE;\n  if (\n    (playersVal > dealersVal && playersVal <= Game.targetVal) ||\n    dealersVal > Game.targetVal\n  )\n    return GAME_STATUSES.WIN;\n  return GAME_STATUSES.PLAY;\n}\nfunction handleContainers(world: World) {\n  for (const e of world.query({\n    and: [Transform, HorizontalContainer, EntityContainer],\n  })) {\n    const t = world.getComponent(e, Transform);\n    const hC = world.getComponent(e, HorizontalContainer);\n    const eC = world.getComponent(e, EntityContainer);\n    const padX = hC.padding * t.scaleX;\n    const padY = hC.padding * t.scaleY;\n    const width = (hC.width - padX * 2) * t.scaleX;\n    let childrenTotalWidth = padX * t.scaleX * (eC.entities.length - 1);\n    let lastWidth = 0;\n    for (const child of eC.entities) {\n      const childTransform = world.getComponent(child, Transform);\n      let childWidth = 0;\n      if (world.hasComponent(child, Graphic)) {\n        childWidth = world.getComponent(child, Graphic).image.width;\n      }\n      if (world.hasComponent(child, Rect)) {\n        childWidth = world.getComponent(child, Rect).w;\n      }\n      childWidth *= childTransform.scaleX;\n      childrenTotalWidth += childWidth;\n      lastWidth = childWidth;\n    }\n    const needToStack = childrenTotalWidth > width;\n    let startX = needToStack\n      ? t.x + padX * t.scaleX\n      : t.x + hC.width / 2 - childrenTotalWidth / 2;\n    for (let i = 0, children = eC.entities, l = children.length; i < l; i++) {\n      const childTransform = world.getComponent(children[i], Transform);\n      let childWidth = 0;\n      if (world.hasComponent(children[i], Graphic)) {\n        childWidth = world.getComponent(children[i], Graphic).image.width;\n      }\n      if (world.hasComponent(children[i], Rect)) {\n        childWidth = world.getComponent(children[i], Rect).w;\n      }\n      childWidth *= childTransform.scaleX;\n      world.addComponent(children[i], MovementTarget, {\n        x: startX + (needToStack ? ((width - lastWidth) / (l - 1)) * i : 0),\n        y: t.y + padY,\n      });\n      startX += needToStack ? 0 : childWidth + padX;\n    }\n  }\n}\n\n// components\nconst Text = { content: \"placeholder\", font: \"\" };\nconst Transform = { x: 0, y: 0, rad: 0, scaleX: 1, scaleY: 1 };\nconst Graphic = { image: new Image() };\nconst Camera2D = { zoom: 1 };\nconst Card: { value: keyof typeof Deck } = { value: \"back\" };\nconst InHand = { isPlayer: true };\nconst Button = { hovered: false, justPressed: false, justReleased: false };\nconst Rect = { w: 10, h: 10 };\nconst Callback = { callback: (_: entityT) => {} };\nconst MovementTarget = { x: 0, y: 0 };\nconst Velocity = { x: 0, y: 0 };\nconst HorizontalContainer = { width: 100, padding: 0 };\nconst EntityContainer: { entities: entityT[] } = { entities: [] };\n\n// entities\nfunction setUpCardContainers(world: World) {\n  const playerContainer = world.addEntity();\n  world.addComponent(playerContainer, Transform, {\n    x: Ctx2d.canvas.width * 0.3,\n    y: Ctx2d.canvas.height - CardSpec.height,\n  });\n  world.addComponent(playerContainer, HorizontalContainer, {\n    width: Ctx2d.canvas.width * 0.65,\n  });\n  world.addComponent(playerContainer, EntityContainer, { entities: [] });\n  const dealerContainer = world.addEntity();\n  world.addComponent(dealerContainer, Transform, {\n    x: Ctx2d.canvas.width * 0.3,\n    y: 0,\n  });\n  world.addComponent(dealerContainer, HorizontalContainer, {\n    width: Ctx2d.canvas.width * 0.65,\n  });\n  world.addComponent(dealerContainer, EntityContainer, { entities: [] });\n}\nfunction setUpButtons(world: World) {\n  const buttons: { [name: string]: (_: entityT) => void } = {\n    \"bet /2\": (e) => {\n      const b = world.getComponent(e, Button);\n      if (b.justReleased) {\n        if (Game.status == GAME_STATUSES.PLAY) return;\n        Game.bet /= 2;\n        Game.bet = Math.round(Game.bet);\n        Game.bet = Math.max(Game.minBet, Game.bet);\n      }\n    },\n    \"bet *2\": (e) => {\n      const b = world.getComponent(e, Button);\n      if (b.justReleased) {\n        if (Game.status == GAME_STATUSES.PLAY) return;\n        Game.bet *= 2;\n        Game.bet = Math.min(Game.bet, Game.credits);\n      }\n    },\n    hit: (e) => {\n      const b = world.getComponent(e, Button);\n      if (b.justReleased) {\n        if (Game.status != GAME_STATUSES.PLAY) {\n          resumeGame(world);\n        }\n        pickCard(world);\n        Game.status = checkWin(world);\n        calculateCredits();\n      }\n    },\n    stay: (e) => {\n      const b = world.getComponent(e, Button);\n      if (b.justReleased) {\n        if (Game.status != GAME_STATUSES.PLAY) return;\n        const split = splitHand(world);\n        const playersHand = 0;\n        if (split[playersHand].length == 0) return;\n        handleDealer(world);\n      }\n    },\n    reset: (e) => {\n      const b = world.getComponent(e, Button);\n      if (b.justReleased) {\n        resetGame(world);\n      }\n    },\n  };\n  const w = 100;\n  const h = 100;\n  const y = Ctx2d.canvas.height / 2 - h / 2;\n  const padding = 5;\n  const dx = h + padding;\n  const names = Object.keys(buttons);\n  const width = names.length * dx + padding;\n  const startX = Ctx2d.canvas.width * 0.6 - width / 2;\n  const buttonContainer = world.addEntity();\n  world.addComponent(buttonContainer, Transform, { x: startX, y });\n  world.addComponent(buttonContainer, HorizontalContainer, { width, padding });\n  const eC = world.addComponent(buttonContainer, EntityContainer, {\n    entities: [],\n  });\n  for (let i = 0, l = names.length; i < l; i++) {\n    eC.entities.push(addButton(world, names[i], 0, 0, h, w, buttons[names[i]]));\n  }\n}\nfunction addButton(\n  world: World,\n  labal: string,\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n  callback = (_: entityT) => {},\n) {\n  const button = world.addEntity();\n  world.addComponent(button, Transform, { x, y });\n  world.addComponent(button, Callback, { callback });\n  world.addComponent(button, Rect, { w, h });\n  world.addComponent(button, Button);\n  world.addComponent(button, Text, { content: labal, font: \"20px sans-serif\" });\n  return button;\n}\nfunction addCard(world: World, value: keyof typeof Deck) {\n  const card = world.addEntity();\n  world.addComponent(card, Card, { value });\n  return card;\n}\n\n// singletons\nconst Pointers = setUpPointers();\nconst Ctx2d = setUpCanvas();\nconst Time = setUpTime();\nconst CardSpec = {\n  width: 1 * 200,\n  height: 1.43 * 200,\n  round: 0.05 * 200,\n};\nconst Deck = generateDeck(CardSpec.width, CardSpec.height, CardSpec.round);\nconst CardValues: Record<keyof typeof Deck, number[]> = {\n  \"hearts-A\": [1, 11],\n  \"hearts-2\": [2],\n  \"hearts-3\": [3],\n  \"hearts-4\": [4],\n  \"hearts-5\": [5],\n  \"hearts-6\": [6],\n  \"hearts-7\": [7],\n  \"hearts-8\": [8],\n  \"hearts-9\": [9],\n  \"hearts-10\": [10],\n  \"hearts-J\": [10],\n  \"hearts-Q\": [10],\n  \"hearts-K\": [10],\n  \"spades-A\": [1, 11],\n  \"spades-2\": [2],\n  \"spades-3\": [3],\n  \"spades-4\": [4],\n  \"spades-5\": [5],\n  \"spades-6\": [6],\n  \"spades-7\": [7],\n  \"spades-8\": [8],\n  \"spades-9\": [9],\n  \"spades-10\": [10],\n  \"spades-J\": [10],\n  \"spades-Q\": [10],\n  \"spades-K\": [10],\n  \"clubs-A\": [1, 11],\n  \"clubs-2\": [2],\n  \"clubs-3\": [3],\n  \"clubs-4\": [4],\n  \"clubs-5\": [5],\n  \"clubs-6\": [6],\n  \"clubs-7\": [7],\n  \"clubs-8\": [8],\n  \"clubs-9\": [9],\n  \"clubs-10\": [10],\n  \"clubs-J\": [10],\n  \"clubs-Q\": [10],\n  \"clubs-K\": [10],\n  \"diamonds-A\": [1, 11],\n  \"diamonds-2\": [2],\n  \"diamonds-3\": [3],\n  \"diamonds-4\": [4],\n  \"diamonds-5\": [5],\n  \"diamonds-6\": [6],\n  \"diamonds-7\": [7],\n  \"diamonds-8\": [8],\n  \"diamonds-9\": [9],\n  \"diamonds-10\": [10],\n  \"diamonds-J\": [10],\n  \"diamonds-Q\": [10],\n  \"diamonds-K\": [10],\n  back: [0],\n};\nconst enum GAME_STATUSES {\n  PLAY,\n  BLACKJACK,\n  BUSTED,\n  DRAW,\n  LOSE,\n  WIN,\n}\nconst Game: {\n  width: number;\n  height: number;\n  deckX: number;\n  deckY: number;\n  cardSpeed: number;\n  credits: number;\n  bet: number;\n  minBet: number;\n  targetVal: number;\n  status: GAME_STATUSES;\n} = {\n  width: 900,\n  height: 600,\n  deckX: 20,\n  deckY: 600 / 2 - 150,\n  cardSpeed: 1800,\n  credits: 100,\n  bet: 0,\n  minBet: 10,\n  targetVal: 21,\n  status: GAME_STATUSES.PLAY,\n};\nconst StatusStrings: Record<GAME_STATUSES, string> = {\n  [GAME_STATUSES.PLAY]: \"\",\n  [GAME_STATUSES.BLACKJACK]: \"Blackjack\",\n  [GAME_STATUSES.BUSTED]: \"Busted\",\n  [GAME_STATUSES.DRAW]: \"Draw\",\n  [GAME_STATUSES.LOSE]: \"Lose\",\n  [GAME_STATUSES.WIN]: \"Win\",\n};\n\nCtx2d.canvas.width = Game.width;\nCtx2d.canvas.height = Game.height;\n\nconst game = new World();\n\nfor (const card in Deck) {\n  if ((card as keyof typeof Deck) == \"back\") continue;\n  addCard(game, card as keyof typeof Deck);\n}\n\nconst cam = game.addEntity();\ngame.addComponent(cam, Transform);\ngame.addComponent(cam, Camera2D, { zoom: 1 });\n\nconst gameText = game.addEntity();\ngame.addComponent(gameText, Transform);\nconst gameTextComp = game.addComponent(gameText, Text, {\n  font: \"40px sans-serif\",\n});\n\nsetUpButtons(game);\nsetUpCardContainers(game);\nresetGame(game);\n\n{\n  (function loop() {\n    Ctx2d.ctx.resetTransform();\n    Ctx2d.ctx.fillStyle = \"#424242\";\n    Ctx2d.ctx.fillRect(0, 0, Ctx2d.canvas.width, Ctx2d.canvas.height);\n\n    gameTextComp.content = `Credits: ${Game.credits}\\nBet: ${Game.bet}\\n${StatusStrings[Game.status]}`;\n\n    drawDownedPointers();\n\n    // drawing\n    game.update(\n      handleCamera,\n      handleDrawImages,\n      handleDrawRects,\n      handleDrawText,\n    );\n\n    // process\n    game.update(\n      handleContainers,\n      handleCardVisibility,\n      handlePickCard,\n      handleCard2Img,\n      handleButtons,\n      handleMoveTargets,\n      handleCallbacks,\n      handleMovement,\n    );\n\n    updateTime(Time);\n    updatePointers(Pointers);\n    requestAnimationFrame(loop);\n  })();\n}\n"],
  "mappings": "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",
  "names": ["ObjectPoolMap", "objectFactory", "key", "index", "backKey", "temp", "ComponentManager", "component", "ObjectPoolMap", "mask", "entity", "entry", "src", "dest", "newEntity", "World", "ComponentManager", "entity", "newEntity", "src", "dest", "mask", "a", "component", "values", "compMask", "fns", "i", "l", "query", "andMask", "notMask", "res", "entry", "roundRectQuarter", "x", "y", "w", "h", "radius", "path", "drawCardSuits", "paths", "symbolMargin", "c", "s", "r", "inradius", "drawCard", "cardWidth", "cardHeight", "cardRound", "symbol", "text", "ctx", "isBack", "cardPadding", "i", "textMetrics", "generateDeck", "suits", "ranks", "canvas", "suitNames", "deck", "cardBack", "l", "suitIndex", "rankIndex", "img", "setUpTime", "updateTime", "time", "now", "setUpPointers", "pointers", "id", "updatePointers", "i", "l", "setUpCanvas", "canvas", "ctx", "screen2World", "x", "y", "clientRect", "Ctx2d", "ratio", "drawDownedPointers", "Pointers", "worldPos", "isPointInRect", "px", "py", "rx", "ry", "rw", "rh", "sleep", "seconds", "res", "handleCard2Img", "world", "Card", "Graphic", "c", "g", "Deck", "InHand", "handleDrawImages", "Transform", "t", "s", "handleCamera", "Camera2D", "cam", "pickACard", "forPlayer", "playersHand", "dealersHand", "e", "EntityContainer", "eC", "CardSpec", "deck", "drew", "Game", "splitHand", "inHandCards", "split", "pickCard", "handlePickCard", "graphics", "faceDownIndex", "facedDown", "clicked", "handleCardVisibility", "MovementTarget", "resetCards", "resetGame", "calculateCredits", "resumeGame", "calcHandValue", "hand", "target", "value", "vals", "indices", "values", "CardValues", "exhausted", "indexSum", "handleButtons", "Button", "Rect", "b", "r", "handleCallbacks", "Callback", "handleDrawRects", "handleMoveTargets", "mt", "v", "Velocity", "dx", "dy", "distance", "Time", "handleMovement", "handleDrawText", "Text", "text", "textMetrics", "handleDealer", "checkWin", "playersVal", "dealersVal", "handleContainers", "HorizontalContainer", "hC", "padX", "padY", "width", "childrenTotalWidth", "lastWidth", "child", "childTransform", "childWidth", "needToStack", "startX", "children", "_", "setUpCardContainers", "playerContainer", "dealerContainer", "setUpButtons", "buttons", "w", "h", "padding", "names", "buttonContainer", "addButton", "labal", "callback", "button", "addCard", "card", "generateDeck", "StatusStrings", "game", "World", "gameText", "gameTextComp", "loop"]
}
