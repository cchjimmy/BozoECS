{
  "version": 3,
  "sources": ["../../../src/pool.ts", "../../../src/component.ts", "../../../src/entity.ts", "../../../src/world.ts", "../src/cards.ts", "../src/main.ts"],
  "sourcesContent": ["export class ObjectPoolMap<K, V> {\n  private storage: V[] = [];\n  private keyToIndex: Map<K, number> = new Map();\n  private indexToKey: K[] = [];\n  private objectFactory: () => V;\n\n  constructor(objectFactory: () => V) {\n    this.objectFactory = objectFactory;\n  }\n\n  size() {\n    return this.keyToIndex.size;\n  }\n\n  add(key: K): V {\n    if (this.keyToIndex.has(key))\n      return this.storage[this.keyToIndex.get(key) as number];\n    if (this.storage.length <= this.keyToIndex.size)\n      this.storage.push(this.objectFactory());\n    this.keyToIndex.set(key, this.keyToIndex.size);\n    this.indexToKey[this.keyToIndex.size - 1] = key;\n    return this.storage[this.keyToIndex.get(key) as number];\n  }\n\n  remove(key: K): void {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) return;\n    const backKey = this.indexToKey[this.keyToIndex.size - 1];\n    const temp = this.storage[index];\n    this.storage[index] = this.storage[this.keyToIndex.size - 1];\n    this.storage[this.keyToIndex.size - 1] = temp;\n    this.indexToKey[index] = backKey;\n    this.indexToKey.pop();\n    this.keyToIndex.set(backKey, index);\n    this.keyToIndex.delete(key);\n  }\n\n  get(key: K): V {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) throw new Error(\"Key not found.\");\n    return this.storage[index];\n  }\n\n  has(key: K): boolean {\n    return this.keyToIndex.has(key);\n  }\n\n  clean(): void {\n    this.storage.splice(this.keyToIndex.size);\n  }\n}\n", "import { ObjectPoolMap } from \"./pool.ts\";\nimport { entityT } from \"./entity.ts\";\n\nexport class ComponentManager {\n  private poolMap: Map<object, ObjectPoolMap<entityT, object>> = new Map();\n  private maskMap: Map<object, number> = new Map();\n\n  register<T extends object>(component: T): void {\n    if (this.poolMap.has(component)) return;\n    this.maskMap.set(component, 1 << this.maskMap.size);\n    this.poolMap.set(\n      component,\n      new ObjectPoolMap<entityT, T>(() => ({ ...component })),\n    );\n  }\n\n  getMask<T extends object>(component: T): number {\n    const mask = this.maskMap.get(component);\n    if (mask != undefined) return mask;\n    this.register(component);\n    return this.maskMap.get(component) as number;\n  }\n\n  add<T extends object>(entity: entityT, component: T): T {\n    return Object.assign(\n      (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).add(entity),\n      component,\n    );\n  }\n\n  remove<T extends object>(entity: entityT, component: T): void {\n    (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).remove(entity);\n  }\n\n  has<T extends object>(entity: entityT, component: T): boolean {\n    return (\n      this.poolMap.has(component) &&\n      (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).has(entity)\n    );\n  }\n\n  get<T extends object>(entity: entityT, component: T): T {\n    return (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).get(\n      entity,\n    );\n  }\n\n  size<T extends object>(component: T): number {\n    return (this.poolMap.get(component) as ObjectPoolMap<entityT, T>).size();\n  }\n\n  delete(entity: entityT): void {\n    for (const entry of this.poolMap.entries()) entry[1].remove(entity);\n  }\n\n  copy(src: entityT, dest: entityT): void {\n    for (const entry of this.poolMap.entries())\n      entry[1].has(src) && Object.assign(entry[1].add(dest), entry[1].get(src));\n  }\n\n  clean(): void {\n    for (const entry of this.poolMap.entries()) entry[1].clean();\n  }\n}\n", "export type entityT = number;\nexport function newEntity(): entityT {\n  return Math.random();\n}\n", "import { ComponentManager } from \"./component.ts\";\nimport { newEntity, type entityT } from \"./entity.ts\";\n\nexport type queryT = Partial<Record<\"and\" | \"not\", object[]>>;\n\nexport type systemT = (world: World) => void;\n\nexport class World {\n  private maskMap: Map<entityT, number> = new Map();\n  private archetypeMap: Map<number, Set<entityT>> = new Map();\n  private compManager = new ComponentManager();\n\n  addEntity(entity: entityT = newEntity()): entityT {\n    if (this.maskMap.has(entity)) return entity;\n    this.maskMap.set(entity, 0);\n    return entity;\n  }\n\n  copyEntity(src: entityT, dest: entityT = newEntity()): entityT {\n    this.compManager.copy(src, dest);\n    const mask = this.maskMap.get(src) ?? 0;\n    this.maskMap.set(dest, mask);\n    this.getArchetype(mask).add(dest);\n    return dest;\n  }\n\n  private getArchetype(mask: number): Set<entityT> {\n    const a = this.archetypeMap.get(mask) ?? new Set();\n    this.archetypeMap.set(mask, a);\n    return a;\n  }\n\n  deleteEntity(entity: entityT) {\n    this.compManager.delete(entity);\n    this.getArchetype(this.maskMap.get(entity) ?? 0).delete(entity);\n    this.maskMap.delete(entity);\n  }\n\n  registerComponent<T extends object>(component: T): World {\n    this.compManager.register(component);\n    return this;\n  }\n\n  hasComponent<T extends object>(entity: entityT, component: T): boolean {\n    return this.compManager.has(entity, component);\n  }\n\n  addComponent<T extends object>(\n    entity: entityT,\n    component: T,\n    values: Partial<T> = component,\n  ): T {\n    this.compManager.register(component);\n    let mask = this.maskMap.get(entity) ?? 0;\n    const compMask = this.compManager.getMask(component);\n    if (mask & compMask)\n      return Object.assign(this.compManager.get(entity, component), values);\n    this.getArchetype(mask).delete(entity);\n    mask ^= compMask;\n    this.maskMap.set(entity, mask);\n    this.getArchetype(mask).add(entity);\n    return Object.assign(this.compManager.add(entity, component), values);\n  }\n\n  removeComponent<T extends object>(entity: entityT, component: T): void {\n    this.compManager.register(component);\n    let mask = this.maskMap.get(entity) ?? 0;\n    const compMask = this.compManager.getMask(component);\n    if ((mask & compMask) ^ compMask) return;\n    this.compManager.remove(entity, component);\n    this.getArchetype(mask).delete(entity);\n    mask ^= compMask;\n    this.maskMap.set(entity, mask);\n    this.getArchetype(mask).add(entity);\n  }\n\n  getComponent<T extends object>(entity: entityT, component: T): T {\n    return this.compManager.get(entity, component);\n  }\n\n  update(...fns: systemT[]) {\n    for (let i = 0, l = fns.length; i < l; i++) fns[i](this);\n  }\n\n  cleanObjectPools(): void {\n    this.compManager.clean();\n  }\n\n  query(query: queryT): entityT[] {\n    let andMask = 0,\n      notMask = 0;\n    if (query.and) {\n      for (let i = 0, l = query.and.length; i < l; i++)\n        andMask |= this.compManager.getMask(query.and[i]);\n    }\n    if (query.not) {\n      for (let i = 0, l = query.not.length; i < l; i++)\n        notMask |= this.compManager.getMask(query.not[i]);\n    }\n    const res: entityT[] = [];\n    for (const entry of this.archetypeMap.entries()) {\n      entry[1].size > 0 &&\n        (entry[0] & andMask) == andMask &&\n        (entry[0] & notMask) == 0 &&\n        res.push(...entry[1]);\n    }\n    return res;\n  }\n\n  entityCount(): number {\n    return this.maskMap.size;\n  }\n}\n", "function roundRectQuarter(\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n  radius: number,\n) {\n  const path = new Path2D();\n  path.moveTo(x + w / 2, y);\n  path.arcTo(x + w, y, x + w, y + h / 2, radius);\n  path.lineTo(x + w, y + h / 2);\n  return path;\n}\nfunction drawCardSuits(): {\n  hearts: Path2D;\n  spades: Path2D;\n  clubs: Path2D;\n  diamonds: Path2D;\n} {\n  const paths: {\n    hearts: Path2D;\n    spades: Path2D;\n    clubs: Path2D;\n    diamonds: Path2D;\n  } = {\n    hearts: new Path2D(),\n    spades: new Path2D(),\n    clubs: new Path2D(),\n    diamonds: new Path2D(),\n  };\n  const symbolMargin = 1;\n  {\n    const path = paths[\"hearts\"];\n    const c = Math.cos(Math.PI / 4);\n    const s = Math.sin(Math.PI / 4);\n    let x = symbolMargin / 4;\n    const y = symbolMargin / 4;\n    const r = symbolMargin / 4;\n    path.arc(x, y, r, 0, Math.PI * 2);\n    path.arc(x + symbolMargin / 2, y, r, 0, Math.PI * 2);\n    path.moveTo(x + -s * r, y + c * r);\n    path.lineTo(symbolMargin / 2, symbolMargin);\n    x += symbolMargin / 2;\n    path.lineTo(x + c * r, y + s * r);\n  }\n  {\n    const path = paths[\"spades\"];\n    const x = symbolMargin / 4;\n    const y = symbolMargin / 2;\n    const r = symbolMargin / 4;\n    const c = Math.cos(Math.PI / 4);\n    const s = Math.sin(Math.PI / 4);\n    path.arc(x, y, r, 0, Math.PI * 2);\n    path.arc(x + symbolMargin / 2, y, r, 0, Math.PI * 2);\n    path.moveTo(x + c * -r, y + s * -r);\n    path.lineTo(symbolMargin / 2, 0);\n    path.lineTo(x + symbolMargin / 2 + -s * -r, y + c * -r);\n    path.moveTo(symbolMargin / 2, y);\n    path.lineTo(x + symbolMargin / 8, symbolMargin);\n    path.lineTo((symbolMargin / 8) * 5, symbolMargin);\n    path.closePath();\n  }\n  {\n    // credits: https://en.wikipedia.org/wiki/Rhombus#Inradius\n    const path = paths[\"diamonds\"];\n    const inradius =\n      (symbolMargin * (symbolMargin - symbolMargin / 4)) /\n      (2 * (symbolMargin ** 2 + (symbolMargin - symbolMargin / 4) ** 2) ** 0.5);\n    path.arc(symbolMargin / 2, symbolMargin / 2, inradius, 0, Math.PI * 2);\n    path.moveTo(symbolMargin / 2, 0);\n    path.lineTo(symbolMargin / 8, symbolMargin / 2);\n    path.lineTo(symbolMargin / 2, symbolMargin);\n    path.lineTo(symbolMargin - symbolMargin / 8, symbolMargin / 2);\n    path.closePath();\n  }\n  {\n    const path = paths[\"clubs\"];\n    const x = symbolMargin / 4;\n    const y = symbolMargin / 2;\n    const r = symbolMargin / 4;\n    path.arc(symbolMargin / 2, r, r, 0, Math.PI * 2);\n    path.arc(x, y, r, 0, Math.PI * 2);\n    path.arc(x + symbolMargin / 2, y, r, 0, Math.PI * 2);\n    path.moveTo(symbolMargin / 2, y);\n    path.lineTo(x + symbolMargin / 8, symbolMargin);\n    path.lineTo((symbolMargin / 8) * 5, symbolMargin);\n    path.closePath();\n  }\n  return paths;\n}\nfunction drawCard(\n  cardWidth = 1,\n  cardHeight = 1.43,\n  cardRound = 0.05,\n  symbol: \"hearts\" | \"spades\" | \"diamonds\" | \"clubs\",\n  text: string,\n  paths: Record<typeof symbol, Path2D>,\n  ctx: CanvasRenderingContext2D,\n  isBack = false,\n) {\n  const cardPadding = cardWidth * 0.03;\n  const symbolMargin = cardWidth / 2;\n\n  // rotation\n  const c = Math.cos(Math.PI);\n  const s = Math.sin(Math.PI);\n  const x = cardWidth;\n  const y = cardHeight;\n\n  ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);\n\n  // card body\n  ctx.fillStyle = \"lightgrey\";\n  ctx.beginPath();\n  ctx.roundRect(0, 0, cardWidth, cardHeight, cardRound);\n  ctx.fill();\n  ctx.save();\n  ctx.clip();\n  if (isBack) {\n    ctx.fillStyle = \"darkgrey\";\n  } else {\n    ctx.fillStyle = \"silver\";\n  }\n  ctx.beginPath();\n  ctx.roundRect(\n    cardPadding,\n    cardPadding,\n    cardWidth - cardPadding * 2,\n    cardHeight - cardPadding * 2,\n    cardRound,\n  );\n  ctx.fill();\n  if (isBack) {\n    ctx.save();\n    ctx.clip();\n    ctx.strokeStyle = \"silver\";\n    ctx.lineWidth = cardWidth * 0.05;\n    const path = new Path2D();\n    for (let i = cardHeight / 2; i > 0; i -= ctx.lineWidth * 2) {\n      path.ellipse(cardWidth * 0.5, 0, cardWidth * 0.5, i, 0, 0, Math.PI);\n    }\n    ctx.setTransform(c, s, -s, c, x, y);\n    ctx.transform(1, 0, 0, 1, cardWidth / 2, 0);\n    ctx.stroke(path);\n    ctx.transform(c, s, -s, c, x, y);\n    ctx.stroke(path);\n    ctx.transform(1, 0, 0, 1, cardWidth, 0);\n    ctx.stroke(path);\n    ctx.transform(c, s, -s, c, x, y);\n    ctx.stroke(path);\n    ctx.resetTransform();\n    ctx.restore();\n  }\n\n  ctx.strokeStyle = \"gold\";\n  ctx.fillStyle = \"gold\";\n\n  // decorative lines\n  if (!isBack) {\n    {\n      ctx.lineWidth = cardWidth / 30;\n      const path = new Path2D();\n      path.moveTo(cardPadding, cardHeight * 0.7 + cardPadding);\n      path.arcTo(\n        cardPadding,\n        cardHeight - cardPadding,\n        cardWidth * 0.3 - cardPadding,\n        cardHeight - cardPadding,\n        ctx.lineWidth,\n      );\n      path.lineTo(cardWidth * 0.3 - cardPadding, cardHeight - cardPadding);\n      ctx.stroke(path);\n      ctx.transform(c, s, -s, c, x, y);\n      ctx.stroke(path);\n      ctx.resetTransform();\n    }\n    {\n      ctx.lineWidth = cardWidth / 100;\n      const path = new Path2D();\n      path.moveTo(cardPadding * 2, cardHeight * 0.7 + cardPadding * 2);\n      path.arcTo(\n        cardPadding * 2,\n        cardHeight - cardPadding * 2,\n        cardWidth * 0.3 - cardPadding * 2,\n        cardHeight - cardPadding * 2,\n        ctx.lineWidth,\n      );\n      path.lineTo(\n        cardWidth * 0.3 - cardPadding * 2,\n        cardHeight - cardPadding * 2,\n      );\n      ctx.stroke(path);\n      ctx.transform(c, s, -s, c, x, y);\n      ctx.stroke(path);\n      ctx.resetTransform();\n    }\n  } else {\n    ctx.lineWidth = cardWidth / 30;\n    const path = roundRectQuarter(\n      cardPadding,\n      cardPadding,\n      cardWidth - cardPadding * 2,\n      cardHeight - cardPadding * 2,\n      ctx.lineWidth,\n    );\n    ctx.stroke(path);\n    ctx.setTransform(c, s, -s, c, x, y);\n    ctx.stroke(path);\n    ctx.resetTransform();\n\n    ctx.lineWidth = cardWidth / 100;\n    ctx.roundRect(\n      cardPadding * 2,\n      cardPadding * 2,\n      cardWidth - cardPadding * 4,\n      cardHeight - cardPadding * 4,\n      ctx.lineWidth,\n    );\n    ctx.stroke();\n  }\n\n  // draw suits and ranks\n  ctx.lineWidth = cardWidth / 10000;\n  ctx.transform(symbolMargin, 0, 0, symbolMargin, cardPadding, cardPadding);\n  if (!isBack) ctx.stroke(paths[symbol]);\n  ctx.resetTransform();\n  ctx.font = `${cardWidth / 2.5}px sans-serif`;\n  const textMetrics = ctx.measureText(text);\n  ctx.fillText(\n    text,\n    (cardWidth - cardPadding * 2) / 4 - textMetrics.width / 2 + cardPadding,\n    cardHeight / 2 + textMetrics.emHeightAscent,\n  );\n  ctx.transform(c, s, -s, c, x, y);\n  ctx.fillText(\n    text,\n    (cardWidth - cardPadding * 2) / 4 - textMetrics.width / 2 + cardPadding,\n    cardHeight / 2 + textMetrics.emHeightAscent,\n  );\n  ctx.transform(symbolMargin, 0, 0, symbolMargin, cardPadding, cardPadding);\n  if (!isBack) ctx.stroke(paths[symbol]);\n  ctx.resetTransform();\n  ctx.restore();\n}\nexport function generateDeck(\n  cardWidth = 1,\n  cardHeight = 1.43,\n  cardRound = 0.05,\n) {\n  const suits = drawCardSuits();\n  const ranks = [\n    \"A\",\n    \"2\",\n    \"3\",\n    \"4\",\n    \"5\",\n    \"6\",\n    \"7\",\n    \"8\",\n    \"9\",\n    \"10\",\n    \"J\",\n    \"Q\",\n    \"K\",\n  ] as const;\n  const canvas = document.createElement(\"canvas\");\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) throw new Error(\"cannot initialize 2d context.\");\n  canvas.width = cardWidth;\n  canvas.height = cardHeight;\n  const suitNames = Object.keys(suits);\n  const deck: Record<string, HTMLImageElement> = {};\n  drawCard(cardWidth, cardHeight, cardRound, \"hearts\", \"\", suits, ctx, true);\n  const cardBack = new Image();\n  cardBack.src = canvas.toDataURL();\n  deck[\"back\"] = cardBack;\n  for (let i = 0, l = suitNames.length * ranks.length; i < l; i++) {\n    const suitIndex = Math.floor(i / ranks.length);\n    const rankIndex = i % ranks.length;\n    drawCard(\n      cardWidth,\n      cardHeight,\n      cardRound,\n      suitNames[suitIndex] as keyof typeof suits,\n      ranks[rankIndex],\n      suits,\n      ctx,\n    );\n    const img = new Image();\n    img.src = canvas.toDataURL();\n    deck[`${suitNames[suitIndex]}-${ranks[rankIndex]}`] = img;\n  }\n  return deck as Record<\n    `${keyof typeof suits}-${(typeof ranks)[number]}` | \"back\",\n    HTMLImageElement\n  >;\n}\n", "import { entityT, World } from \"bozoecs\";\nimport { generateDeck } from \"./cards.ts\";\n\n// credit: https://www.wikihow.com/Play-Blackjack\n\n// utils\nfunction setUpTime() {\n  const time = { dtMilli: 0, timeMilli: 0, dtSeconds: 0, timeSeconds: 0 };\n  return time;\n}\nfunction updateTime(time: {\n  dtMilli: number;\n  timeMilli: number;\n  dtSeconds: number;\n  timeSeconds: number;\n}) {\n  const now = performance.now();\n  time.dtMilli = now - time.timeMilli;\n  time.timeMilli += time.dtMilli;\n  time.dtSeconds = time.dtMilli / 1000;\n  time.timeSeconds = time.timeMilli / 1000;\n}\nfunction setUpPointers() {\n  const pointers: {\n    x: number[];\n    y: number[];\n    isDown: boolean[];\n    justPressed: boolean[];\n    justReleased: boolean[];\n  } = {\n    x: [],\n    y: [],\n    isDown: [],\n    justPressed: [],\n    justReleased: [],\n  };\n  globalThis.onpointerup = (e) => {\n    const id = e.pointerId;\n    pointers.x[id] = e.x;\n    pointers.y[id] = e.y;\n    pointers.isDown[id] = false;\n    pointers.justReleased[id] = true;\n  };\n  globalThis.onpointerdown = (e) => {\n    const id = e.pointerId;\n    pointers.x[id] = e.x;\n    pointers.y[id] = e.y;\n    pointers.isDown[id] = true;\n    pointers.justPressed[id] = true;\n  };\n  globalThis.onpointermove = (e) => {\n    const id = e.pointerId;\n    pointers.x[id] = e.x;\n    pointers.y[id] = e.y;\n  };\n  return pointers;\n}\nfunction updatePointers(pointers: {\n  justPressed: boolean[];\n  justReleased: boolean[];\n}) {\n  for (let i = 0, l = pointers.justPressed.length; i < l; i++) {\n    pointers.justPressed[i] = false;\n    pointers.justReleased[i] = false;\n  }\n}\nfunction setUpCanvas() {\n  let canvas = document.querySelector(\"canvas\");\n  if (!canvas) {\n    canvas = document.createElement(\"canvas\");\n    document.appendChild(canvas);\n  }\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) throw new Error(\"cannot initialize 2d context.\");\n  return { canvas, ctx };\n}\nfunction screen2World(x: number, y: number) {\n  const clientRect = Ctx2d.canvas.getBoundingClientRect();\n  const ratio =\n    Ctx2d.canvas.width / Ctx2d.canvas.height > innerWidth / innerHeight\n      ? innerWidth / Ctx2d.canvas.width\n      : innerHeight / Ctx2d.canvas.height;\n  return {\n    x: (x - clientRect.left) / ratio,\n    y: (y - clientRect.top) / ratio,\n  };\n}\nfunction isPointInRect(\n  px: number,\n  py: number,\n  rx: number,\n  ry: number,\n  rw: number,\n  rh: number,\n) {\n  return px > rx && px < rx + rw && py > ry && py < ry + rh;\n}\n// credit: https://stackoverflow.com/questions/951021/what-is-the-javascript-version-of-sleep\nfunction sleep(seconds: number) {\n  return new Promise((res) => setTimeout(res, seconds * 1000));\n}\nfunction calcHandValue(\n  world: World,\n  hand: entityT[] = [],\n  target: number = 21,\n) {\n  let value = 0;\n  const vals: number[][] = [];\n  const indices: number[] = [];\n  for (const e of hand) {\n    const c = world.getComponent(e, Card);\n    const values = CardValues[c.value].sort();\n    vals.push(values);\n    indices.push(values.length - 1);\n    value += values[values.length - 1];\n  }\n  let exhausted = false;\n  while (value > target && !exhausted) {\n    let indexSum = 0;\n    for (let i = 0, l = indices.length; i < l; i++) {\n      if (indices[i] == 0) continue;\n      indexSum += indices[i];\n      value -= vals[i][indices[i]];\n      indices[i]--;\n      value += vals[i][indices[i]];\n      if (value <= target) break;\n    }\n    exhausted = indexSum == 0;\n  }\n  return value;\n}\nfunction pickACard(world: World, forPlayer = true, revealed = true) {\n  let playersHand: entityT[] | undefined;\n  let dealersHand: entityT[] | undefined;\n  for (const e of world.query({ and: [Transform, EntityContainer] })) {\n    const t = world.getComponent(e, Transform);\n    const eC = world.getComponent(e, EntityContainer);\n    if (t.y == 0) dealersHand = eC.entities;\n    if (t.y == Ctx2d.canvas.height - CardSpec.height) playersHand = eC.entities;\n  }\n  if (!playersHand || !dealersHand) return;\n  const deck = world.query({ and: [Card], not: [InHand] });\n  if (deck.length == 0) return;\n  const drew = deck[Math.round(Math.random() * (deck.length - 1))];\n  world.addComponent(drew, InHand, {\n    isPlayer: forPlayer,\n    isRevealed: revealed,\n  });\n  world.addComponent(drew, Transform, { x: Game.deckX, y: Game.deckY });\n  world.addComponent(drew, Graphic);\n  if (forPlayer) {\n    playersHand.push(drew);\n  } else {\n    dealersHand.push(drew);\n  }\n}\nfunction splitHand(world: World) {\n  const inHandCards = world.query({ and: [InHand] });\n  const split: entityT[][] = [[], []];\n  const playersHand = 0;\n  const dealersHand = 1;\n  for (const e of inHandCards) {\n    split[\n      world.getComponent(e, InHand).isPlayer ? playersHand : dealersHand\n    ].push(e);\n  }\n  return split;\n}\nfunction setButtonsActivation(world: World, enabled = true) {\n  for (const e of world.query({ and: [Button] })) {\n    world.getComponent(e, Button).enabled = enabled;\n  }\n}\nasync function pickCard(world: World, forPlayer = true) {\n  const split = splitHand(world);\n  const playersHand = 0;\n  const dealersHand = 1;\n  if (split[playersHand].length == 0 && split[dealersHand].length == 0) {\n    setButtonsActivation(world, false);\n    for (let i = 0; i < 4; i++) {\n      pickACard(world, i % 2 != 0, i != 2);\n      await sleep(0.2);\n    }\n    setButtonsActivation(world, true);\n    return;\n  }\n  pickACard(world, forPlayer);\n}\nfunction resetGame(world: World) {\n  resetCards(world);\n  Game.credits = 100;\n  Game.minBet = 10;\n  Game.bet = Game.minBet;\n  Game.status = GAME_STATUSES.PLAY;\n  Game.rounds = 0;\n  Game.best = parseInt(localStorage.getItem(\"best_blackjack\") ?? \"0\");\n}\nfunction calculateCredits() {\n  switch (Game.status) {\n    case GAME_STATUSES.BLACKJACK:\n      // 3:2 ratio\n      Game.credits += Math.floor((Game.bet / 2) * 3);\n      break;\n    case GAME_STATUSES.LOSE:\n    case GAME_STATUSES.BUSTED:\n      Game.credits -= Game.bet;\n      break;\n    case GAME_STATUSES.WIN:\n      Game.credits += Game.bet;\n      break;\n    case GAME_STATUSES.PLAY:\n    case GAME_STATUSES.DRAW:\n  }\n}\nfunction resumeGame(world: World) {\n  resetCards(world);\n  Game.status = GAME_STATUSES.PLAY;\n  Game.rounds++;\n  if (Game.rounds % Game.roundsTilBetIncrease == 0) {\n    Game.minBet **= Game.betIncreaseExponent;\n    Game.minBet = Math.ceil(Game.minBet);\n  }\n  Game.bet = Math.max(Game.minBet, Game.bet);\n}\nfunction resetCards(world: World) {\n  for (const e of world.query({ and: [InHand] })) {\n    world.removeComponent(e, InHand);\n    world.addComponent(e, MovementTarget, { x: Game.deckX, y: Game.deckY });\n  }\n  for (const e of world.query({ and: [Transform, EntityContainer] })) {\n    const t = world.getComponent(e, Transform);\n    const eC = world.getComponent(e, EntityContainer);\n    if (t.y == 0 || t.y == Ctx2d.canvas.height - CardSpec.height) {\n      eC.entities.length = 0;\n    }\n  }\n}\nasync function handleDealer(world: World) {\n  const dealersHand = 1;\n  const split = splitHand(world);\n  setButtonsActivation(world, false);\n  if (split[dealersHand].length == 2) {\n    world.getComponent(split[dealersHand][1], InHand).isRevealed = true;\n    await sleep(1);\n  }\n  let value = calcHandValue(world, split[dealersHand]);\n  while (value <= Game.dealerHitThreashold) {\n    pickCard(world, false);\n    const split = splitHand(world);\n    value = calcHandValue(world, split[dealersHand]);\n    await sleep(1);\n  }\n  setButtonsActivation(world, true);\n  Game.status = checkWin(world);\n  calculateCredits();\n  if (Game.credits < Game.minBet) {\n    Game.status = GAME_STATUSES.GAMEOVER;\n  }\n}\nfunction checkWin(world: World) {\n  const split = splitHand(world);\n  const playersHand = 0;\n  const dealersHand = 1;\n  const playersVal = calcHandValue(world, split[playersHand]);\n  const dealersVal = calcHandValue(world, split[dealersHand]);\n  if (Game.credits < Game.minBet) return GAME_STATUSES.GAMEOVER;\n  if (playersVal > Game.targetVal) return GAME_STATUSES.BUSTED;\n  if (dealersVal == 0 || playersVal == 0) return GAME_STATUSES.PLAY;\n  if (playersVal == Game.targetVal && dealersVal != Game.targetVal)\n    return GAME_STATUSES.BLACKJACK;\n  if (playersVal == dealersVal) return GAME_STATUSES.DRAW;\n  if (dealersVal > playersVal && dealersVal <= Game.targetVal)\n    return GAME_STATUSES.LOSE;\n  if (\n    (playersVal > dealersVal && playersVal <= Game.targetVal) ||\n    dealersVal > Game.targetVal\n  )\n    return GAME_STATUSES.WIN;\n  return GAME_STATUSES.PLAY;\n}\nfunction onGameOver() {\n  Game.best = Game.best > Game.rounds ? Game.best : Game.rounds;\n  localStorage.setItem(\"best_blackjack\", Game.best.toString());\n}\n\n// systems\nfunction handleCard2Img(world: World) {\n  for (const e of world.query({ and: [Card, Graphic] })) {\n    const c = world.getComponent(e, Card);\n    const g = world.getComponent(e, Graphic);\n    g.image = Deck[c.value];\n    if (!world.hasComponent(e, InHand)) {\n      g.image = Deck[\"back\"];\n    } else if (!world.getComponent(e, InHand).isRevealed) {\n      g.image = Deck[\"back\"];\n    }\n  }\n}\nfunction handleDrawImages(world: World) {\n  for (const e of world.query({ and: [Transform, Graphic] })) {\n    const t = world.getComponent(e, Transform);\n    const g = world.getComponent(e, Graphic);\n    const c = Math.cos(t.rad);\n    const s = Math.sin(t.rad);\n    Ctx2d.ctx.transform(c, s, -s, c, t.x, t.y);\n    Ctx2d.ctx.transform(t.scaleX, 0, 0, t.scaleY, 0, 0);\n    Ctx2d.ctx.drawImage(g.image, 0, 0);\n    Ctx2d.ctx.transform(1 / t.scaleX, 0, 0, 1 / t.scaleY, 0, 0);\n    Ctx2d.ctx.transform(c, -s, s, c, c * -t.x + s * -t.y, -s * -t.x + c * -t.y);\n  }\n}\nfunction handleCamera(world: World) {\n  for (const e of world.query({ and: [Transform, Camera2D] })) {\n    const t = world.getComponent(e, Transform);\n    const cam = world.getComponent(e, Camera2D);\n    const c = Math.cos(t.rad) * cam.zoom;\n    const s = Math.sin(t.rad) * cam.zoom;\n    Ctx2d.ctx.setTransform(c, s, -s, c, t.x, t.y);\n  }\n}\nfunction handlePickCard(world: World) {\n  const deck = world.query({ and: [Card], not: [InHand] });\n  const graphics = world.query({ and: [Graphic], not: [Card] });\n  const faceDownIndex = graphics.findIndex(\n    (e) => (world.getComponent(e, Graphic).image = Deck[\"back\"]),\n  );\n  if (deck.length > 0) {\n    if (faceDownIndex == -1) {\n      const facedDown = world.addEntity();\n      world.addComponent(facedDown, Transform, {\n        x: Game.deckX,\n        y: Game.deckY,\n      });\n      world.addComponent(facedDown, Graphic, { image: Deck[\"back\"] });\n      return;\n    }\n    if (Game.status == GAME_STATUSES.PLAY) return;\n    const t = world.getComponent(graphics[faceDownIndex], Transform);\n    const g = world.getComponent(graphics[faceDownIndex], Graphic);\n    let clicked = false;\n    for (let i = 0, l = Pointers.x.length; i < l; i++) {\n      const worldPos = screen2World(Pointers.x[i], Pointers.y[i]);\n      if (\n        !isPointInRect(\n          worldPos.x,\n          worldPos.y,\n          t.x,\n          t.y,\n          g.image.width * t.scaleX,\n          g.image.height * t.scaleY,\n        )\n      )\n        continue;\n      clicked = Pointers.justPressed[i];\n      if (!clicked) continue;\n      break;\n    }\n    if (!clicked) return;\n    pickCard(world);\n  } else {\n    world.deleteEntity(graphics[faceDownIndex]);\n  }\n}\nfunction handleCardVisibility(world: World) {\n  for (const e of world.query({\n    and: [Card, Transform, Graphic],\n    not: [InHand, MovementTarget],\n  })) {\n    world.removeComponent(e, Transform);\n    world.removeComponent(e, Graphic);\n  }\n}\nfunction handleButtons(world: World) {\n  for (const e of world.query({ and: [Button, Transform, Rect] })) {\n    const b = world.getComponent(e, Button);\n    const t = world.getComponent(e, Transform);\n    const r = world.getComponent(e, Rect);\n    b.hovered = b.justPressed = b.justReleased = false;\n    if (!b.enabled) continue;\n    for (let i = 0, l = Pointers.x.length; i < l; i++) {\n      const worldPos = screen2World(Pointers.x[i], Pointers.y[i]);\n      b.hovered ||= isPointInRect(\n        worldPos.x,\n        worldPos.y,\n        t.x,\n        t.y,\n        r.w * t.scaleX,\n        r.h * t.scaleY,\n      );\n      b.justPressed ||= b.hovered && Pointers.justPressed[i];\n      b.justReleased ||= b.hovered && Pointers.justReleased[i];\n    }\n  }\n}\nfunction handleCallbacks(world: World) {\n  for (const e of world.query({ and: [Callback] })) {\n    world.getComponent(e, Callback).callback(e);\n  }\n}\nfunction handleDrawRects(world: World) {\n  for (const e of world.query({ and: [Transform, Rect, Colour] })) {\n    const t = world.getComponent(e, Transform);\n    const r = world.getComponent(e, Rect);\n    const c = world.getComponent(e, Colour);\n    Ctx2d.ctx.fillStyle = c.fill;\n    Ctx2d.ctx.strokeStyle = c.stroke;\n    Ctx2d.ctx.fillRect(t.x, t.y, r.w * t.scaleX, r.h * t.scaleY);\n    Ctx2d.ctx.strokeRect(t.x, t.y, r.w * t.scaleX, r.h * t.scaleY);\n  }\n}\nfunction handleMoveTargets(world: World) {\n  for (const e of world.query({ and: [Transform, MovementTarget] })) {\n    const t = world.getComponent(e, Transform);\n    const mt = world.getComponent(e, MovementTarget);\n    const v = world.addComponent(e, Velocity);\n    const dx = mt.x - t.x;\n    const dy = mt.y - t.y;\n    const distance = (dx * dx + dy * dy) ** 0.5;\n    v.x = (dx / distance) * Game.cardSpeed;\n    v.y = (dy / distance) * Game.cardSpeed;\n    if (distance > Game.cardSpeed * Time.dtSeconds) continue;\n    v.x = v.y = 0;\n    t.x = mt.x;\n    t.y = mt.y;\n    world.removeComponent(e, MovementTarget);\n    world.removeComponent(e, Velocity);\n  }\n}\nfunction handleMovement(world: World) {\n  for (const e of world.query({ and: [Transform, Velocity] })) {\n    const t = world.getComponent(e, Transform);\n    const v = world.getComponent(e, Velocity);\n    t.x += v.x * Time.dtSeconds;\n    t.y += v.y * Time.dtSeconds;\n  }\n}\nfunction handleDrawText(world: World) {\n  for (const e of world.query({ and: [Text, Transform] })) {\n    const text = world.getComponent(e, Text);\n    const t = world.getComponent(e, Transform);\n    const split = text.content.split(\"\\n\");\n    Ctx2d.ctx.fillStyle = \"white\";\n    Ctx2d.ctx.font = text.font;\n    const textMetrics = Ctx2d.ctx.measureText(text.content);\n    for (let i = 0, l = split.length; i < l; i++) {\n      Ctx2d.ctx.fillText(\n        split[i],\n        t.x,\n        t.y + textMetrics.emHeightAscent * (i + 1),\n      );\n    }\n  }\n}\nfunction handleContainers(world: World) {\n  for (const e of world.query({\n    and: [Transform, HorizontalContainer, EntityContainer],\n  })) {\n    const t = world.getComponent(e, Transform);\n    const hC = world.getComponent(e, HorizontalContainer);\n    const eC = world.getComponent(e, EntityContainer);\n    // Ctx2d.ctx.fillRect(t.x, t.y, hC.width * t.scaleX, 1);\n    const padX = hC.padding * t.scaleX;\n    const padY = hC.padding * t.scaleY;\n    const width = (hC.width - padX * 2) * t.scaleX;\n    let childrenTotalWidth = padX * t.scaleX * (eC.entities.length - 1);\n    let lastWidth = 0;\n    for (const child of eC.entities) {\n      const childTransform = world.getComponent(child, Transform);\n      let childWidth = 0;\n      if (world.hasComponent(child, Graphic)) {\n        childWidth = world.getComponent(child, Graphic).image.width;\n      }\n      if (world.hasComponent(child, Rect)) {\n        childWidth = world.getComponent(child, Rect).w;\n      }\n      childWidth *= childTransform.scaleX;\n      childrenTotalWidth += childWidth;\n      lastWidth = childWidth;\n    }\n    const needToStack = childrenTotalWidth > width;\n    let startX = needToStack\n      ? t.x + padX * t.scaleX\n      : t.x + hC.width / 2 - childrenTotalWidth / 2;\n    for (let i = 0, children = eC.entities, l = children.length; i < l; i++) {\n      const childTransform = world.getComponent(children[i], Transform);\n      let childWidth = 0;\n      if (world.hasComponent(children[i], Graphic)) {\n        childWidth = world.getComponent(children[i], Graphic).image.width;\n      }\n      if (world.hasComponent(children[i], Rect)) {\n        childWidth = world.getComponent(children[i], Rect).w;\n      }\n      childWidth *= childTransform.scaleX;\n      world.addComponent(children[i], MovementTarget, {\n        x: startX + (needToStack ? ((width - lastWidth) / (l - 1)) * i : 0),\n        y: t.y + padY,\n      });\n      startX += needToStack ? 0 : childWidth + padX;\n    }\n  }\n}\n\n// components\nconst Text = { content: \"placeholder\", font: \"\" };\nconst Transform = { x: 0, y: 0, rad: 0, scaleX: 1, scaleY: 1 };\nconst Graphic = { image: new Image() };\nconst Camera2D = { zoom: 1 };\nconst Card: { value: keyof typeof Deck } = { value: \"back\" };\nconst InHand = { isPlayer: true, isRevealed: true };\nconst Button = {\n  hovered: false,\n  justPressed: false,\n  justReleased: false,\n  enabled: true,\n};\nconst Colour = { fill: \"\", stroke: \"\" };\nconst Rect = { w: 10, h: 10 };\nconst Callback = { callback: (_: entityT) => {} };\nconst MovementTarget = { x: 0, y: 0 };\nconst Velocity = { x: 0, y: 0 };\nconst HorizontalContainer = { width: 100, padding: 0 };\nconst EntityContainer: { entities: entityT[] } = { entities: [] };\n\n// entities\nfunction setUpCardContainers(world: World) {\n  const playerContainer = world.addEntity();\n  world.addComponent(playerContainer, Transform, {\n    x: Ctx2d.canvas.width * 0.3,\n    y: Ctx2d.canvas.height - CardSpec.height,\n  });\n  world.addComponent(playerContainer, HorizontalContainer, {\n    width: Ctx2d.canvas.width * 0.65,\n  });\n  world.addComponent(playerContainer, EntityContainer, { entities: [] });\n  const dealerContainer = world.addEntity();\n  world.addComponent(dealerContainer, Transform, {\n    x: Ctx2d.canvas.width * 0.3,\n    y: 0,\n  });\n  world.addComponent(dealerContainer, HorizontalContainer, {\n    width: Ctx2d.canvas.width * 0.65,\n  });\n  world.addComponent(dealerContainer, EntityContainer, { entities: [] });\n}\nfunction setUpButtons(world: World) {\n  function colourChange(b: typeof Button, c: typeof Colour) {\n    c.fill = b.enabled ? \"#00000069\" : \"#00000020\";\n  }\n  const buttons: { [name: string]: (_: entityT) => void } = {\n    \"bet /2\": (e) => {\n      const b = world.getComponent(e, Button);\n      b.enabled =\n        Game.status != GAME_STATUSES.PLAY &&\n        Game.status != GAME_STATUSES.GAMEOVER;\n      colourChange(b, world.getComponent(e, Colour));\n      if (b.justReleased) {\n        Game.bet /= 2;\n        Game.bet = Math.round(Game.bet);\n        Game.bet = Math.max(Game.minBet, Game.bet);\n      }\n    },\n    \"bet *2\": (e) => {\n      const b = world.getComponent(e, Button);\n      b.enabled =\n        Game.status != GAME_STATUSES.PLAY &&\n        Game.status != GAME_STATUSES.GAMEOVER;\n      colourChange(b, world.getComponent(e, Colour));\n      if (b.justReleased) {\n        Game.bet *= 2;\n        Game.bet = Math.max(Math.min(Game.bet, Game.credits), Game.minBet);\n      }\n    },\n    hit: (e) => {\n      const b = world.getComponent(e, Button);\n      colourChange(b, world.getComponent(e, Colour));\n      if (b.justReleased) {\n        if (Game.status == GAME_STATUSES.GAMEOVER) {\n          onGameOver();\n          resetGame(world);\n        }\n        if (Game.status != GAME_STATUSES.PLAY) {\n          resumeGame(world);\n        }\n        pickCard(world);\n        if (checkWin(world) == GAME_STATUSES.BUSTED) {\n          Game.status = GAME_STATUSES.BUSTED;\n          calculateCredits();\n        }\n        if (Game.credits < Game.minBet) {\n          Game.status = GAME_STATUSES.GAMEOVER;\n        }\n      }\n    },\n    stay: (e) => {\n      const b = world.getComponent(e, Button);\n      b.enabled &&= Game.status == GAME_STATUSES.PLAY;\n      colourChange(b, world.getComponent(e, Colour));\n      if (b.justReleased) {\n        const split = splitHand(world);\n        const playersHand = 0;\n        if (split[playersHand].length == 0) return;\n        handleDealer(world);\n      }\n    },\n  };\n  const w = 100;\n  const h = 100;\n  const leftpadPercent = 0.2;\n  const x = Ctx2d.canvas.width * leftpadPercent;\n  const y = Ctx2d.canvas.height / 2 - h / 2;\n  const padding = 5;\n  const buttonContainer = world.addEntity();\n  world.addComponent(buttonContainer, Transform, { x, y });\n  world.addComponent(buttonContainer, HorizontalContainer, {\n    width: Ctx2d.canvas.width * (1 - leftpadPercent),\n    padding,\n  });\n  const eC = world.addComponent(buttonContainer, EntityContainer, {\n    entities: [],\n  });\n  for (const name in buttons) {\n    eC.entities.push(addButton(world, name, 0, 0, w, h, buttons[name]));\n  }\n}\nfunction addButton(\n  world: World,\n  labal: string,\n  x: number,\n  y: number,\n  w: number,\n  h: number,\n  callback = (_: entityT) => {},\n) {\n  const button = world.addEntity();\n  world.addComponent(button, Transform, { x, y });\n  world.addComponent(button, Callback, { callback });\n  world.addComponent(button, Rect, { w, h });\n  world.addComponent(button, Button);\n  world.addComponent(button, Text, { content: labal, font: \"35px sans-serif\" });\n  world.addComponent(button, Colour, {\n    fill: \"#00000069\",\n    stroke: \"transparent\",\n  });\n  return button;\n}\nfunction addCard(world: World, value: keyof typeof Deck) {\n  const card = world.addEntity();\n  world.addComponent(card, Card, { value });\n  return card;\n}\n\n// singletons\nconst Pointers = setUpPointers();\nconst Ctx2d = setUpCanvas();\nconst Time = setUpTime();\nconst CardSpec = {\n  width: 1 * 200,\n  height: 1.43 * 200,\n  round: 0.05 * 200,\n};\nconst Deck = generateDeck(CardSpec.width, CardSpec.height, CardSpec.round);\nconst CardValues: Record<keyof typeof Deck, number[]> = {\n  \"hearts-A\": [1, 11],\n  \"hearts-2\": [2],\n  \"hearts-3\": [3],\n  \"hearts-4\": [4],\n  \"hearts-5\": [5],\n  \"hearts-6\": [6],\n  \"hearts-7\": [7],\n  \"hearts-8\": [8],\n  \"hearts-9\": [9],\n  \"hearts-10\": [10],\n  \"hearts-J\": [10],\n  \"hearts-Q\": [10],\n  \"hearts-K\": [10],\n  \"spades-A\": [1, 11],\n  \"spades-2\": [2],\n  \"spades-3\": [3],\n  \"spades-4\": [4],\n  \"spades-5\": [5],\n  \"spades-6\": [6],\n  \"spades-7\": [7],\n  \"spades-8\": [8],\n  \"spades-9\": [9],\n  \"spades-10\": [10],\n  \"spades-J\": [10],\n  \"spades-Q\": [10],\n  \"spades-K\": [10],\n  \"clubs-A\": [1, 11],\n  \"clubs-2\": [2],\n  \"clubs-3\": [3],\n  \"clubs-4\": [4],\n  \"clubs-5\": [5],\n  \"clubs-6\": [6],\n  \"clubs-7\": [7],\n  \"clubs-8\": [8],\n  \"clubs-9\": [9],\n  \"clubs-10\": [10],\n  \"clubs-J\": [10],\n  \"clubs-Q\": [10],\n  \"clubs-K\": [10],\n  \"diamonds-A\": [1, 11],\n  \"diamonds-2\": [2],\n  \"diamonds-3\": [3],\n  \"diamonds-4\": [4],\n  \"diamonds-5\": [5],\n  \"diamonds-6\": [6],\n  \"diamonds-7\": [7],\n  \"diamonds-8\": [8],\n  \"diamonds-9\": [9],\n  \"diamonds-10\": [10],\n  \"diamonds-J\": [10],\n  \"diamonds-Q\": [10],\n  \"diamonds-K\": [10],\n  back: [0],\n};\nconst enum GAME_STATUSES {\n  PLAY,\n  BLACKJACK,\n  BUSTED,\n  DRAW,\n  LOSE,\n  WIN,\n  GAMEOVER,\n}\nconst Game = {\n  width: 900,\n  height: 600,\n  deckX: 20,\n  deckY: 600 / 2 - 150,\n  cardSpeed: 3000,\n  credits: 100,\n  bet: 0,\n  minBet: 10,\n  best: 0,\n  rounds: 0,\n  roundsTilBetIncrease: 5,\n  betIncreaseExponent: 1.1,\n  targetVal: 21,\n  dealerHitThreashold: 16,\n  status: GAME_STATUSES.PLAY,\n};\nconst StatusStrings: Record<GAME_STATUSES, string> = {\n  [GAME_STATUSES.PLAY]: \"\",\n  [GAME_STATUSES.BLACKJACK]: \"Blackjack\",\n  [GAME_STATUSES.BUSTED]: \"Busted\",\n  [GAME_STATUSES.DRAW]: \"Draw\",\n  [GAME_STATUSES.LOSE]: \"Lose\",\n  [GAME_STATUSES.WIN]: \"Win\",\n  [GAME_STATUSES.GAMEOVER]: \"Game over\",\n};\n\nCtx2d.canvas.width = Game.width;\nCtx2d.canvas.height = Game.height;\n\nconst game = new World();\n\nfor (const card in Deck) {\n  if ((card as keyof typeof Deck) == \"back\") continue;\n  addCard(game, card as keyof typeof Deck);\n}\n\nconst cam = game.addEntity();\ngame.addComponent(cam, Transform);\ngame.addComponent(cam, Camera2D, { zoom: 1 });\n\nconst gameText = game.addEntity();\ngame.addComponent(gameText, Transform);\nconst gameTextComp = game.addComponent(gameText, Text, {\n  font: \"40px sans-serif\",\n});\n\nsetUpButtons(game);\nsetUpCardContainers(game);\nresetGame(game);\n\n{\n  (function loop() {\n    Ctx2d.ctx.resetTransform();\n    Ctx2d.ctx.fillStyle = \"#424242\";\n    Ctx2d.ctx.fillRect(0, 0, Ctx2d.canvas.width, Ctx2d.canvas.height);\n\n    gameTextComp.content = `Credits: ${Game.credits}\\nBet: ${Game.bet}\\nRound ${Game.rounds + 1}, Best: ${Game.best + 1}\\n${StatusStrings[Game.status]}\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\n\\nNext min bet: ${Math.ceil(Game.minBet ** Game.betIncreaseExponent)}\\nRounds until min bet increases: ${\n      Game.roundsTilBetIncrease - (Game.rounds % Game.roundsTilBetIncrease) - 1\n    }`;\n\n    // drawing\n    game.update(\n      handleCamera,\n      handleDrawImages,\n      handleDrawRects,\n      handleDrawText,\n    );\n\n    // process\n    game.update(\n      handleContainers,\n      handleCardVisibility,\n      handlePickCard,\n      handleCard2Img,\n      handleButtons,\n      handleMoveTargets,\n      handleCallbacks,\n      handleMovement,\n    );\n\n    updateTime(Time);\n    updatePointers(Pointers);\n    requestAnimationFrame(loop);\n  })();\n}\n"],
  "mappings": "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",
  "names": ["ObjectPoolMap", "objectFactory", "key", "index", "backKey", "temp", "ComponentManager", "component", "ObjectPoolMap", "mask", "entity", "entry", "src", "dest", "newEntity", "World", "ComponentManager", "entity", "newEntity", "src", "dest", "mask", "a", "component", "values", "compMask", "fns", "i", "l", "query", "andMask", "notMask", "res", "entry", "roundRectQuarter", "x", "y", "w", "h", "radius", "path", "drawCardSuits", "paths", "symbolMargin", "c", "s", "r", "inradius", "drawCard", "cardWidth", "cardHeight", "cardRound", "symbol", "text", "ctx", "isBack", "cardPadding", "i", "textMetrics", "generateDeck", "suits", "ranks", "canvas", "suitNames", "deck", "cardBack", "suitIndex", "rankIndex", "img", "setUpTime", "updateTime", "time", "now", "setUpPointers", "pointers", "id", "updatePointers", "i", "l", "setUpCanvas", "canvas", "ctx", "screen2World", "x", "y", "clientRect", "Ctx2d", "ratio", "isPointInRect", "px", "py", "rx", "ry", "rw", "rh", "sleep", "seconds", "res", "calcHandValue", "world", "hand", "target", "value", "vals", "indices", "e", "Card", "values", "CardValues", "exhausted", "indexSum", "pickACard", "forPlayer", "revealed", "playersHand", "dealersHand", "Transform", "EntityContainer", "t", "eC", "CardSpec", "deck", "InHand", "drew", "Game", "Graphic", "splitHand", "inHandCards", "split", "setButtonsActivation", "enabled", "Button", "pickCard", "resetGame", "resetCards", "calculateCredits", "resumeGame", "MovementTarget", "handleDealer", "checkWin", "playersVal", "dealersVal", "onGameOver", "handleCard2Img", "c", "g", "Deck", "handleDrawImages", "s", "handleCamera", "Camera2D", "cam", "handlePickCard", "graphics", "faceDownIndex", "facedDown", "clicked", "Pointers", "worldPos", "handleCardVisibility", "handleButtons", "Rect", "b", "r", "handleCallbacks", "Callback", "handleDrawRects", "Colour", "handleMoveTargets", "mt", "v", "Velocity", "dx", "dy", "distance", "Time", "handleMovement", "handleDrawText", "Text", "text", "textMetrics", "handleContainers", "HorizontalContainer", "hC", "padX", "padY", "width", "childrenTotalWidth", "lastWidth", "child", "childTransform", "childWidth", "needToStack", "startX", "children", "_", "setUpCardContainers", "playerContainer", "dealerContainer", "setUpButtons", "colourChange", "buttons", "w", "h", "leftpadPercent", "padding", "buttonContainer", "name", "addButton", "labal", "callback", "button", "addCard", "card", "generateDeck", "StatusStrings", "game", "World", "gameText", "gameTextComp", "loop"]
}
