{
  "version": 3,
  "sources": ["../../../src/pool.ts", "../../../src/component.ts", "../../../src/entity.ts", "../../../src/world.ts", "../src/main.ts"],
  "sourcesContent": ["export class ObjectPoolMap<K, V> {\n  private storage: V[] = [];\n  private keyToIndex: Map<K, number> = new Map();\n  private indexToKey: K[] = [];\n  private objectFactory: () => V;\n\n  constructor(objectFactory: () => V) {\n    this.objectFactory = objectFactory;\n  }\n\n  size() {\n    return this.indexToKey.length;\n  }\n\n  add(key: K): V {\n    if (!this.keyToIndex.has(key)) {\n      if (this.storage.length <= this.indexToKey.length) {\n        this.storage.push(this.objectFactory());\n      }\n      this.keyToIndex.set(key, this.indexToKey.length);\n      this.indexToKey[this.indexToKey.length] = key;\n    }\n    return this.storage[this.keyToIndex.get(key) as number];\n  }\n\n  remove(key: K): void {\n    const index = this.keyToIndex.get(key);\n    const backKey = this.indexToKey[this.indexToKey.length - 1];\n    if (index == undefined || backKey == undefined) return;\n    const temp = this.storage[this.indexToKey.length - 1];\n    this.storage[this.indexToKey.length - 1] = this.storage[index];\n    this.storage[index] = temp;\n    this.indexToKey[index] = backKey;\n    this.keyToIndex.set(backKey, index);\n    this.indexToKey.pop();\n    this.keyToIndex.delete(key);\n  }\n\n  get(key: K): V {\n    const index = this.keyToIndex.get(key);\n    if (index == undefined) throw new Error(\"Key not found\");\n    return this.storage[index];\n  }\n\n  has(key: K): boolean {\n    return this.keyToIndex.has(key);\n  }\n\n  clean() {\n    this.storage.splice(this.indexToKey.length);\n  }\n}\n", "import { ObjectPoolMap } from \"./pool.ts\";\nimport { entityT } from \"./entity.ts\";\n\nexport class ComponentManager {\n  private pools: Map<object, ObjectPoolMap<entityT, object>> = new Map();\n  private idMap: Map<object, number> = new Map();\n\n  register<T extends object>(component: T): void {\n    if (this.pools.has(component)) return;\n    this.idMap.set(component, this.idMap.size);\n    this.pools.set(\n      component,\n      new ObjectPoolMap<entityT, T>(() => ({ ...component })),\n    );\n  }\n\n  getId<T extends object>(component: T): number {\n    return this.idMap.get(component) ?? -1;\n  }\n\n  add<T extends object>(entity: entityT, component: T): T {\n    return Object.assign(\n      (this.pools.get(component) as ObjectPoolMap<entityT, T>).add(entity),\n      component,\n    );\n  }\n\n  remove<T extends object>(entity: entityT, component: T): void {\n    (this.pools.get(component) as ObjectPoolMap<entityT, T>).remove(entity);\n  }\n\n  get<T extends object>(entity: entityT, component: T): T {\n    return (this.pools.get(component) as ObjectPoolMap<entityT, T>).get(entity);\n  }\n\n  size<T extends object>(component: T): number {\n    return (this.pools.get(component) as ObjectPoolMap<entityT, T>).size();\n  }\n\n  delete(entity: entityT): void {\n    for (const entry of this.pools) {\n      entry[1].remove(entity);\n    }\n  }\n\n  copy(src: entityT, dest: entityT): void {\n    for (const entry of this.pools) {\n      entry[1].has(src) && Object.assign(entry[1].add(dest), entry[1].get(src));\n    }\n  }\n\n  clean() {\n    for (const entry of this.pools) {\n      entry[1].clean();\n    }\n  }\n}\n", "export type entityT = number;\nexport function newEntity(): entityT {\n  return Math.random();\n}\n", "import { ComponentManager } from \"./component.ts\";\nimport { newEntity, type entityT } from \"./entity.ts\";\n\nexport type queryT = Partial<Record<\"and\" | \"not\", object[]>>;\n\nexport class World {\n  private maskMap: Map<number, number> = new Map();\n  private archetypeMap: Map<number, Set<entityT>> = new Map();\n  private entitiesToDelete: entityT[] = [];\n  private compManager = new ComponentManager();\n\n  addEntity(entity: entityT = newEntity()): entityT {\n    this.maskMap.set(entity, 0);\n    this.getArchetype(0).add(entity);\n    return entity;\n  }\n\n  copyEntity(src: entityT, dest: entityT = newEntity()): entityT {\n    this.compManager.copy(src, dest);\n    const mask = this.maskMap.get(src) ?? 0;\n    this.maskMap.set(dest, mask);\n    this.getArchetype(mask).add(dest);\n    return dest;\n  }\n\n  private getArchetype(mask: number): Set<entityT> {\n    const a = this.archetypeMap.get(mask) ?? new Set();\n    this.archetypeMap.set(mask, a);\n    return a;\n  }\n\n  deleteEntity(entity: entityT) {\n    this.entitiesToDelete.push(entity);\n  }\n\n  registerComponent<T extends object>(component: T): World {\n    this.compManager.register(component);\n    return this;\n  }\n\n  hasComponent<T extends object>(entity: entityT, component: T): boolean {\n    return (\n      ((this.maskMap.get(entity) ?? 0) &\n        (1 << this.compManager.getId(component))) >\n      0\n    );\n  }\n\n  addComponent<T extends object>(\n    entity: entityT,\n    component: T,\n    values: Partial<T> = component,\n  ): T {\n    this.registerComponent(component);\n    let mask = this.maskMap.get(entity) ?? 0;\n    const compId = this.compManager.getId(component);\n    if ((mask & (1 << compId)) != 0) {\n      return Object.assign(this.compManager.get(entity, component), values);\n    }\n    this.getArchetype(mask).delete(entity);\n    mask |= 1 << compId;\n    this.maskMap.set(entity, mask);\n    this.getArchetype(mask).add(entity);\n    return Object.assign(this.compManager.add(entity, component), values);\n  }\n\n  removeComponent<T extends object>(entity: entityT, component: T): void {\n    this.registerComponent(component);\n    let mask = this.maskMap.get(entity) ?? 0;\n    const compId = this.compManager.getId(component);\n    if ((mask & (1 << compId)) == 0) return;\n    this.getArchetype(mask).delete(entity);\n    mask &= ~(1 << compId);\n    this.maskMap.set(entity, mask);\n    this.getArchetype(mask).add(entity);\n    this.compManager.remove(entity, component);\n  }\n\n  getComponent<T extends object>(entity: entityT, component: T): T {\n    return this.compManager.get(entity, component);\n  }\n\n  update(...fns: ((world: World) => void)[]) {\n    for (let i = 0, l = fns.length; i < l; i++) fns[i](this);\n    this.commitEntityDeletion();\n  }\n\n  commitEntityDeletion() {\n    while (this.entitiesToDelete.length) {\n      const entity = this.entitiesToDelete.pop() as entityT;\n      this.compManager.delete(entity);\n      const mask = this.maskMap.get(entity) ?? 0;\n      this.maskMap.delete(entity);\n      this.getArchetype(mask).delete(entity);\n    }\n  }\n\n  cleanObjectPools() {\n    this.compManager.clean();\n  }\n\n  query(query: queryT): entityT[] {\n    let andMask = 0,\n      notMask = 0;\n    if (query.and) {\n      for (let i = 0, l = query.and.length; i < l; i++) {\n        andMask |= 1 << this.compManager.getId(query.and[i]);\n      }\n    }\n    if (query.not) {\n      for (let i = 0, l = query.not.length; i < l; i++) {\n        notMask |= 1 << this.compManager.getId(query.not[i]);\n      }\n    }\n    const res: entityT[] = [];\n    for (const entry of this.archetypeMap) {\n      entry[1].size > 0 &&\n        (entry[0] & andMask) == andMask &&\n        (entry[0] & notMask) == 0 &&\n        res.push(...entry[1]);\n    }\n    return res;\n  }\n\n  entityCount(): number {\n    return this.maskMap.size;\n  }\n}\n", "import { World } from \"bozoecs\";\n\n// singletons\nconst Ctx2D = setUpCanvas2D();\nconst Time = setUpTime();\nconst Pointer = setUpPointer();\n\nfunction setUpCanvas2D() {\n  const canvas =\n    document.querySelector(\"canvas\") ?? document.createElement(\"canvas\");\n  if (!canvas) throw new Error(\"Cannot create canvas element.\");\n  const ctx = canvas.getContext(\"2d\");\n  if (!ctx) throw new Error(\"Cannot initialize context 2d.\");\n\n  document.body.appendChild(canvas);\n\n  globalThis.onresize = globalThis.onload = () => {\n    if (innerWidth / innerHeight < canvas.width / canvas.height) {\n      canvas.style.width = \"100%\";\n      canvas.style.height = \"\";\n    } else {\n      canvas.style.width = \"\";\n      canvas.style.height = \"100%\";\n    }\n  };\n\n  return { canvas, ctx };\n}\nfunction setUpTime() {\n  return { dtMilli: 0, timeMilli: 0 };\n}\nfunction updateTime(time: { dtMilli: number; timeMilli: number }) {\n  time.dtMilli = performance.now() - time.timeMilli;\n  time.timeMilli += time.dtMilli;\n}\ntype pointerT = {\n  pos: Map<number, vec2>;\n  isDown: Map<number, boolean>;\n  justPressed: Map<number, boolean>;\n  justReleased: Map<number, boolean>;\n  pressPos: Map<number, vec2>;\n  releasePos: Map<number, vec2>;\n};\nfunction setUpPointer() {\n  const pointer: pointerT = {\n    pos: new Map(),\n    isDown: new Map(),\n    justPressed: new Map(),\n    justReleased: new Map(),\n    pressPos: new Map(),\n    releasePos: new Map(),\n  };\n\n  globalThis.onpointerdown = (e) => {\n    if (!(e.target instanceof HTMLCanvasElement)) return;\n    pointer.pos.set(e.pointerId, { x: e.x, y: e.y });\n    pointer.pressPos.set(e.pointerId, { x: e.x, y: e.y });\n    pointer.isDown.set(e.pointerId, true);\n    pointer.justPressed.set(e.pointerId, true);\n  };\n\n  globalThis.onpointerup = (e) => {\n    pointer.pos.delete(e.pointerId);\n    pointer.releasePos.set(e.pointerId, { x: e.x, y: e.y });\n    pointer.isDown.delete(e.pointerId);\n    pointer.justReleased.set(e.pointerId, true);\n  };\n\n  globalThis.onpointermove = (e) => {\n    pointer.pos.set(e.pointerId, { x: e.x, y: e.y });\n  };\n\n  return pointer;\n}\nfunction updatePointer(pointer: pointerT) {\n  pointer.justReleased.clear();\n  pointer.justPressed.clear();\n  pointer.releasePos.clear();\n  pointer.pressPos.clear();\n}\n\n// components\nconst Transform = { x: 0, y: 0, rad: 0 };\nconst Hierarchy = { parent: -1 };\nconst Eye = { eyeWhiteRadius: 1, pupilRadius: 0.4, lookAtEntity: -1 };\nconst Camera = { zoom: 20, tilt: 0, isActive: false, targetEntity: -1 };\nconst Rect = { width: 1, height: 1, offsetX: -0.5, offsetY: -0.5 };\nconst Material = { density: 0.1 };\nconst Velocity = { x: 0, y: 0 };\nconst Acceleration = { x: 0, y: 0 };\nconst isPointer = {};\n\n// entities\nfunction addLimb(\n  world: World,\n  x = 0,\n  y = 0,\n  w = 1,\n  h = 1,\n  parent = -1,\n  offsetX = -w / 2,\n  offsetY = 0,\n) {\n  const limb = world.addEntity();\n  world.addComponent(limb, Transform, { x, y });\n  world.addComponent(limb, Hierarchy, { parent });\n  world.addComponent(limb, Rect, {\n    width: w,\n    height: h,\n    offsetX,\n    offsetY,\n  });\n  world.addComponent(limb, Material);\n  world.addComponent(limb, Velocity);\n  world.addComponent(limb, Acceleration);\n  return limb;\n}\nfunction addEye(\n  world: World,\n  x = 0,\n  y = 0,\n  eyeWhiteRadius = 1,\n  pupilRadius = 0.4,\n  lookAtEntity = -1,\n  parent = -1,\n) {\n  const eye = world.addEntity();\n  world.addComponent(eye, Transform, { x, y });\n  world.addComponent(eye, Hierarchy, { parent });\n  world.addComponent(eye, Eye, { eyeWhiteRadius, pupilRadius, lookAtEntity });\n  return eye;\n}\nfunction addPerson(world: World, x = 0, y = 0, lookAtEntity = -1) {\n  const torso = addLimb(world, x, y, 1, 2);\n  const head = addLimb(world, 0, -0.2, 1, 1, torso, -0.5, -1);\n  const leftEye = addEye(world, -0.4, -0.4, 0.3, 0.1, lookAtEntity, head);\n  const right = addEye(world, 0.4, -0.4, 0.3, 0.1, lookAtEntity, head);\n  const leftUpperArm = addLimb(world, -1, 0, 0.5, 1, torso);\n  const leftLowerArm = addLimb(world, 0, 1, 0.5, 1, leftUpperArm);\n  const rightUpperArm = addLimb(world, 1, 0, 0.5, 1, torso);\n  const rightLowerArm = addLimb(world, 0, 1, 0.5, 1, rightUpperArm);\n  const leftUpperLeg = addLimb(world, -0.5, 2, 0.5, 1, torso);\n  const leftLowerLeg = addLimb(world, 0, 1, 0.5, 1, leftUpperLeg);\n  const rightUpperLeg = addLimb(world, 0.5, 2, 0.5, 1, torso);\n  const rightLowerLeg = addLimb(world, 0, 1, 0.5, 1, rightUpperLeg);\n  return torso;\n}\n\n// systems\nfunction handleDrawRects(world: World) {\n  Ctx2D.ctx.beginPath();\n  world.query({ and: [Transform, Rect], not: [Hierarchy] }).forEach((e) => {\n    const t = world.getComponent(e, Transform);\n    const r = world.getComponent(e, Rect);\n    const c = Math.cos(t.rad);\n    const s = Math.sin(t.rad);\n    Ctx2D.ctx.transform(c, s, -s, c, t.x, t.y);\n    Ctx2D.ctx.rect(r.offsetX, r.offsetY, r.width, r.height);\n    Ctx2D.ctx.transform(c, -s, s, c, c * -t.x + s * -t.y, -s * -t.x + c * -t.y);\n  });\n  world.query({ and: [Transform, Rect, Hierarchy] }).forEach((e) => {\n    const t = world.getComponent(e, Transform);\n    const rect = world.getComponent(e, Rect);\n    let h = world.getComponent(e, Hierarchy);\n    let x = t.x;\n    let y = t.y;\n    let r = t.rad;\n    while (world.hasComponent(h.parent, Hierarchy)) {\n      if (world.hasComponent(h.parent, Transform)) {\n        const parentTransform = world.getComponent(h.parent, Transform);\n        const c = Math.cos(parentTransform.rad);\n        const s = Math.sin(parentTransform.rad);\n        const _x = x;\n        const _y = y;\n        x = c * _x - s * _y;\n        y = s * _x + c * _y;\n        x += parentTransform.x;\n        y += parentTransform.y;\n        r += parentTransform.rad;\n      }\n      h = world.getComponent(h.parent, Hierarchy);\n    }\n    const c = Math.cos(r);\n    const s = Math.sin(r);\n    Ctx2D.ctx.transform(c, s, -s, c, x, y);\n    Ctx2D.ctx.rect(rect.offsetX, rect.offsetY, rect.width, rect.height);\n    Ctx2D.ctx.transform(c, -s, s, c, c * -x + s * -y, -s * -x + c * -y);\n  });\n  Ctx2D.ctx.fillStyle = \"white\";\n  Ctx2D.ctx.fill();\n}\nfunction handleDrawEyes(world: World) {\n  world.query({ and: [Transform, Eye, Hierarchy] }).forEach((e) => {\n    const t = world.getComponent(e, Transform);\n    const eye = world.getComponent(e, Eye);\n    let h = world.getComponent(e, Hierarchy);\n    let x = t.x;\n    let y = t.y;\n    while (world.hasComponent(h.parent, Hierarchy)) {\n      if (world.hasComponent(h.parent, Transform)) {\n        const parentTransform = world.getComponent(h.parent, Transform);\n        const c = Math.cos(parentTransform.rad);\n        const s = Math.sin(parentTransform.rad);\n        const _x = x;\n        const _y = y;\n        x = c * _x - s * _y;\n        y = s * _x + c * _y;\n        x += parentTransform.x;\n        y += parentTransform.y;\n      }\n      h = world.getComponent(h.parent, Hierarchy);\n    }\n    Ctx2D.ctx.fillStyle = \"lightgrey\";\n    Ctx2D.ctx.beginPath();\n    Ctx2D.ctx.ellipse(\n      x,\n      y,\n      eye.eyeWhiteRadius,\n      eye.eyeWhiteRadius,\n      0,\n      0,\n      Math.PI * 2,\n    );\n    Ctx2D.ctx.fill();\n    let dirX = 0;\n    let dirY = 0;\n    let mag = eye.eyeWhiteRadius - eye.pupilRadius;\n    if (eye.lookAtEntity != -1) {\n      const t = world.getComponent(eye.lookAtEntity, Transform);\n      dirX = t.x - x;\n      dirY = t.y - y;\n      const m = (dirX ** 2 + dirY ** 2) ** 0.5;\n      dirX /= m;\n      dirY /= m;\n      mag = Math.min(m, mag);\n    }\n    Ctx2D.ctx.fillStyle = \"black\";\n    Ctx2D.ctx.beginPath();\n    Ctx2D.ctx.ellipse(\n      x + dirX * mag,\n      y + dirY * mag,\n      eye.pupilRadius,\n      eye.pupilRadius,\n      0,\n      0,\n      Math.PI * 2,\n    );\n    Ctx2D.ctx.fill();\n  });\n}\nfunction handleCamera(world: World) {\n  const camEntity = world\n    .query({ and: [Camera, Transform] })\n    .find((e) => world.getComponent(e, Camera).isActive);\n  if (!camEntity) return;\n  Ctx2D.ctx.resetTransform();\n  const c = world.getComponent(camEntity, Camera);\n  const p = world.getComponent(camEntity, Transform);\n  if (c.targetEntity != -1 && world.hasComponent(c.targetEntity, Transform)) {\n    const targetPos = world.getComponent(c.targetEntity, Transform);\n    Object.assign(p, targetPos);\n  }\n  const sin = Math.sin(c.tilt) * c.zoom;\n  const cos = Math.cos(c.tilt) * c.zoom;\n  Ctx2D.ctx.transform(\n    cos,\n    sin,\n    -sin,\n    cos,\n    cos * -p.x - sin * -p.y + Ctx2D.canvas.width * 0.5,\n    sin * -p.x + cos * -p.y + Ctx2D.canvas.height * 0.5,\n  );\n}\nfunction handleGravity(world: World) {\n  world\n    .query({ and: [Rect, Material, Acceleration, Hierarchy] })\n    .forEach((e) => {\n      const r = world.getComponent(e, Rect);\n      const m = world.getComponent(e, Material);\n      const a = world.getComponent(e, Acceleration);\n      const h = world.getComponent(e, Hierarchy);\n      const mass = r.width * r.height * m.density;\n      if (h.parent != -1) return;\n      a.y = 9.81;\n    });\n}\nfunction handleMovement(world: World) {\n  world.query({ and: [Velocity, Acceleration] }).forEach((e) => {\n    const v = world.getComponent(e, Velocity);\n    const a = world.getComponent(e, Acceleration);\n    v.x += (a.x * Time.dtMilli) / 1000;\n    v.y += (a.y * Time.dtMilli) / 1000;\n  });\n  world.query({ and: [Transform, Velocity] }).forEach((e) => {\n    const t = world.getComponent(e, Transform);\n    const v = world.getComponent(e, Velocity);\n    t.x += (v.x * Time.dtMilli) / 1000;\n    t.y += (v.y * Time.dtMilli) / 1000;\n  });\n}\nfunction handlePointer(world: World) {\n  world.query({ and: [isPointer] }).forEach((e) => world.deleteEntity(e));\n  const cam = world\n    .query({ and: [Camera, Transform] })\n    .find((e) => world.getComponent(e, Camera).isActive);\n  if (!cam) return;\n  const camComp = world.getComponent(cam, Camera);\n  const camPos = world.getComponent(cam, Transform);\n  Pointer.isDown.forEach((_, k) => {\n    const pointerEntity = world.addEntity();\n    const pos = Pointer.pos.get(k);\n    if (!pos) return;\n    Object.assign(\n      world.addComponent(pointerEntity, Transform),\n      screenToWorld(\n        pointerToScreen(pos, Ctx2D.canvas),\n        camPos,\n        camComp.tilt,\n        camComp.zoom,\n      ),\n    );\n    world.addComponent(pointerEntity, isPointer);\n  });\n}\nfunction handleLookAtPointer(world: World) {\n  world.query({ and: [Eye, Transform, Hierarchy] }).forEach((e) => {\n    const eye = world.getComponent(e, Eye);\n    const t = world.getComponent(e, Transform);\n    let h = world.getComponent(e, Hierarchy);\n    let x = t.x;\n    let y = t.y;\n    while (world.hasComponent(h.parent, Hierarchy)) {\n      if (world.hasComponent(h.parent, Transform)) {\n        const parentTransform = world.getComponent(h.parent, Transform);\n        const c = Math.cos(parentTransform.rad);\n        const s = Math.sin(parentTransform.rad);\n        const _x = x;\n        const _y = y;\n        x = c * _x - s * _y;\n        y = s * _x + c * _y;\n        x += parentTransform.x;\n        y += parentTransform.y;\n      }\n      h = world.getComponent(h.parent, Hierarchy);\n    }\n    let pointerRect = -1;\n    let minDistance = Number.POSITIVE_INFINITY;\n    world.query({ and: [isPointer, Transform] }).forEach((e) => {\n      const t = world.getComponent(e, Transform);\n      const dx = t.x - x;\n      const dy = t.y - y;\n      const distance = (dx ** 2 + dy ** 2) ** 0.5;\n      if (distance > minDistance) return;\n      minDistance = distance;\n      pointerRect = e;\n    });\n    eye.lookAtEntity = pointerRect ?? -1;\n  });\n}\n\n// utils\nfunction drawBackground(color = \"#202020\") {\n  Ctx2D.ctx.resetTransform();\n  Ctx2D.ctx.fillStyle = color;\n  Ctx2D.ctx.fillRect(0, 0, Ctx2D.canvas.width, Ctx2D.canvas.height);\n}\ntype vec2 = { x: number; y: number };\nfunction screenToWorld(\n  screenPos: vec2,\n  cameraPos: vec2,\n  cameraTilt: number,\n  cameraZoom: number,\n): vec2 {\n  const cos = Math.cos(cameraTilt);\n  const sin = Math.sin(cameraTilt);\n  const res = { x: 0, y: 0 };\n  const x = screenPos.x - Ctx2D.canvas.width / 2;\n  const y = screenPos.y - Ctx2D.canvas.height / 2;\n  res.x = cos * x + sin * y;\n  res.y = -sin * x + cos * y;\n  res.x /= cameraZoom;\n  res.y /= cameraZoom;\n  res.x += cameraPos.x;\n  res.y += cameraPos.y;\n  return res;\n}\nfunction pointerToScreen(pointerPos: vec2, canvas: HTMLCanvasElement): vec2 {\n  const out = { x: 0, y: 0 };\n  const rect = canvas.getBoundingClientRect();\n  out.x = pointerPos.x - rect.left;\n  out.y = pointerPos.y - rect.top;\n  if (innerWidth / innerHeight < canvas.width / canvas.height) {\n    out.x *= canvas.width / innerWidth;\n    out.y *= canvas.width / innerWidth;\n  } else {\n    out.x *= canvas.height / innerHeight;\n    out.y *= canvas.height / innerHeight;\n  }\n  return out;\n}\n\n// initialization\nconst game = new World();\n\nconst player = addPerson(game, 0, 0);\n// addPerson(game, -3, 0);\n// addPerson(game, 3, 0);\n\nconst camera = game.addEntity();\ngame.addComponent(camera, Transform, { y: 1 });\ngame.addComponent(camera, Camera, {\n  zoom: 18,\n  isActive: true,\n  // targetEntity: player,\n});\n\n{\n  (function update() {\n    requestAnimationFrame(update);\n    drawBackground();\n    game.update(\n      handleLookAtPointer,\n      handleCamera,\n      handleDrawRects,\n      handleDrawEyes,\n      handlePointer,\n      handleGravity,\n      handleMovement,\n    );\n    updateTime(Time);\n    updatePointer(Pointer);\n  })();\n}\n"],
  "mappings": "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",
  "names": ["ObjectPoolMap", "objectFactory", "key", "index", "backKey", "temp", "ComponentManager", "component", "ObjectPoolMap", "entity", "entry", "src", "dest", "newEntity", "World", "ComponentManager", "entity", "newEntity", "src", "dest", "mask", "a", "component", "values", "compId", "fns", "i", "l", "query", "andMask", "notMask", "res", "entry", "Ctx2D", "setUpCanvas2D", "Time", "setUpTime", "Pointer", "setUpPointer", "canvas", "ctx", "updateTime", "time", "pointer", "e", "updatePointer", "Transform", "Hierarchy", "Eye", "Camera", "Rect", "Material", "Velocity", "Acceleration", "isPointer", "addLimb", "world", "x", "y", "w", "h", "parent", "offsetX", "offsetY", "limb", "addEye", "eyeWhiteRadius", "pupilRadius", "lookAtEntity", "eye", "addPerson", "torso", "head", "leftEye", "right", "leftUpperArm", "leftLowerArm", "rightUpperArm", "rightLowerArm", "leftUpperLeg", "leftLowerLeg", "rightUpperLeg", "rightLowerLeg", "handleDrawRects", "t", "r", "c", "s", "rect", "parentTransform", "_x", "_y", "handleDrawEyes", "dirX", "dirY", "mag", "m", "handleCamera", "camEntity", "p", "targetPos", "sin", "cos", "handleGravity", "a", "mass", "handleMovement", "v", "handlePointer", "cam", "camComp", "camPos", "_", "k", "pointerEntity", "pos", "screenToWorld", "pointerToScreen", "handleLookAtPointer", "pointerRect", "minDistance", "dx", "dy", "distance", "drawBackground", "color", "screenPos", "cameraPos", "cameraTilt", "cameraZoom", "res", "pointerPos", "out", "game", "World", "player", "camera", "update"]
}
