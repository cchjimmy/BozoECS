!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("bozoecs",[],t):"object"==typeof exports?exports.bozoecs=t():e.bozoecs=t()}(this,(()=>{return e={225:e=>{e.exports={createWorld:()=>({compEnum:{},archetypes:{},archetypeMap:{},componentMap:{}}),createSystem:(e=(()=>{}))=>({update:e}),createComponent:(e,t=!1)=>({id:crypto.randomUUID(),factory:t?()=>e:()=>structuredClone(e)}),createEntity:()=>crypto.randomUUID(),update(e,...t){for(let n=0;n<e.length;n++)e[n].update(...t)},addComponents(e,t,n){let r=getCombinedBit(e.compEnum,n);r|=e.archetypeMap[t];let o=removeEntity(e,t),p=new Array(n.length);for(let e=0;e<n.length;e++)o[n[e].id]=n[e].factory(),p[e]=o[n[e].id];return insertEntity(e,t,r,o),p},removeComponents(e,t,n){let r=getCombinedBit(e.compEnum,n);r=e.archetypeMap[t]&~r;let o=removeEntity(e,t),p=new Array(n.length);for(let e=0;e<n.length;e++)p[e]=o[n[e].id],delete o[n[e].id];return insertEntity(e,t,r,o),p},insertEntity(e,t,n,r){e.archetypes[n]??=[],e.archetypes[n].push(t),e.archetypeMap[t]=n;for(let n in r)e.componentMap[n]??={},e.componentMap[n][t]=r[n]},getComponents(e,t,n){let r=new Array(n.length);for(let o=0;o<n.length;o++)r[o]=e.componentMap[n[o].id][t];return r},hasComponents(e,t,n){let r=getCombinedBit(e.compEnum,n);return(e.archetypeMap[t]&r)===r},filter(e,t){let n=[],r=e.archetypes,o=getCombinedBit(e.compEnum,t);for(let e in r)(o&e)===o&&n.push(...r[e]);return n},instantiate(e,t){let n=createEntity(),r=e.archetypeMap[n]=e.archetypeMap[t];e.archetypes[r].push(n);let o=e.componentMap;for(let p in o)e.compEnum[p]&r&&(o[p][n]=structuredClone(o[p][t]));return n},removeEntity(e,t){let n=e.archetypeMap[t],r=e.archetypes[n],o={},p=findIndex(r,t);if(-1===p)return o;r.splice(p,1);let a=e.componentMap;for(let r in a)e.compEnum[r]&n&&(o[r]=a[r][t],delete a[r][t]);return o},findIndex(e,t){let n=-1;for(let r=0;r<e?.length;r++)if(e[r]===t){n=r;break}return n},getCombinedBit(e,t){let n=0;for(let r=0;r<t.length;r++)n+=e[t[r].id]??=1<<Object.keys(e).length;return n}}}},t={},function n(r){var o=t[r];if(void 0!==o)return o.exports;var p=t[r]={exports:{}};return e[r](p,p.exports,n),p.exports}(225);var e,t}));